<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.1.2//EN" "/usr/share/sgml/docbook/xml-dtd-4.5/docbookx.dtd">
<?xml-stylesheet type="text/xsl" href="article.xsl"?>
<article lang="it">
	<articleinfo>
		<title>GovWay - Guida Rapida</title>
		<titleabbrev>GovWay - Guida Rapida </titleabbrev>
		<copyright>
			<year>2005-2018</year>
			<holder>
				<ulink url="https://www.link.it">
					<citetitle>Link.it srl</citetitle>
				</ulink>
			</holder>
		</copyright>
		<address> Link.it SRL <street> Via S. Martino,51 </street>
			<postcode>I-56125</postcode>
			<city> Pisa</city>
			<country> ITALY </country>
			<email>e-mail: info@link.it</email>
		</address>
	</articleinfo>
	<sect1 id="intro">
		<title>Introduzione</title>
		<para> In questa sezione trovi una guida rapida per l'utilizzo di GovWay. TODO. </para>
	</sect1>
	<sect1 id="apiGateway">
		<title>Profilo API Gateway</title>
		<para> Gli scenari che descriviamo in questa sezione mostrano come configurare l'API Gateway
			per gestire qualunque generica API basata su scambio di messaggi SOAP e REST. </para>
		<note>
			<title>Profilo di Utilizzo delle Console</title>
			<para> Prima di procedere con gli scenari descritti nei successivi paragrafi selezionare
				il profilo <emphasis>API Gateway</emphasis> nell'apposito menù situato in alto a
				destra presente nell'intestazione delle console. <figure
					id="modalita-api-selezione-fig">
					<title>Selezione del profilo <emphasis>API Gateway</emphasis></title>
					<mediaobject>
						<imageobject>
							<imagedata fileref="FIGURE_OUT/sceltaModalita.pdf"/>
						</imageobject>
						<imageobject>
							<imagedata fileref="FIGURE_OUT/sceltaModalita.png"/>
						</imageobject>
					</mediaobject>
				</figure>
			</para>
		</note>
		<para> Per quanto concerne la tipologia di servizi <emphasis role="strong">REST</emphasis>,
			il servizio di esempio utilizzato per mostrare le funzionalità dell'API Gateway è lo
				<emphasis>Swagger Petstore</emphasis> (web site: <ulink
				url="https://petstore.swagger.io/">https://petstore.swagger.io/ </ulink> )
			disponibile all'indirizzo <ulink url="http://petstore.swagger.io/v2/">
				http://petstore.swagger.io/v2/ </ulink>. L'interfaccia API è scaricabile in <ulink
				url="https://petstore.swagger.io/v2/swagger.json">
				https://petstore.swagger.io/v2/swagger.json </ulink>. Per simulare un aggiornamento
			di un animale all'interno del negozio è utilizzabile il seguente comando:
			<screen>curl -v -X PUT "http://petstore.swagger.io/v2/pet" \
-H "accept: application/json" \
-H "Content-Type: application/json" \
-d '{
        "id": 3,
        "category": { "id": 22, "name": "dog" },
        "name": "doggie",
        "photoUrls": [ "http://image/dog.jpg" ],
        "tags": [ { "id": 23, "name": "white" } ],
        "status": "available"
}'</screen>
			L'esito dell'aggiornamento viene confermato con un codice http 200 e una risposta json
			equivalente alla richiesta:
			<screen>HTTP/1.1 200 OK
Access-Control-Allow-Origin: *
Access-Control-Allow-Methods: GET, POST, DELETE, PUT
Access-Control-Allow-Headers: Content-Type, api_key, Authorization
Content-Type: application/json
Connection: close
Server: Jetty(9.2.9.v20150224)

{
	"id":3,
	"category":{"id":22,"name":"dog"},
	"name":"doggie",
	"photoUrls":["http://image/dog.jpg"],
	"tags":[{"id":23,"name":"white"}],
	"status":"available"
}</screen>
		</para>
		<para> Per i servizi di tipologia <emphasis role="strong">SOAP</emphasis>, il servizio di
			esempio utilizzato per mostrare le funzionalità dell'API Gateway è <emphasis>Credit Card
				Verification</emphasis> (web site: <ulink
				url="http://wiki.cdyne.com/index.php/Credit_Card_Verification"
				>http://wiki.cdyne.com/index.php/Credit_Card_Verification </ulink> ) disponibile
			all'indirizzo <ulink url="http://ws.cdyne.com/creditcardverify/luhnchecker.asmx"
				>http://ws.cdyne.com/creditcardverify/luhnchecker.asmx </ulink>. L'interfaccia WSDL
			del servizio è scaricabile in <ulink
				url="https://ws.cdyne.com/creditcardverify/luhnchecker.asmx?wsdl">
				https://ws.cdyne.com/creditcardverify/luhnchecker.asmx?wsdl </ulink>. Per simulare
			una richiesta il cui fine è validare un numero di carta di credito è utilizzabile il
			seguente comando, che genera una richiesta SOAP 1.1:
			<screen>curl -v -X POST "http://ws.cdyne.com/creditcardverify/luhnchecker.asmx" \
-H 'Content-Type: text/xml;charset=UTF-8' \
-H 'SOAPAction: "http://ws.cdyne.com/CheckCC"' \
-d '&lt;soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/">
	&lt;soapenv:Header/>
	&lt;soapenv:Body>
		&lt;CheckCC xmlns="http://ws.cdyne.com/">
			&lt;CardNumber>4111111111111111&lt;/CardNumber>
		&lt;/CheckCC>
	&lt;/soapenv:Body>
&lt;/soapenv:Envelope>'</screen>
			L'esito della verifica viene ritornato con un codice http 200 e una risposta contenente
			i dettagli della carta:
			<screen>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: text/xml; charset=utf-8
Expires: -1
Server: Microsoft-IIS/8.5
X-AspNet-Version: 4.0.30319
X-Powered-By: ASP.NET
Date: Thu, 15 Nov 2018 11:50:12 GMT
Content-Length: 393
Connection: keep-alive


&lt;soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
   &lt;soap:Body>
		&lt;CheckCCResponse xmlns="http://ws.cdyne.com/">
			&lt;CheckCCResult>
				&lt;CardType>VISA&lt;/CardType>
				&lt;CardValid>true&lt;/CardValid>
			&lt;/CheckCCResult>
		&lt;/CheckCCResponse>
   &lt;/soap:Body>
&lt;/soap:Envelope></screen>
			Per simulare la medesima richiesta utilizzando SOAP 1.2 è possibile usare il comando:
			<screen>curl -v -X POST "http://ws.cdyne.com/creditcardverify/luhnchecker.asmx" \
-H 'Content-Type: application/soap+xml; charset=utf-8' \
-d '&lt;soap12:Envelope xmlns:soap12="http://www.w3.org/2003/05/soap-envelope">
	&lt;soap12:Header/>
	&lt;soap12:Body>
		&lt;CheckCC xmlns="http://ws.cdyne.com/">
			&lt;CardNumber>4111111111111111&lt;/CardNumber>
		&lt;/CheckCC>
	&lt;/soap12:Body>
&lt;/soap12:Envelope>'</screen>
			L'esito della verifica viene ritornato con un codice http 200 e una risposta contenente
			i dettagli della carta:
			<screen>HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Content-Type: application/soap+xml; charset=utf-8
Expires: -1
Server: Microsoft-IIS/8.5
X-AspNet-Version: 4.0.30319
X-Powered-By: ASP.NET
Date: Thu, 15 Nov 2018 11:50:12 GMT
Content-Length: 393
Connection: keep-alive


&lt;soap12:Envelope xmlns:soap12="http://www.w3.org/2003/05/soap-envelope">
   &lt;soap12:Body>
		&lt;CheckCCResponse xmlns="http://ws.cdyne.com/">
			&lt;CheckCCResult>
				&lt;CardType>VISA&lt;/CardType>
				&lt;CardValid>true&lt;/CardValid>
			&lt;/CheckCCResult>
		&lt;/CheckCCResponse>
   &lt;/soap12:Body>
&lt;/soap12:Envelope></screen>
		</para>

		<sect2 id="apiGateway_restHelloWorld">
			<title>Erogazione API REST</title>
			<para> Procediamo adesso con la descrizione dei passi di configurazione necessari a
				registrare una API REST implementata da un applicativo interno al proprio dominio di
				gestione. L'applicativo implementa lo <emphasis>Swagger Petstore</emphasis>
				descritto in <xref linkend="apiGateway"/>. In questo scenario di esempio si suppone
				che l'indirizzo <ulink url="http://petstore.swagger.io/">
					http://petstore.swagger.io/ </ulink> dove viene erogato il servizio sia interno
				al proprio dominio di gestione. </para>
			<para> L'API, per questo primo esempio di utilizzo del Gateway, viene registrata in modo
				che sia accessibile in forma anonima da qualunque client invocando l'url esposta da
				GovWay. Una rappresentazione di questo scenario è mostrata nella figura <xref
					linkend="apiGateway_restHelloWorld_erogazione"/>. Prima di procedere con la
				configurazione effettuare il download dell'interfaccia API disponibile in <ulink
					url="https://petstore.swagger.io/v2/swagger.json">
					https://petstore.swagger.io/v2/swagger.json </ulink>. </para>
			<figure id="apiGateway_restHelloWorld_erogazione">
				<title>Erogazione di una API Rest tramite GovWay</title>
				<mediaobject>
					<imageobject>
						<imagedata width="70%" fileref="FIGURE_OUT/erogazioneRESTBase.pdf"/>
					</imageobject>
					<imageobject>
						<imagedata width="70%" fileref="FIGURE_OUT/erogazioneRESTBase.png"/>
					</imageobject>
				</mediaobject>
			</figure>
			<para> Per registrare l'API su Govway, utilizzando la console
					<emphasis>govwayConsole</emphasis>, procedere come segue: <orderedlist>
					<listitem>
						<para>
							<emphasis role="strong">Registrazione API</emphasis>. </para>
						<para> Accedere alla sezione <emphasis>'API'</emphasis> e selezionare il
							pulsante <emphasis>'Aggiungi'</emphasis>. Fornire i seguenti dati: <itemizedlist>
								<listitem>
									<para>
										<emphasis>Tipo</emphasis>: selezionare la tipologia
											<emphasis>'REST'</emphasis>. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis>Nome</emphasis>: indicare il nome dell'API che si
										sta registrando, ad esempio <emphasis>'PetStore'</emphasis>.
									</para>
								</listitem>
								<listitem>
									<para>
										<emphasis>Descrizione</emphasis>: opzionalmente è possibile
										fornire una descrizione generica dell'API. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis>Versione</emphasis>: indicare la versione dell'API
										che si sta registrando; nell'esempio utilizziamo la versione
											<emphasis>2</emphasis> del PetStore. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis>Formato Specifica</emphasis>: selezionare
											<emphasis>'Swagger 2.0'</emphasis> tra i formati
										supportati. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis>Swagger 2.0</emphasis>: caricare l'interfaccia API
										scaricata dall'indirizzo <ulink
											url="https://petstore.swagger.io/v2/swagger.json">
											https://petstore.swagger.io/v2/swagger.json </ulink>.
									</para>
								</listitem>
							</itemizedlist>
							<figure id="apiGateway_restHelloWorld_erogazione_api">
								<title>Registrazione di una API</title>
								<mediaobject>
									<imageobject>
										<imagedata width="50%"
											fileref="FIGURE_OUT/erogazioneRESTBaseRegistrazioneAPI.pdf"
										/>
									</imageobject>
									<imageobject>
										<imagedata width="50%"
											fileref="FIGURE_OUT/erogazioneRESTBaseRegistrazioneAPI.png"
										/>
									</imageobject>
								</mediaobject>
							</figure>
						</para>
						<para>Effettuato il salvataggio, l'API sarà consultabile all'interno
							dell'elenco delle API registrate. Accedendo al dettaglio si potranno
							visionare le risorse che tale API dispone come si può vedere dalla
							figura <xref linkend="apiGateway_restHelloWorld_erogazione_api_risorse"
							/>. <figure id="apiGateway_restHelloWorld_erogazione_api_risorse">
								<title>Risorse di una API</title>
								<mediaobject>
									<imageobject>
										<imagedata width="50%"
											fileref="FIGURE_OUT/erogazioneRESTBaseConsultazioneRisorseAPI.pdf"
										/>
									</imageobject>
									<imageobject>
										<imagedata width="50%"
											fileref="FIGURE_OUT/erogazioneRESTBaseConsultazioneRisorseAPI.png"
										/>
									</imageobject>
								</mediaobject>
							</figure>
						</para>
					</listitem>
					<listitem>
						<para>
							<emphasis role="strong">Registrazione Erogazione</emphasis>
						</para>
						<para> Accedere alla sezione <emphasis>'Erogazioni'</emphasis> e selezionare
							il pulsante <emphasis>'Aggiungi'</emphasis>. Fornire i seguenti dati: <itemizedlist>
								<listitem>
									<para>
										<emphasis>Nome</emphasis>: selezionare l'API precedentemente
										registrata <emphasis>'PetStore v2'</emphasis>. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis>Autenticazione - Stato</emphasis>: per esporre
										l'API in modo che sia invocabile da qualunque client in
										forma anonima selezionare lo stato
											<emphasis>'disabilitato'</emphasis>. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis>Connettore - Endpoint</emphasis>: indicare la
											<emphasis>base uri</emphasis> dove viene erogata l'API
										nel dominio interno. Per il nostro esempio utilizzare la
										url: <itemizedlist>
											<listitem>
												<para><emphasis>http://petstore.swagger.io/v2</emphasis></para>
											</listitem>
										</itemizedlist>
									</para>
								</listitem>
							</itemizedlist>
							<figure id="apiGateway_restHelloWorld_erogazione_registrazione">
								<title>Registrazione di una erogazione di API</title>
								<mediaobject>
									<imageobject>
										<imagedata width="50%"
											fileref="FIGURE_OUT/erogazioneRESTBaseRegistrazioneErogazione.pdf"
										/>
									</imageobject>
									<imageobject>
										<imagedata width="50%"
											fileref="FIGURE_OUT/erogazioneRESTBaseRegistrazioneErogazione.png"
										/>
									</imageobject>
								</mediaobject>
							</figure>
						</para>
						<para>Effettuato il salvataggio, l'API erogata sarà consultabile all'interno
							dell'elenco delle erogazioni. Accedendo al dettaglio si potrà conoscere
								l'<emphasis>url di invocazione</emphasis> che deve essere comunicata
							ai client che desiderano invocare l'API. <figure
								id="apiGateway_restHelloWorld_erogazione_urlInvocazione">
								<title>URL di Invocazione dell'API erogata</title>
								<mediaobject>
									<imageobject>
										<imagedata width="50%"
											fileref="FIGURE_OUT/erogazioneRESTBaseConsultazioneErogazione.pdf"
										/>
									</imageobject>
									<imageobject>
										<imagedata width="50%"
											fileref="FIGURE_OUT/erogazioneRESTBaseConsultazioneErogazione.png"
										/>
									</imageobject>
								</mediaobject>
							</figure>
						</para>
					</listitem>
					<listitem>
						<para>
							<emphasis role="strong">Invocazione API tramite GovWay</emphasis>
						</para>
						<para>Al termine di questi passi di configurazione il servizio REST sarà
							raggiungibile dai client utilizzando l'url di invocazione: <itemizedlist>
								<listitem>
									<para><emphasis>http://host:port/govway/&lt;soggetto-dominio-interno>/PetStore/v2/&lt;uri-risorsa></emphasis></para>
								</listitem>
							</itemizedlist>
							<note>
								<title>Soggetto Interno al Dominio</title>
								<para>In questo esempio si suppone che il nome del soggetto fornito
									durante la fase di installazione di GovWay sia
										<emphasis>Ente</emphasis>.</para>
							</note>
							<screen>curl -v -X PUT "http://127.0.0.1:8080/govway/Ente/PetStore/v2/pet" \
-H "accept: application/json" \
-H "Content-Type: application/json" \
-d '{
        "id": 3,
        "category": { "id": 22, "name": "dog" },
        "name": "doggie",
        "photoUrls": [ "http://image/dog.jpg" ],
        "tags": [ { "id": 23, "name": "white" } ],
        "status": "available"
}'</screen>
						</para>
						<para> L'esito dell'aggiornamento viene confermato con un codice http 200 e
							una risposta json equivalente alla richiesta:
							<screen>HTTP/1.1 200 OK
Access-Control-Allow-Origin: *
Access-Control-Allow-Methods: GET, POST, DELETE, PUT
Access-Control-Allow-Headers: Content-Type, api_key, Authorization
Content-Type: application/json
Transfer-Encoding: chunked
Server: GovWay
GovWay-Message-ID: 84e1d9a4-c181-436f-b7f0-4cabf55c370d
GovWay-Transaction-ID: 6c13b9ac-3d60-45a6-9130-297a4d832824

{
	"id":3,
	"category":{"id":22,"name":"dog"},
	"name":"doggie",
	"photoUrls":["http://image/dog.jpg"],
	"tags":[{"id":23,"name":"white"}],
	"status":"available"
}</screen>
						</para>
						<note>
							<title>Traccia della comunicazione</title>
							<para>L'invocazione restituisce al client, sotto forma di header HTTP,
								l'id di transazione con cui è stata salvata la traccia contenente
								tutti i dati dell'invocazione sul Gateway.</para>
						</note>
					</listitem>
					<listitem>
						<para>
							<emphasis role="strong">Consultazione Tracce</emphasis>
						</para>
						<para>Attraverso la console <emphasis>govwayMonitor</emphasis> è possibile
							consultare lo storico delle transazioni che sono transitate nel gateway
							(figura <xref linkend="apiGateway_restHelloWorld_monitoraggio"/>) e
							conoscere il dettaglio di una singola invocazione (figura <xref
								linkend="apiGateway_restHelloWorld_monitoraggio_dettaglio"/>).
								<figure id="apiGateway_restHelloWorld_monitoraggio">
								<title>Tracce delle invocazioni transitate sul Gateway</title>
								<mediaobject>
									<imageobject>
										<imagedata width="50%"
											fileref="FIGURE_OUT/erogazioneRESTBaseConsoltazioneStoricoTransazioni.pdf"
										/>
									</imageobject>
									<imageobject>
										<imagedata width="50%"
											fileref="FIGURE_OUT/erogazioneRESTBaseConsoltazioneStoricoTransazioni.png"
										/>
									</imageobject>
								</mediaobject>
							</figure>
							<figure id="apiGateway_restHelloWorld_monitoraggio_dettaglio">
								<title>Dettaglio di una invocazione transitata sul Gateway</title>
								<mediaobject>
									<imageobject>
										<imagedata width="30%"
											fileref="FIGURE_OUT/erogazioneRESTBaseConsoltazioneStoricoTransazioniDettaglio.pdf"
										/>
									</imageobject>
									<imageobject>
										<imagedata width="30%"
											fileref="FIGURE_OUT/erogazioneRESTBaseConsoltazioneStoricoTransazioniDettaglio.png"
										/>
									</imageobject>
								</mediaobject>
							</figure>
						</para>
					</listitem>
				</orderedlist>
			</para>
		</sect2>

		<sect2 id="apiGateway_multitenant">
			<title>Modalità Multi-Tenant</title>
			<para>GovWay supporta nativamente il multi-tenant grazie al quale è possibile gestire
				più domini. Una API che deve essere erogata su più domini viene registrata solamente
				una volta e può poi essere implementata da tutti i soggetti dei vari domini gestiti.
				Un applicativo client, per indirizzare una specifica API di un dominio, deve
				semplicemente indicare il nome del soggetto nella url di invocazione. Una
				rappresentazione di uno scenario multi-tenant è mostrata nella figura <xref
					linkend="apiGateway_multitenant_scenario"/>
				<figure id="apiGateway_multitenant_scenario">
					<title>Scenario Multi-Tenant</title>
					<mediaobject>
						<imageobject>
							<imagedata width="70%" fileref="FIGURE_OUT/multitenant.pdf"/>
						</imageobject>
						<imageobject>
							<imagedata width="70%" fileref="FIGURE_OUT/multitenant.png"/>
						</imageobject>
					</mediaobject>
				</figure>
			</para>
			<para> Di seguito vengono descritti i passi necessari a gestire più domini
				(multi-tenant) su GovWay al fine di erogare l'API già registrata nell'esempio
				descritto nella sezione <xref linkend="apiGateway_restHelloWorld"/> all'interno di
				un ulteriore dominio gestito dal soggetto <emphasis>Ente2</emphasis>. </para>
			<orderedlist>
				<listitem>
					<para>
						<emphasis role="strong">Abilitazione Multi-Tenant</emphasis>
					</para>
					<para>GovWay viene installato per default con la funzionalità multi-tenant
						disabilitata e quindi l'unico dominio gestito è quello del soggetto fornito
						in fase di installazione. Per abilitare il multi-tenant accedere alla
						sezione <emphasis>'Configurazione'</emphasis> e selezionare la voce
							<emphasis>'Generale'</emphasis>. Nella maschera visualizzata selezionare
						il valore <emphasis>'abilitato'</emphasis> nella sezione
							<emphasis>'Multi-Tenant'</emphasis>. <figure
							id="apiGateway_multitenant_configurazione_abilitato">
							<title>Configurazione Multi-Tenant Abilitato</title>
							<mediaobject>
								<imageobject>
									<imagedata width="50%"
										fileref="FIGURE_OUT/multitenant_configurazione_abilitato.pdf"
									/>
								</imageobject>
								<imageobject>
									<imagedata width="50%"
										fileref="FIGURE_OUT/multitenant_configurazione_abilitato.png"
									/>
								</imageobject>
							</mediaobject>
						</figure>
					</para>
				</listitem>
				<listitem>
					<para>
						<emphasis role="strong">Registrazione nuovo Soggetto</emphasis>
					</para>
					<para>Accedere alla sezione <emphasis>'Soggetti'</emphasis> e selezionare il
						pulsante <emphasis>'Aggiungi'</emphasis>. Fornire i seguenti dati: <itemizedlist>
							<listitem>
								<para>
									<emphasis>Dominio</emphasis>: selezionare la voce
										<emphasis>'Interno'</emphasis>. </para>
							</listitem>
							<listitem>
								<para>
									<emphasis>Nome</emphasis>: indicare il nome del Soggetto che
									rappresenta il nuovo dominio in gestione, ad esempio
										<emphasis>'Ente2'</emphasis>. </para>
							</listitem>
							<listitem>
								<para>
									<emphasis>Descrizione</emphasis>: opzionalmente è possibile
									fornire una descrizione generica del soggetto. </para>
							</listitem>
						</itemizedlist>
						<figure id="apiGateway_multitenant_configurazione_soggetto">
							<title>Registrazione nuovo Soggetto</title>
							<mediaobject>
								<imageobject>
									<imagedata width="50%"
										fileref="FIGURE_OUT/multitenant_configurazione_soggetto.pdf"
									/>
								</imageobject>
								<imageobject>
									<imagedata width="50%"
										fileref="FIGURE_OUT/multitenant_configurazione_soggetto.png"
									/>
								</imageobject>
							</mediaobject>
						</figure>
					</para>
				</listitem>
				<listitem>
					<para>
						<emphasis role="strong">Selezione del Dominio da gestire</emphasis>
					</para>
					<para> Sia nella console di gestione (<emphasis>govwayConsole</emphasis>) che
						nella console di monitoraggio (<emphasis>govwayMonitor</emphasis>), una
						volta abilitato il Multi-Tenant, prima di procedere con qualsiasi operazione
						deve essere selezionato il soggetto per cui si intende gestire il dominio
						attraverso l'apposito menù situato in alto a destra nell'intestazione delle
						console. <figure id="apiGateway_multitenant_selezione_soggetto">
							<title>Selezione del Soggetto</title>
							<mediaobject>
								<imageobject>
									<imagedata width="30%"
										fileref="FIGURE_OUT/apiGateway_multitenant_selezione_soggetto.pdf"
									/>
								</imageobject>
								<imageobject>
									<imagedata width="30%"
										fileref="FIGURE_OUT/apiGateway_multitenant_selezione_soggetto.png"
									/>
								</imageobject>
							</mediaobject>
						</figure>
					</para>
				</listitem>
				<listitem>
					<para>
						<emphasis role="strong">Registrazione Erogazione</emphasis>
					</para>
					<para> Procedere con la registrazione della API <emphasis>'PetStore
							v2'</emphasis> così come già descritto nella sezione <xref
							linkend="apiGateway_restHelloWorld"/>. Accedere alla sezione
							<emphasis>'Erogazioni'</emphasis> e selezionare il pulsante
							<emphasis>'Aggiungi'</emphasis>. Fornire i seguenti dati: <itemizedlist>
							<listitem>
								<para>
									<emphasis>Nome</emphasis>: selezionare l'API precedentemente
									registrata <emphasis>'PetStore v2'</emphasis>. </para>
							</listitem>
							<listitem>
								<para>
									<emphasis>Autenticazione - Stato</emphasis>: per esporre l'API
									in modo che sia invocabile da qualunque client in forma anonima
									selezionare lo stato <emphasis>'disabilitato'</emphasis>.
								</para>
							</listitem>
							<listitem>
								<para>
									<emphasis>Connettore - Endpoint</emphasis>: indicare la
										<emphasis>base uri</emphasis> dove viene erogata l'API nel
									dominio interno. Per il nostro esempio utilizzare sempre la url: <itemizedlist>
										<listitem>
											<para><emphasis>http://petstore.swagger.io/v2</emphasis></para>
										</listitem>
									</itemizedlist>
								</para>
							</listitem>
						</itemizedlist>
					</para>
					<para>Effettuato il salvataggio, l'API erogata sarà consultabile all'interno
						dell'elenco delle erogazioni. Accedendo al dettaglio si potrà conoscere
							l'<emphasis>url di invocazione</emphasis> che deve essere comunicata ai
						client che desiderano invocare l'API. <note>
							<title>Nome del Soggetto presente nella url di invocazione</title>
							<para>Come si può vedere dalla figura <xref
									linkend="apiGateway_multitenant_erogazione_urlInvocazione"/> il
								soggetto <emphasis>Ente2</emphasis> compare nella url
								indicata.</para>
						</note>
						<figure id="apiGateway_multitenant_erogazione_urlInvocazione">
							<title>URL di Invocazione dell'API erogata</title>
							<mediaobject>
								<imageobject>
									<imagedata width="50%"
										fileref="FIGURE_OUT/apiGateway_multitenant_erogazione_urlInvocazione.pdf"
									/>
								</imageobject>
								<imageobject>
									<imagedata width="50%"
										fileref="FIGURE_OUT/apiGateway_multitenant_erogazione_urlInvocazione.png"
									/>
								</imageobject>
							</mediaobject>
						</figure>
					</para>
				</listitem>
				<listitem>
					<para>
						<emphasis role="strong">Invocazione API tramite GovWay</emphasis>
					</para>
					<para>Al termine di questi passi di configurazione il servizio REST sarà
						raggiungibile dai client utilizzando l'url di invocazione: <itemizedlist>
							<listitem>
								<para><emphasis>http://host:port/govway/<emphasis role="strong"
											>Ente2</emphasis>/PetStore/v2/&lt;uri-risorsa></emphasis></para>
							</listitem>
						</itemizedlist>
						<screen>curl -v -X PUT "http://127.0.0.1:8080/govway/Ente2/PetStore/v2/pet" \
-H "accept: application/json" \
-H "Content-Type: application/json" \
-d '{
        "id": 3,
        "category": { "id": 22, "name": "dog" },
        "name": "doggie",
        "photoUrls": [ "http://image/dog.jpg" ],
        "tags": [ { "id": 23, "name": "white" } ],
        "status": "available"
}'</screen>
					</para>
				</listitem>
				<listitem>
					<para>
						<emphasis role="strong">Consultazione Tracce</emphasis>
					</para>
					<para> La consultazione delle tracce per ogni dominio gestito è identica a
						quanto descritto nella sezione <xref linkend="apiGateway_restHelloWorld"/>,
						previa selezione del soggetto in gestione tramite il menù situato in alto a
						destra. </para>
				</listitem>
			</orderedlist>


		</sect2>

		<sect2 id="apiGateway_soapHelloWorld">
			<title>Erogazione API SOAP</title>
			<para> Procediamo adesso con la descrizione dei passi di configurazione necessari a
				registrare una API SOAP implementata da un applicativo interno al proprio dominio di
				gestione. L'applicativo implementa il servizio <emphasis>Credit Card
					Verification</emphasis> descritto in <xref linkend="apiGateway"/>. In questo
				scenario di esempio si suppone che l'indirizzo <ulink
					url="http://ws.cdyne.com/creditcardverify/luhnchecker.asmx">
					http://ws.cdyne.com/creditcardverify/luhnchecker.asmx </ulink> dove viene
				erogato il servizio sia interno al proprio dominio di gestione. </para>
			<para> L'API, per questo esempio, viene registrata in modo che sia accessibile in forma
				anonima da qualunque client invocando l'url esposta da GovWay. Una rappresentazione
				di questo scenario è mostrata nella figura <xref
					linkend="apiGateway_soapHelloWorld_erogazione"/>. Prima di procedere con la
				configurazione effettuare il download dell'interfaccia WSDL disponibile in <ulink
					url="https://ws.cdyne.com/creditcardverify/luhnchecker.asmx?wsdl">
					https://ws.cdyne.com/creditcardverify/luhnchecker.asmx?wsdl </ulink>. </para>
			<figure id="apiGateway_soapHelloWorld_erogazione">
				<title>Erogazione di una API SOAP tramite GovWay</title>
				<mediaobject>
					<imageobject>
						<imagedata width="70%" fileref="FIGURE_OUT/erogazioneSOAPBase.pdf"/>
					</imageobject>
					<imageobject>
						<imagedata width="70%" fileref="FIGURE_OUT/erogazioneSOAPBase.png"/>
					</imageobject>
				</mediaobject>
			</figure>
			<para> Per registrare l'API su Govway, utilizzando la console
					<emphasis>govwayConsole</emphasis>, procedere come segue: <orderedlist>
					<listitem>
						<para>
							<emphasis role="strong">Registrazione API</emphasis>. </para>
						<para> Accedere alla sezione <emphasis>'API'</emphasis> e selezionare il
							pulsante <emphasis>'Aggiungi'</emphasis>. Fornire i seguenti dati: <itemizedlist>
								<listitem>
									<para>
										<emphasis>Tipo</emphasis>: selezionare la tipologia
											<emphasis>'SOAP'</emphasis>. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis>Nome</emphasis>: indicare il nome dell'API che si
										sta registrando, ad esempio
											<emphasis>'CreditCardVerification'</emphasis>. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis>Descrizione</emphasis>: opzionalmente è possibile
										fornire una descrizione generica dell'API. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis>Versione</emphasis>: indicare la versione dell'API
										che si sta registrando; nell'esempio utilizziamo la versione
											<emphasis>1</emphasis>. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis>WSDL</emphasis>: caricare l'interfaccia WSDL
										scaricata dall'indirizzo <ulink
											url="https://ws.cdyne.com/creditcardverify/luhnchecker.asmx?wsdl"
											>
											https://ws.cdyne.com/creditcardverify/luhnchecker.asmx?wsdl
										</ulink>. </para>
								</listitem>
							</itemizedlist>
							<figure id="apiGateway_soapHelloWorld_erogazione_api">
								<title>Registrazione di una API</title>
								<mediaobject>
									<imageobject>
										<imagedata width="50%"
											fileref="FIGURE_OUT/erogazioneSOAPBaseRegistrazioneAPI.pdf"
										/>
									</imageobject>
									<imageobject>
										<imagedata width="50%"
											fileref="FIGURE_OUT/erogazioneSOAPBaseRegistrazioneAPI.png"
										/>
									</imageobject>
								</mediaobject>
							</figure>
						</para>
						<para>Effettuato il salvataggio, l'API sarà consultabile all'interno
							dell'elenco delle API registrate. Accedendo al dettaglio si potranno
							visionare i servizi che tale API dispone che corrispondono ai
								<emphasis>port type</emphasis> presenti nell'interfaccia wsdl
							caricata. Come si può vedere dalla figura <xref
								linkend="apiGateway_soapHelloWorld_erogazione_api_servizi"/>
							l'interfaccia <emphasis>Credit Card Verification</emphasis> possiede tre
							differenti servizi che corrispondo a differenti modalità di utilizzo.
							Nel seguito di questo esempio verrà utilizzato esclusivamente il
							servizio <emphasis>LuhnCheckerSoap</emphasis>. <figure
								id="apiGateway_soapHelloWorld_erogazione_api_servizi">
								<title>Servizi di una API</title>
								<mediaobject>
									<imageobject>
										<imagedata width="50%"
											fileref="FIGURE_OUT/erogazioneSOAPBaseConsultazioneServiziAPI.pdf"
										/>
									</imageobject>
									<imageobject>
										<imagedata width="50%"
											fileref="FIGURE_OUT/erogazioneSOAPBaseConsultazioneServiziAPI.png"
										/>
									</imageobject>
								</mediaobject>
							</figure>
						</para>
					</listitem>
					<listitem>
						<para>
							<emphasis role="strong">Registrazione Erogazione</emphasis>
						</para>
						<para> Accedere alla sezione <emphasis>'Erogazioni'</emphasis> e selezionare
							il pulsante <emphasis>'Aggiungi'</emphasis>. Fornire i seguenti dati: <itemizedlist>
								<listitem>
									<para>
										<emphasis>Nome</emphasis>: selezionare l'API precedentemente
										registrata <emphasis>'CreditCardVerification v1'</emphasis>.
									</para>
								</listitem>
								<listitem>
									<para>
										<emphasis>Servizio</emphasis>: selezionare uno dei servizi
										(port type) definiti nell'API precedentemente registrata
											<emphasis>'LuhnCheckerSoap'</emphasis>. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis>Autenticazione - Stato</emphasis>: per esporre
										l'API in modo che sia invocabile da qualunque client in
										forma anonima selezionare lo stato
											<emphasis>'disabilitato'</emphasis>. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis>Connettore - Endpoint</emphasis>: indicare
										l'endpoint dove viene erogata l'API nel dominio interno. Per
										il nostro esempio utilizzare la url: <itemizedlist>
											<listitem>
												<para><emphasis>http://ws.cdyne.com/creditcardverify/luhnchecker.asmx</emphasis></para>
											</listitem>
										</itemizedlist>
									</para>
								</listitem>
							</itemizedlist>
							<figure id="apiGateway_soapHelloWorld_erogazione_registrazione">
								<title>Registrazione di una erogazione di API</title>
								<mediaobject>
									<imageobject>
										<imagedata width="50%"
											fileref="FIGURE_OUT/erogazioneSOAPBaseRegistrazioneErogazione.pdf"
										/>
									</imageobject>
									<imageobject>
										<imagedata width="50%"
											fileref="FIGURE_OUT/erogazioneSOAPBaseRegistrazioneErogazione.png"
										/>
									</imageobject>
								</mediaobject>
							</figure>
						</para>
						<para>Effettuato il salvataggio, l'API erogata sarà consultabile all'interno
							dell'elenco delle erogazioni. Accedendo al dettaglio si potrà conoscere
								l'<emphasis>url di invocazione</emphasis> che deve essere comunicata
							ai client che desiderano invocare l'API. <figure
								id="apiGateway_soapHelloWorld_erogazione_urlInvocazione">
								<title>URL di Invocazione dell'API erogata</title>
								<mediaobject>
									<imageobject>
										<imagedata width="50%"
											fileref="FIGURE_OUT/erogazioneSOAPBaseConsultazioneErogazione.pdf"
										/>
									</imageobject>
									<imageobject>
										<imagedata width="50%"
											fileref="FIGURE_OUT/erogazioneSOAPBaseConsultazioneErogazione.png"
										/>
									</imageobject>
								</mediaobject>
							</figure>
						</para>
					</listitem>
					<listitem>
						<para>
							<emphasis role="strong">Invocazione API tramite GovWay</emphasis>
						</para>
						<para>Al termine di questi passi di configurazione il servizio SOAP sarà
							raggiungibile dai client utilizzando l'url di invocazione: <itemizedlist>
								<listitem>
									<para><emphasis>http://host:port/govway/&lt;soggetto-dominio-interno>/LuhnCheckerSoap/v1</emphasis></para>
								</listitem>
							</itemizedlist>
							<note>
								<title>Soggetto Interno al Dominio</title>
								<para>In questo esempio si suppone che il nome del soggetto fornito
									durante la fase di installazione di GovWay sia
										<emphasis>Ente</emphasis>.</para>
							</note>
							<screen>curl -v -X POST "http://127.0.0.1:8080/govway/Ente/LuhnCheckerSoap/v1" \
-H 'Content-Type: text/xml;charset=UTF-8' \
-H 'SOAPAction: "http://ws.cdyne.com/CheckCC"' \
-d '&lt;soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/">
	&lt;soapenv:Header/>
	&lt;soapenv:Body>
		&lt;CheckCC xmlns="http://ws.cdyne.com/">
			&lt;CardNumber>4111111111111111&lt;/CardNumber>
		&lt;/CheckCC>
	&lt;/soapenv:Body>
&lt;/soapenv:Envelope>'</screen>
						</para>
						<para> L'esito della verifica viene ritornato con un codice http 200 e una
							risposta contenente i dettagli della carta:
							<screen>HTTP/1.1 200 OK
Connection: keep-alive
Server: GovWay
GovWay-Message-ID: b62dc163-e788-4dc2-9cee-40c77b0a7a29
GovWay-Transaction-ID: fc155be0-c1ac-4e2e-93f7-d69a30258069
Transfer-Encoding: chunked
Content-Type: text/xml;charset=utf-8
Date: Thu, 15 Nov 2018 13:34:22 GMT

&lt;soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
   &lt;soap:Body>
		&lt;CheckCCResponse xmlns="http://ws.cdyne.com/">
			&lt;CheckCCResult>
				&lt;CardType>VISA&lt;/CardType>
				&lt;CardValid>true&lt;/CardValid>
			&lt;/CheckCCResult>
		&lt;/CheckCCResponse>
   &lt;/soap:Body>
&lt;/soap:Envelope></screen>
						</para>
						<para> Per simulare la medesima richiesta utilizzando un messaggio SOAP 1.2
							è possibile usare la stessa url di invocazione :
							<screen>curl -v -X POST "http://127.0.0.1:8080/govway/Ente/LuhnCheckerSoap/v1" \
-H 'Content-Type: application/soap+xml; charset=utf-8' \
-d '&lt;soap12:Envelope xmlns:soap12="http://www.w3.org/2003/05/soap-envelope">
	&lt;soap12:Header/>
	&lt;soap12:Body>
		&lt;CheckCC xmlns="http://ws.cdyne.com/">
			&lt;CardNumber>4111111111111111&lt;/CardNumber>
		&lt;/CheckCC>
	&lt;/soap12:Body>
&lt;/soap12:Envelope>'</screen>
						</para>
					</listitem>
					<listitem>
						<para>
							<emphasis role="strong">Consultazione Tracce</emphasis>
						</para>
						<para>Attraverso la console <emphasis>govwayMonitor</emphasis> è possibile
							consultare lo storico delle transazioni che sono transitate nel gateway
							e recuperare i dettagli di una singola invocazione cosi come già
							descritto nella sezione <xref linkend="apiGateway_restHelloWorld"/>.
						</para>
					</listitem>
				</orderedlist>
			</para>
		</sect2>

		<sect2 id="apiGateway_fruizioneHelloWorld">
			<title>Fruizione API</title>
			<para> Procediamo adesso con la descrizione dei passi di configurazione necessari, ad un
				applicativo client interno al dominio di gestione, per poter fruire di una API REST
				esterna. L'API REST esterna utilizzata sarà lo <emphasis>Swagger Petstore</emphasis>
				descritto in <xref linkend="apiGateway"/> e poichè si suppone che tale scenario sia
				già stato provato non è necessario registrare nuovamente l'API. </para>
			<para> In GovWay ad ogni dominio, interno o esterno, viene associato ad un Soggetto.
				Nella sezione <xref linkend="apiGateway_multitenant"/> viene descritto come
				registrare più soggetti relativi a domini interni. In questo esempio, invece,
				procederemo con la registrazione di un soggetto esterno che rappresenta il gestore
				del dominio a cui appartiene il PetStore. </para>
			<para> La fruizione di API, per questo primo esempio di utilizzo, viene registrata in
				modo che sia accessibile in forma anonima da qualunque client invocando l'url
				esposta da GovWay. Una rappresentazione di questo scenario è mostrata nella figura
					<xref linkend="apiGateway_restHelloWorld_fruizione"/>. </para>
			<figure id="apiGateway_restHelloWorld_fruizione">
				<title>Fruizione di una API tramite GovWay</title>
				<mediaobject>
					<imageobject>
						<imagedata width="70%" fileref="FIGURE_OUT/fruizioneRESTBase.pdf"/>
					</imageobject>
					<imageobject>
						<imagedata width="70%" fileref="FIGURE_OUT/fruizioneRESTBase.png"/>
					</imageobject>
				</mediaobject>
			</figure>
			<para> Per registrare l'API su Govway, utilizzando la console
					<emphasis>govwayConsole</emphasis>, procedere come segue: <orderedlist>
					<listitem>
						<para>
							<emphasis role="strong">Registrazione nuovo Soggetto del dominio
								esterno</emphasis>
						</para>
						<para>Accedere alla sezione <emphasis>'Soggetti'</emphasis> e selezionare il
							pulsante <emphasis>'Aggiungi'</emphasis>. Fornire i seguenti dati: <itemizedlist>
								<listitem>
									<para>
										<emphasis>Dominio</emphasis>: selezionare la voce
											<emphasis>'Esterno'</emphasis>. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis>Nome</emphasis>: indicare il nome del Soggetto che
										rappresenta il nuovo dominio esterno, ad esempio
											<emphasis>'EnteEsterno'</emphasis>. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis>Tipologia</emphasis>: selezionare la voce
											<emphasis>'Erogatore'</emphasis>. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis>Descrizione</emphasis>: opzionalmente è possibile
										fornire una descrizione generica del soggetto. </para>
								</listitem>
							</itemizedlist>
							<figure id="apiGateway_restHelloWorld_fruizione_soggetto">
								<title>Registrazione nuovo Soggetto</title>
								<mediaobject>
									<imageobject>
										<imagedata width="50%"
											fileref="FIGURE_OUT/fruizioneRESTBaseRegistrazioneSoggetto.pdf"
										/>
									</imageobject>
									<imageobject>
										<imagedata width="50%"
											fileref="FIGURE_OUT/fruizioneRESTBaseRegistrazioneSoggetto.png"
										/>
									</imageobject>
								</mediaobject>
							</figure>
						</para>
					</listitem>
					<listitem>
						<para>
							<emphasis role="strong">Registrazione Fruizione</emphasis>
						</para>
						<para> Accedere alla sezione <emphasis>'Fruizioni'</emphasis> e selezionare
							il pulsante <emphasis>'Aggiungi'</emphasis>. Fornire i seguenti dati: <itemizedlist>
								<listitem>
									<para>
										<emphasis>API - Nome</emphasis>: selezionare l'API
										precedentemente registrata <emphasis>'PetStore
											v2'</emphasis>. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis>Soggetto Erogatore - Nome</emphasis>: selezionare
										il soggetto precedentemente registrato
											<emphasis>'EnteEsterno'</emphasis>. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis>Autenticazione - Stato</emphasis>: per esporre
										l'API in modo che sia invocabile da qualunque client in
										forma anonima selezionare lo stato
											<emphasis>'disabilitato'</emphasis>. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis>Connettore - Endpoint</emphasis>: indicare la
											<emphasis>base uri</emphasis> dove viene erogata l'API
										nel dominio esterno. Per il nostro esempio utilizzare la
										url: <itemizedlist>
											<listitem>
												<para><emphasis>http://petstore.swagger.io/v2</emphasis></para>
											</listitem>
										</itemizedlist>
									</para>
								</listitem>
							</itemizedlist>
							<figure id="apiGateway_restHelloWorld_fruizione_registrazione">
								<title>Registrazione di una fruizione di API</title>
								<mediaobject>
									<imageobject>
										<imagedata width="50%"
											fileref="FIGURE_OUT/fruizioneRESTBaseRegistrazioneFruizione.pdf"
										/>
									</imageobject>
									<imageobject>
										<imagedata width="50%"
											fileref="FIGURE_OUT/fruizioneRESTBaseRegistrazioneFruizione.png"
										/>
									</imageobject>
								</mediaobject>
							</figure>
						</para>
						<para>Effettuato il salvataggio, l'API erogata sarà consultabile all'interno
							dell'elenco delle fruizioni. Accedendo al dettaglio si potrà conoscere
								l'<emphasis>url di invocazione</emphasis> che deve essere comunicata
							ai client che desiderano invocare l'API. <figure
								id="apiGateway_restHelloWorld_fruizione_urlInvocazione">
								<title>URL di Invocazione dell'API erogata</title>
								<mediaobject>
									<imageobject>
										<imagedata width="50%"
											fileref="FIGURE_OUT/fruizioneRESTBaseConsultazioneFruizione.pdf"
										/>
									</imageobject>
									<imageobject>
										<imagedata width="50%"
											fileref="FIGURE_OUT/fruizioneRESTBaseConsultazioneFruizione.png"
										/>
									</imageobject>
								</mediaobject>
							</figure>
						</para>
					</listitem>
					<listitem>
						<para>
							<emphasis role="strong">Invocazione API tramite GovWay</emphasis>
						</para>
						<para>Al termine di questi passi di configurazione il servizio REST sarà
							raggiungibile dai client utilizzando l'url di invocazione: <itemizedlist>
								<listitem>
									<para><emphasis>http://host:port/govway/out/&lt;soggetto-dominio-interno>/EnteEsterno/PetStore/v2/&lt;uri-risorsa></emphasis></para>
								</listitem>
							</itemizedlist>
							<note>
								<title>Soggetto Interno al Dominio</title>
								<para>In questo esempio si suppone che il nome del soggetto fornito
									durante la fase di installazione di GovWay sia
										<emphasis>Ente</emphasis>.</para>
							</note>
							<screen>curl -v -X PUT "http://127.0.0.1:8080/govway/out/Ente/EnteEsterno/PetStore/v2/pet" \
-H "accept: application/json" \
-H "Content-Type: application/json" \
-d '{
        "id": 3,
        "category": { "id": 22, "name": "dog" },
        "name": "doggie",
        "photoUrls": [ "http://image/dog.jpg" ],
        "tags": [ { "id": 23, "name": "white" } ],
        "status": "available"
}'</screen>
						</para>
						<para> L'esito dell'aggiornamento viene confermato con un codice http 200 e
							una risposta json equivalente alla richiesta:
							<screen>HTTP/1.1 200 OK
Access-Control-Allow-Origin: *
Access-Control-Allow-Methods: GET, POST, DELETE, PUT
Access-Control-Allow-Headers: Content-Type, api_key, Authorization
Content-Type: application/json
Transfer-Encoding: chunked
Server: GovWay
GovWay-Message-ID: 84e1d9a4-c181-436f-b7f0-4cabf55c370d
GovWay-Transaction-ID: 6c13b9ac-3d60-45a6-9130-297a4d832824

{
	"id":3,
	"category":{"id":22,"name":"dog"},
	"name":"doggie",
	"photoUrls":["http://image/dog.jpg"],
	"tags":[{"id":23,"name":"white"}],
	"status":"available"
}</screen>
						</para>
					</listitem>
					<listitem>
						<para>
							<emphasis role="strong">Consultazione Tracce</emphasis>
						</para>
						<para>Attraverso la console <emphasis>govwayMonitor</emphasis> è possibile
							consultare lo storico delle transazioni che sono transitate nel gateway
							e recuperare i dettagli di una singola invocazione cosi come già
							descritto nella sezione <xref linkend="apiGateway_restHelloWorld"/>.
						</para>
					</listitem>
				</orderedlist>
			</para>
		</sect2>
	</sect1>

	<sect1 id="apiGateway_gruppiRisorseHelloWorld">
		<title>Configurazioni differenti per gruppi di risorse di una API</title>

		<para>Nei precedenti esempi tutte le risorse delle API REST o le azioni dei servizi SOAP
			vengono gestite dal Gateway tramite un'unica configurazione di default. Le funzionalità
			che verranno descritte nelle successive sezioni della guida (es. <xref
				linkend="controlloAccesso"/>, <xref linkend="rateLimiting"/>, <xref
				linkend="validazione"/> ...) possono essere attivate tramite un'unica configurazione
			su tutte le risorse/azioni dell'API o possono essere distinte a seconda delle
			caratteristiche applicative di ogni singola risorsa o azione. </para>
		<para> Di seguito, per fornire un esempio di raggruppamento delle risorse, ipotizziamo di
			classificare le operazioni del servizio <emphasis>Swagger Petstore</emphasis>, descritto
			in <xref linkend="apiGateway"/>, per il metodo http: <itemizedlist>
				<listitem>
					<para><emphasis>POST</emphasis>, <emphasis>PUT</emphasis>: per queste operazioni
						viene richiesta un'autenticazione <emphasis>http basic</emphasis>
					</para>
				</listitem>
				<listitem>
					<para><emphasis>DEL</emphasis>: per queste operazioni viene richiesta
						un'autenticazione <emphasis>https</emphasis></para>
				</listitem>
				<listitem>
					<para><emphasis>GET</emphasis>: queste operazioni sono utilizzabili in forma
						anonima</para>
				</listitem>
			</itemizedlist>
			<note>
				<title>Metodologia di classificazione solo a titolo di esempio</title>
				<para>la classificazione per metodo http e i tipi di autenticazione utilizzati sono
					solamente a titolo di esempio per descrivere la possibilità di definire
					configurazioni differenti per gruppi di risorse.</para>
			</note>
		</para>
		<para> Una rappresentazione di questo scenario è mostrata nella figura <xref
				linkend="apiGateway_gruppiRisorseHelloWorld_scenario"/>. <figure
				id="apiGateway_gruppiRisorseHelloWorld_scenario">
				<title>Configurazioni differenti per gruppi di risorse di una API</title>
				<mediaobject>
					<imageobject>
						<imagedata width="70%" fileref="FIGURE_OUT/gruppiRisorseRESTBase.pdf"/>
					</imageobject>
					<imageobject>
						<imagedata width="70%" fileref="FIGURE_OUT/gruppiRisorseRESTBase.png"/>
					</imageobject>
				</mediaobject>
			</figure>
		</para>
		<para> Per classificare in gruppi le risorse dell'API <emphasis>Swagger Petstore</emphasis>,
			utilizzando la console <emphasis>govwayConsole</emphasis>, procedere come segue: <orderedlist>
				<listitem>
					<para>
						<emphasis role="strong">Registrazione Gruppo 'Creazione e
							Modifica'</emphasis>
					</para>
					<para> Accedere alla sezione <emphasis>'Erogazioni'</emphasis> e selezionare
						l'API precedentemente registrata <emphasis>'PetStore v2'</emphasis>.
						Dopodichè accedere, dal dettaglio dell'erogazione, alla sezione
							<emphasis>'Gestione Gruppi Risorse'</emphasis> dove vengono visualizzati
						i gruppi in cui sono state classificate le risorse. Per default è presente
						un solo gruppo <emphasis>Predefinito</emphasis> a cui sono associate tutte
						le risorse (vedi figura <xref
							linkend="apiGateway_gruppiRisorseHelloWorld_predefinito"/>). <figure
							id="apiGateway_gruppiRisorseHelloWorld_predefinito">
							<title>Situazione iniziale con unico gruppo 'Predefinito'</title>
							<mediaobject>
								<imageobject>
									<imagedata width="50%"
										fileref="FIGURE_OUT/gruppiRisorseRESTBaseGruppoPredefinito.pdf"
									/>
								</imageobject>
								<imageobject>
									<imagedata width="50%"
										fileref="FIGURE_OUT/gruppiRisorseRESTBaseGruppoPredefinito.png"
									/>
								</imageobject>
							</mediaobject>
						</figure>
					</para>
					<para> Selezionare il pulsante <emphasis>'Aggiungi'</emphasis> e fornire i
						seguenti dati: <itemizedlist>
							<listitem>
								<para>
									<emphasis>Nome Gruppo</emphasis>: permette di associare un nome
									al gruppo delle risorse. Per il nostro esempio utilizzare il
									nome 'Creazione e Modifica'. </para>
							</listitem>
							<listitem>
								<para>
									<emphasis>Risorse</emphasis>: tramite la selezione multipla è
									possibile scegliere una o più risorse che dovranno appartenere
									al gruppo. Per il nostro esempio selezionare tutte le risorse
									con il metodo http <emphasis>POST</emphasis> e
										<emphasis>PUT</emphasis>. </para>
							</listitem>
							<listitem>
								<para>
									<emphasis>Modalità</emphasis>: indica se deve essere clonata la
									configurazione a partire dal gruppo indicato o se bisogna creare
									una configurazione ex-novo. Per riprodurre lo scenario di
									esempio precedentemente descritto selezionare
										<emphasis>Nuova</emphasis>. </para>
							</listitem>
							<listitem>
								<para>
									<emphasis>Autenticazione - Stato</emphasis>: per esporre l'API
									in modo che sia invocabile da client identificati tramite
									credenziali http-basic selezionare lo stato <emphasis>'http
										basic'</emphasis>. </para>
							</listitem>
						</itemizedlist>
						<figure id="apiGateway_gruppiRisorseHelloWorld_creazioneModifica">
							<title>Registrazione Gruppo 'Creazione e Modifica'</title>
							<mediaobject>
								<imageobject>
									<imagedata width="50%"
										fileref="FIGURE_OUT/gruppiRisorseRESTBaseGruppoCreazioneModifica.pdf"
									/>
								</imageobject>
								<imageobject>
									<imagedata width="50%"
										fileref="FIGURE_OUT/gruppiRisorseRESTBaseGruppoCreazioneModifica.png"
									/>
								</imageobject>
							</mediaobject>
						</figure>
					</para>
				</listitem>
				<listitem>
					<para>
						<emphasis role="strong">Registrazione Gruppo 'Eliminazione'</emphasis>
					</para>
					<para> Procedere, come descritto in precedenza, per registrare un ulteriore
						gruppo fornendo i seguenti dati: <itemizedlist>
							<listitem>
								<para>
									<emphasis>Nome Gruppo</emphasis>: 'Eliminazione'. </para>
							</listitem>
							<listitem>
								<para>
									<emphasis>Risorse</emphasis>: Selezionare tutte le risorse con
									il metodo http <emphasis>DEL</emphasis>. </para>
							</listitem>
							<listitem>
								<para>
									<emphasis>Modalità</emphasis>: Per riprodurre lo scenario di
									esempio precedentemente descritto selezionare
										<emphasis>Nuova</emphasis>. </para>
							</listitem>
							<listitem>
								<para>
									<emphasis>Autenticazione - Stato</emphasis>: selezionare lo
									stato <emphasis>'https'</emphasis>. </para>
							</listitem>
						</itemizedlist>
						<figure id="apiGateway_gruppiRisorseHelloWorld_eliminazione">
							<title>Registrazione Gruppo 'Eliminazione'</title>
							<mediaobject>
								<imageobject>
									<imagedata width="50%"
										fileref="FIGURE_OUT/gruppiRisorseRESTBaseGruppoEliminazione.pdf"
									/>
								</imageobject>
								<imageobject>
									<imagedata width="50%"
										fileref="FIGURE_OUT/gruppiRisorseRESTBaseGruppoEliminazione.png"
									/>
								</imageobject>
							</mediaobject>
						</figure>
					</para>
				</listitem>
				<listitem>
					<para>
						<emphasis role="strong">Verifica Gruppi Esistenti</emphasis>
					</para>
					<para> Dal dettaglio dell'erogazione, accedere alla sezione <emphasis>'Gestione
							Gruppi Risorse'</emphasis> dove adesso verranno visualizzati tre gruppi,
						i due gruppi creati in precedenza ed il gruppo predefinito che adesso
						contiene solamente le risorse con metodo http GET (vedi figura <xref
							linkend="apiGateway_gruppiRisorseHelloWorld_predefinito_verifica"/>). In
						questa sezione sarà possibile agire sui gruppi anche in un secondo momento
						aggiungendo o eliminando risorse da un gruppo o creandone di nuovi. <figure
							id="apiGateway_gruppiRisorseHelloWorld_predefinito_verifica">
							<title>Gruppi Registrati</title>
							<mediaobject>
								<imageobject>
									<imagedata width="50%"
										fileref="FIGURE_OUT/gruppiRisorseRESTBaseGruppoPredefinitoVerifica.pdf"
									/>
								</imageobject>
								<imageobject>
									<imagedata width="50%"
										fileref="FIGURE_OUT/gruppiRisorseRESTBaseGruppoPredefinitoVerifica.png"
									/>
								</imageobject>
							</mediaobject>
						</figure>
					</para>
					<para> Sempre dal dettaglio dell'erogazione, accedere alla sezione
							<emphasis>'Gestione Configurazione'</emphasis> dove vengono visualizzati
						i tre gruppi. In questa sezione sarà possibile configurare per ogni gruppo
						le funzionalità descritte nelle successive sezioni della guida (es. <xref
							linkend="controlloAccesso"/>, <xref linkend="rateLimiting"/>, <xref
							linkend="validazione"/> ...). Si può notare come i due gruppi creati per
						l'esempio possiedano un <emphasis>Controllo Accessi</emphasis> abilitato,
						mentre il gruppo <emphasis>Predefinito</emphasis> che contiene solo le
						risorse GET possiede tale funzionalità disabilitata. (vedi figura <xref
							linkend="apiGateway_gruppiRisorseHelloWorld_predefinito_verifica2"/>).
							<figure id="apiGateway_gruppiRisorseHelloWorld_predefinito_verifica2">
							<title>Configurazioni dei Gruppi</title>
							<mediaobject>
								<imageobject>
									<imagedata width="50%"
										fileref="FIGURE_OUT/gruppiRisorseRESTBaseGruppoPredefinitoVerifica2.pdf"
									/>
								</imageobject>
								<imageobject>
									<imagedata width="50%"
										fileref="FIGURE_OUT/gruppiRisorseRESTBaseGruppoPredefinitoVerifica2.png"
									/>
								</imageobject>
							</mediaobject>
						</figure>
					</para>
				</listitem>
				<listitem>
					<para>
						<emphasis role="strong">Reset Cache delle Configurazioni di
							GovWay</emphasis>
					</para>
					<para> Le configurazioni accedute da GovWay vengono mantenute in una cache dopo
						il primo accesso per 2 ore. Siccome nei precendenti punti abbiamo modificato
						una configurazione utilizzata nelle sezioni precedenti se non sono trascorse
						2 ore dall'ultimo utilizzo è necessario forzare un reset della cache. Per
						farlo accedere alla sezione <emphasis>'Strumenti' - 'Runtime'</emphasis> e
						selezionare la voce <emphasis>'ResetAllCaches'</emphasis>. (vedi figura
							<xref linkend="apiGateway_gruppiRisorseHelloWorld_resetCache"/>).
							<figure id="apiGateway_gruppiRisorseHelloWorld_resetCache">
							<title>Reset Cache delle Configurazioni di GovWay</title>
							<mediaobject>
								<imageobject>
									<imagedata width="30%" fileref="FIGURE_OUT/resetCache.pdf"/>
								</imageobject>
								<imageobject>
									<imagedata width="30%" fileref="FIGURE_OUT/resetCache.png"/>
								</imageobject>
							</mediaobject>
						</figure>
					</para>
				</listitem>
				<listitem>
					<para>
						<emphasis role="strong">Invocazione Anonima di una Risorsa del gruppo
							'Predefinito' completata con successo</emphasis>
					</para>
					<para>Effettuando una richiesta di un animale tramite http method
							<emphasis>GET</emphasis> si può vedere come la richiesta completa con
						successo:
						<screen>curl -v -X GET "http://127.0.0.1:8080/govway/Ente/PetStore/v2/pet/545646489" \
-H "accept: application/json"</screen>
					</para>
					<para> L'esito dell'aggiornamento viene confermato con un codice http 200 e una
						risposta json equivalente alla richiesta:
						<screen>HTTP/1.1 200 OK
Access-Control-Allow-Origin: *
Access-Control-Allow-Methods: GET, POST, DELETE, PUT
Access-Control-Allow-Headers: Content-Type, api_key, Authorization
Content-Type: application/json
Transfer-Encoding: chunked
Server: GovWay
GovWay-Message-ID: 84e1d9a4-c181-436f-b7f0-4cabf55c370d
GovWay-Transaction-ID: 6c13b9ac-3d60-45a6-9130-297a4d832824

{
	"id":545646489,
	"category": { "id":1, "name":"Akuke" },
	"name":"African Dwarf Dog",
	"photoUrls":["https://goo.gl/images/fxk2BX"],
	"tags":[{"id":0,"name":"Naughty Dog"}],"
	status":"available"
}</screen>
					</para>
				</listitem>
				<listitem>
					<para>
						<emphasis role="strong">Invocazione Anonima di una Risorsa del gruppo
							'Creazione e Modifica' terminata con errore</emphasis>
					</para>
					<para>Effettuando una modifica di un animale tramite http method
							<emphasis>PUT</emphasis> si può vedere come la richiesta termina con
						errore causato dal fatto che non si sono fornite credenziali <emphasis>http
							basic</emphasis>:
						<screen>curl -v -X PUT "http://127.0.0.1:8080/govway/Ente/PetStore/v2/pet" \
-H "accept: application/json" \
-H "Content-Type: application/json" \
-d '{
        "id": 3,
        "category": { "id": 22, "name": "dog" },
        "name": "doggie",
        "photoUrls": [ "http://image/dog.jpg" ],
        "tags": [ { "id": 23, "name": "white" } ],
        "status": "available"
}'</screen>
					</para>
					<para> L'esito dell'aggiornamento termina con un codice http 401 e una risposta
						contenente un json di errore generato dal Gateway (<emphasis>Problem
							Details</emphasis> come definito nella specifica <emphasis>RFC
							7807</emphasis>: <ulink url="https://tools.ietf.org/html/rfc7807"
							>https://tools.ietf.org/html/rfc7807</ulink>):
						<screen>HTTP/1.1 401 Unauthorized
Connection: keep-alive
WWW-Authenticate: Basic realm="GovWay"
Server: GovWay
Transfer-Encoding: chunked
GovWay-Transaction-ID: 15a60a91-edc1-4b7c-b7f0-b31739d543a0
Content-Type: application/problem+json
Date: Thu, 15 Nov 2018 16:07:10 GMT

{
	"type":"https://httpstatuses.com/401",
	"title":"Unauthorized",
	"status":401,
	"detail":"Autenticazione fallita, credenziali non fornite",
	"govway_status":"protocol:GOVWAY-109"
}</screen>
					</para>
					<para>Attraverso la console <emphasis>govwayMonitor</emphasis> è possibile
						consultare lo storico delle transazioni che sono transitate nel gateway.
						Dalla figura <xref linkend="apiGateway_gruppiRisorseHelloWorld_monitoraggio"
						/> si può vedere come le transazioni con metodo http
							<emphasis>PUT</emphasis> sono terminate con errore con esito
							<emphasis>Autenticazione Fallita</emphasis>. Accedendo al dettaglio
						della singola invocazione fallita è possibile esaminare i diagnostici emessi
						da GovWay nei quali viene evidenziato il motivo del fallimento (figura <xref
							linkend="apiGateway_gruppiRisorseHelloWorld_monitoraggio_dettaglio"/>).
							<figure id="apiGateway_gruppiRisorseHelloWorld_monitoraggio">
							<title>Tracce delle invocazioni transitate sul Gateway</title>
							<mediaobject>
								<imageobject>
									<imagedata width="50%"
										fileref="FIGURE_OUT/gruppiRisorseRESTBaseGruppoConsoltazioneStoricoTransazioni.pdf"
									/>
								</imageobject>
								<imageobject>
									<imagedata width="50%"
										fileref="FIGURE_OUT/gruppiRisorseRESTBaseGruppoConsoltazioneStoricoTransazioni.png"
									/>
								</imageobject>
							</mediaobject>
						</figure>
						<figure id="apiGateway_gruppiRisorseHelloWorld_monitoraggio_dettaglio">
							<title>Dettaglio di una invocazione fallita bloccata dal Gateway</title>
							<mediaobject>
								<imageobject>
									<imagedata width="30%"
										fileref="FIGURE_OUT/gruppiRisorseRESTBaseGruppoConsoltazioneStoricoTransazioniDettaglio.pdf"
									/>
								</imageobject>
								<imageobject>
									<imagedata width="30%"
										fileref="FIGURE_OUT/gruppiRisorseRESTBaseGruppoConsoltazioneStoricoTransazioniDettaglio.png"
									/>
								</imageobject>
							</mediaobject>
						</figure>
					</para>
				</listitem>

				<listitem>
					<para>
						<emphasis role="strong">Invocazione di una Risorsa del gruppo 'Creazione e
							Modifica' con credenziali 'http basic' completata con
							successo</emphasis>
					</para>
					<para> Per verificare che l'invocazione http descritta al punto precedente
						termini con successo in presenza di credenziali http basic si deve procedere
						con l'assegnazione di una credenziale ad un soggetto esterno al dominio. Di
						seguito viene descritto come fare tale assegnazione per completare
						l'esempio. Si rimanda poi alla sezione <xref
							linkend="controlloAccesso_autenticazione"/> per ulteriori dettagli sugli
						aspetti dell'autenticazione. </para>
					<para> Accedere al soggetto <emphasis>EnteEsterno</emphasis> creato in
						precedenza durante l'esempio descritto nella sezione <xref
							linkend="apiGateway_fruizioneHelloWorld"/> e associargli delle
						credenziali <emphasis>'http basic'</emphasis> come ad esempio un username
							<emphasis>enteEsterno</emphasis> ed una password
							<emphasis>123456</emphasis> (vedi figura <xref
							linkend="apiGateway_gruppiRisorseHelloWorld_associazioneCredenzialeSoggetto"
						/>). <figure
							id="apiGateway_gruppiRisorseHelloWorld_associazioneCredenzialeSoggetto">
							<title>Registrazione Gruppo 'Eliminazione'</title>
							<mediaobject>
								<imageobject>
									<imagedata width="50%"
										fileref="FIGURE_OUT/gruppiRisorseRESTBaseGruppoSoggettoAssociazioneCredenziale.pdf"
									/>
								</imageobject>
								<imageobject>
									<imagedata width="50%"
										fileref="FIGURE_OUT/gruppiRisorseRESTBaseGruppoSoggettoAssociazioneCredenziale.png"
									/>
								</imageobject>
							</mediaobject>
						</figure>
					</para>
					<para>Dopo aver associato le credenziali al soggetto effettuare il reset della
						cache delle configurazioni del Gateway come descritto in precedenza prima di
						procere con l'invocazione.</para>
					<para>Effettuando una modifica di un animale tramite http method
							<emphasis>PUT</emphasis> con le credenziali <emphasis>http
							basic</emphasis> si può vedere come la richiesta termina con successo:
						<screen>curl -v -X PUT "http://127.0.0.1:8080/govway/Ente/PetStore/v2/pet" --basic --user enteEsterno:123456 \								
-H "accept: application/json" \
-H "Content-Type: application/json" \
-d '{
        "id": 3,
        "category": { "id": 22, "name": "dog" },
        "name": "doggie",
        "photoUrls": [ "http://image/dog.jpg" ],
        "tags": [ { "id": 23, "name": "white" } ],
        "status": "available"
}'</screen>
					</para>
					<para> L'esito dell'aggiornamento viene confermato con un codice http 200 e una
						risposta json equivalente alla richiesta:
						<screen>HTTP/1.1 200 OK
Access-Control-Allow-Origin: *
Access-Control-Allow-Methods: GET, POST, DELETE, PUT
Access-Control-Allow-Headers: Content-Type, api_key, Authorization
Content-Type: application/json
Transfer-Encoding: chunked
Server: GovWay
GovWay-Message-ID: 84e1d9a4-c181-436f-b7f0-4cabf55c370d
GovWay-Transaction-ID: 6c13b9ac-3d60-45a6-9130-297a4d832824

{
	"id":3,
	"category":{"id":22,"name":"dog"},
	"name":"doggie",
	"photoUrls":["http://image/dog.jpg"],
	"tags":[{"id":23,"name":"white"}],
	"status":"available"
}</screen>
					</para>
				</listitem>

				<listitem>
					<para>
						<emphasis role="strong">Invocazione di una Risorsa del gruppo 'Eliminazione'
							con credenziali 'http basic' terminata con errore</emphasis>
					</para>
					<para>Effettuando una eliminazione di un animale tramite http method
							<emphasis>DEL</emphasis> si può vedere come la richiesta termina con
						errore causato dal fatto che non si sono fornite credenziali
							<emphasis>https</emphasis>:
						<screen>curl -v -X DELETE "http://127.0.0.1:8080/govway/Ente/PetStore/v2/pet/545646489" --basic --user enteEsterno:123456 \	
-H "accept: application/json"</screen>
					</para>
					<para> L'esito dell'eliminazione termina con un codice http 401 e una risposta
						contenente un json di errore generato dal Gateway (<emphasis>Problem
							Details</emphasis> come definito nella specifica <emphasis>RFC
							7807</emphasis>: <ulink url="https://tools.ietf.org/html/rfc7807"
							>https://tools.ietf.org/html/rfc7807</ulink>):
						<screen>HTTP/1.1 401 Unauthorized
Connection: keep-alive
Server: GovWay
Transfer-Encoding: chunked
GovWay-Transaction-ID: 15a60a91-edc1-4b7c-b7f0-b31739d543a0
Content-Type: application/problem+json
Date: Thu, 15 Nov 2018 16:07:10 GMT

{
	"type":"https://httpstatuses.com/401",
	"title":"Unauthorized",
	"status":401,
	"detail":"Autenticazione fallita, credenziali non fornite",
	"govway_status":"protocol:GOVWAY-109"
}</screen>
					</para>
					<para>Attraverso la console <emphasis>govwayMonitor</emphasis> è possibile
						consultare lo storico delle transazioni che sono transitate nel gateway.
						Dalla figura <xref
							linkend="apiGateway_gruppiRisorseHelloWorld_monitoraggio2"/> si può
						vedere come le transazioni con metodo http <emphasis>DEL</emphasis> sono
						terminate con errore con esito <emphasis>Autenticazione Fallita</emphasis>.
							<figure id="apiGateway_gruppiRisorseHelloWorld_monitoraggio2">
							<title>Tracce delle invocazioni transitate sul Gateway</title>
							<mediaobject>
								<imageobject>
									<imagedata width="50%"
										fileref="FIGURE_OUT/gruppiRisorseRESTBaseGruppoConsoltazioneStoricoTransazioni2.pdf"
									/>
								</imageobject>
								<imageobject>
									<imagedata width="50%"
										fileref="FIGURE_OUT/gruppiRisorseRESTBaseGruppoConsoltazioneStoricoTransazioni2.png"
									/>
								</imageobject>
							</mediaobject>
						</figure>
					</para>
				</listitem>

			</orderedlist>
		</para>
		<note>
			<title>Ripristino Erogazione API con il solo gruppo predefinito per prosieguo degli
				scenari</title>
			<para> Nei scenari descritti nelle successive sezioni verrà utilizzato sempre il gruppo
				predefinito per mostrare la funzionalità. Per tale motivo si consiglia di
				ripristinare la situazione iniziale eliminando i due gruppi creati in questa sezione
				accedendo al dettaglio dell'erogazione dell'API <emphasis>PetStore</emphasis> nella
				sezione <emphasis>'Gestione Gruppi Risorse'</emphasis>. </para>
		</note>
	</sect1>

	<sect1 id="apiGateway_sospensione">
		<title>Sospensione di una API</title>

		<para> Una erogazione o una fruizione di API, precedentemente configurata, può essere
			temporaneamente sospesa. L'effetto di una sospensione è quella di bloccare sul gateway
			le richieste e di ritornare al client oltre all'informazione che il servizio non è
			disponibile una indicazione su quando può riprovare tramite l'header http standard
				<emphasis>Retry-After</emphasis>. Una sospensione è utile in diversi scenari quali
			ad esempio: <itemizedlist>
				<listitem>
					<para><emphasis>Aggiornamento applicativo erogatore</emphasis>: Durante il
						periodo di aggiornamento di un applicativo erogatore una sospensione
						dell'erogazione permette di non intasare di richieste, che andrebbero in
						errore, il backend applicativo. </para>
				</listitem>
				<listitem>
					<para><emphasis>Problema applicativo client</emphasis>: Supponiamo che un
						applicativo client produca delle richieste, verso un dominio esterno, che
						generano errori dovuti a problemi del software del client. Una volta
						identificato il problema, per evitare di intasare di richieste errate il
						Dominio esterno può essere funzionale sospendere la fruizione dell'API fino
						a che il problema non viene risolto. </para>
				</listitem>
			</itemizedlist>
		</para>
		<para> Una rappresentazione di questo scenario è mostrata nella figura <xref
				linkend="apiGateway_sospensione_scenario"/>. <figure
				id="apiGateway_sospensione_scenario">
				<title>Sospensione di una API</title>
				<mediaobject>
					<imageobject>
						<imagedata width="70%" fileref="FIGURE_OUT/sospensioneBase.pdf"/>
					</imageobject>
					<imageobject>
						<imagedata width="70%" fileref="FIGURE_OUT/sospensioneBase.png"/>
					</imageobject>
				</mediaobject>
			</figure>
		</para>
		<para> Per sospendere una erogazione o fruizione di API, utilizzando la console
				<emphasis>govwayConsole</emphasis> dal dettaglio dell'erogazione o della fruizione
			accedere alla sezione <emphasis>'Gestione Configurazione'</emphasis>. Cliccando
			sull'icona di stato verde comparirà una finestra di dialogo dove viene richiesto di
			confermare la sospensione. La figura <xref
				linkend="apiGateway_sospensione_disattivazione"/> mostra una sospensione in corso
			dell'erogazione registrata nella sezione <xref linkend="apiGateway_restHelloWorld"/>.
				<figure id="apiGateway_sospensione_disattivazione">
				<title>Sospensione di una erogazione</title>
				<mediaobject>
					<imageobject>
						<imagedata width="50%" fileref="FIGURE_OUT/sospensioneDisattivazione.pdf"/>
					</imageobject>
					<imageobject>
						<imagedata width="50%" fileref="FIGURE_OUT/sospensioneDisattivazione.png"/>
					</imageobject>
				</mediaobject>
			</figure>
		</para>
		<para> Procedendo con la conferma l'erogazione sarà a tutti gli effetti sospesa come mostra
			anche l'icona di stato rossa (vedi figura <xref linkend="apiGateway_sospensione_elenco"
			/>). <figure id="apiGateway_sospensione_elenco">
				<title>Erogazione sospesa</title>
				<mediaobject>
					<imageobject>
						<imagedata width="50%" fileref="FIGURE_OUT/sospensioneElenco.pdf"/>
					</imageobject>
					<imageobject>
						<imagedata width="50%" fileref="FIGURE_OUT/sospensioneElenco.png"/>
					</imageobject>
				</mediaobject>
			</figure>
		</para>
		<para> L'informazione sullo stato di sospensione di una erogazione o una fruizione viene
			fornita, tramite l'icona di stato, anche nell'elenco principale come mostrato nella
			figura <xref linkend="apiGateway_sospensione_elencoErogazioni"/>. <figure
				id="apiGateway_sospensione_elencoErogazioni">
				<title>Stato disabilitato riportato nell'elenco delle erogazioni</title>
				<mediaobject>
					<imageobject>
						<imagedata width="50%" fileref="FIGURE_OUT/sospensioneElencoErogazioni.pdf"
						/>
					</imageobject>
					<imageobject>
						<imagedata width="50%" fileref="FIGURE_OUT/sospensioneElencoErogazioni.png"
						/>
					</imageobject>
				</mediaobject>
			</figure>
		</para>

		<para>Effettuando una modifica di un animale tramite http method <emphasis>PUT</emphasis> si
			può vedere come la richiesta termina con errore causato dal fatto che l'erogazione
			risulta sospesa:
			<screen>curl -v -X PUT "http://127.0.0.1:8080/govway/Ente/PetStore/v2/pet" \
-H "accept: application/json" \
-H "Content-Type: application/json" \
-d '{
        "id": 3,
        "category": { "id": 22, "name": "dog" },
        "name": "doggie",
        "photoUrls": [ "http://image/dog.jpg" ],
        "tags": [ { "id": 23, "name": "white" } ],
        "status": "available"
}'</screen>
		</para>
		<para> L'esito dell'aggiornamento termina con un codice http 503, un header http
				<emphasis>Retry-After</emphasis> contenenete l'indicazione sul numero di secondi
			dopo i quali un client dovrebbe ripresentarsi e una risposta contenente un json di
			errore generato dal Gateway (<emphasis>Problem Details</emphasis> come definito nella
			specifica <emphasis>RFC 7807</emphasis>: <ulink
				url="https://tools.ietf.org/html/rfc7807"
				>https://tools.ietf.org/html/rfc7807</ulink>):
			<screen>HTTP/1.1 503 Service Unavailable
Connection: keep-alive
Retry-After: 338
Server: GovWay
Transfer-Encoding: chunked
GovWay-Transaction-ID: 15a60a91-edc1-4b7c-b7f0-b31739d543a0
Content-Type: application/problem+json
Date: Thu, 15 Nov 2018 16:07:10 GMT

{
	"type":"https://httpstatuses.com/503",
	"title":"Service Unavailable",
	"status":503,
	"detail":"Porta disabilitata",
	"govway_status":"integration:GOVWAY-446"
}</screen>
		</para>
		<para>Attraverso la console <emphasis>govwayMonitor</emphasis> è possibile consultare lo
			storico delle transazioni che sono transitate nel gateway. Dalla figura <xref
				linkend="apiGateway_sospensione_monitoraggio"/> si può vedere come le transazioni
			generate dopo la sospensione sono terminate con errore con esito <emphasis>API
				Sospesa</emphasis>. <figure id="apiGateway_sospensione_monitoraggio">
				<title>Tracce delle invocazioni transitate sul Gateway</title>
				<mediaobject>
					<imageobject>
						<imagedata width="50%"
							fileref="FIGURE_OUT/sospensioneConsoltazioneStoricoTransazioni.pdf"/>
					</imageobject>
					<imageobject>
						<imagedata width="50%"
							fileref="FIGURE_OUT/sospensioneConsoltazioneStoricoTransazioni.png"/>
					</imageobject>
				</mediaobject>
			</figure>
		</para>

		<para> Se per una erogazione o fruizione di API è stata effettuata la classificazione delle
			risorse in gruppi, come mostrato nella sezione <xref
				linkend="apiGateway_gruppiRisorseHelloWorld"/>, la sospensione può essere effettuata
			sul singolo gruppo. </para>
		<para> La figura <xref linkend="apiGateway_sospensione_gruppo_elenco"/> mostra un esempio di
			sospensione, nello scenario <xref linkend="apiGateway_gruppiRisorseHelloWorld"/>, del
			solo gruppo <emphasis>'Predefinito'</emphasis>. <figure
				id="apiGateway_sospensione_gruppo_elenco">
				<title>Gruppo di una erogazione sospeso</title>
				<mediaobject>
					<imageobject>
						<imagedata width="50%" fileref="FIGURE_OUT/sospensioneGruppiElenco.pdf"/>
					</imageobject>
					<imageobject>
						<imagedata width="50%" fileref="FIGURE_OUT/sospensioneGruppiElenco.png"/>
					</imageobject>
				</mediaobject>
			</figure>
		</para>
		<para> L'informazione sullo stato di sospensione parziale (relativa a non tutti i gruppi) di
			una erogazione o una fruizione viene fornita, tramite un icona di stato gialla, anche
			nell'elenco principale come mostrato nella figura <xref
				linkend="apiGateway_sospensione_gruppo_elencoErogazioni"/>. <figure
				id="apiGateway_sospensione_gruppo_elencoErogazioni">
				<title>Stato disabilitato di un gruppo riportato nell'elenco delle
					erogazioni</title>
				<mediaobject>
					<imageobject>
						<imagedata width="50%"
							fileref="FIGURE_OUT/sospensioneGruppiStatoGialloElenco.pdf"/>
					</imageobject>
					<imageobject>
						<imagedata width="50%"
							fileref="FIGURE_OUT/sospensioneGruppiStatoGialloElenco.png"/>
					</imageobject>
				</mediaobject>
			</figure>
		</para>


	</sect1>

	<sect1 id="gestioneCORS">
		<title>Gestione CORS</title>
		<para>TODO</para>
	</sect1>

	<sect1 id="controlloAccesso">
		<title>Controllo degli Accessi</title>

		<sect2 id="controlloAccesso_token">
			<title>OAuth</title>
			<para>TODO: Descrizione generica scenario </para>


			<sect3 id="controlloAccesso_token_introspection">
				<title>Verifica tramite Introspection</title>
				<para>TODO </para>
			</sect3>

			<sect3 id="controlloAccesso_token_jwt">
				<title>Verifica con Validazione JWT</title>
				<para>TODO </para>
			</sect3>

			<sect3 id="controlloAccesso_token_userInfo">
				<title>Autenticazione e UserInfo</title>
				<para>TODO </para>
			</sect3>

			<sect3 id="controlloAccesso_token_autorizzazione">
				<title>Autorizzazione sui Claims</title>
				<para>TODO </para>
			</sect3>

			<sect3 id="controlloAccesso_token_xacml">
				<title>Autorizzazione XACML</title>
				<para>TODO </para>
			</sect3>

		</sect2>

		<sect2 id="controlloAccesso_autenticazione">
			<title>Autenticazione</title>
			<para>TODO: Descrizione generica scenario </para>

			<sect3 id="controlloAccesso_autenticazione_basic">
				<title>Autenticazione Http Basic</title>
				<para>TODO </para>
			</sect3>

			<sect3 id="controlloAccesso_autenticazione_ssl">
				<title>Autenticazione Https</title>
				<para>TODO </para>
			</sect3>

			<sect3 id="controlloAccesso_autenticazione_principal">
				<title>Autenticazione Container</title>
				<para>TODO </para>
			</sect3>

		</sect2>

		<sect2 id="controlloAccesso_autorizzazione">
			<title>Autorizzazione</title>
			<para>TODO: Descrizione generica scenario </para>

			<sect3 id="controlloAccesso_autorizzazione_puntuale">
				<title>Autorizzazione Puntuale</title>
				<para>TODO </para>
			</sect3>

			<sect3 id="controlloAccesso_autorizzazione_ruoli">
				<title>Autorizzazione per Ruoli</title>
				<para>TODO </para>
			</sect3>

			<sect3 id="controlloAccesso_autorizzazione_xacml">
				<title>XACML</title>
				<para>TODO </para>
			</sect3>

		</sect2>
	</sect1>

	<sect1 id="rateLimiting">
		<title>Rate Limiting</title>

		<para>TODO: Descrizione generica scenario </para>

		<sect2 id="rateLimiting_numeroRichieste">
			<title>Numero massimo di Richieste</title>
			<para>TODO </para>
		</sect2>

		<sect2 id="rateLimiting_numeroRichiesteConcorrenti">
			<title>Numero massimo di Richieste Concorrenti</title>
			<para>TODO </para>
		</sect2>

		<sect2 id="rateLimiting_bandaOccupata">
			<title>Massima Banda Occupabile</title>
			<para>TODO </para>
		</sect2>

		<sect2 id="rateLimiting_tempoMedioRisposta">
			<title>Tempo Medio di Risposta</title>
			<para>TODO </para>
		</sect2>

		<sect2 id="rateLimiting_numeroFault">
			<title>Numero massimo di Fault Applicativi</title>
			<para>TODO </para>
		</sect2>

	</sect1>

	<sect1 id="validazione">
		<title>Validazione Messaggi</title>

		<para>TODO: Descrizione generica scenario </para>

		<sect2 id="validazione_rest">
			<title>Validazione API REST</title>
			<para>TODO </para>
		</sect2>

		<sect2 id="validazione_soap">
			<title>Validazione API SOAP</title>
			<para>TODO </para>
		</sect2>

	</sect1>

	<sect1 id="responseCaching">
		<title>Caching Risposte</title>

		<para>TODO: Descrizione generica scenario </para>



	</sect1>

	<sect1 id="sicurezza">
		<title>Sicurezza Messaggi</title>

		<para>TODO: Descrizione generica scenario dove si crea sia un mittente che un destinatario a
			scopi di test. </para>

		<sect2 id="sicurezza_soap_signature">
			<title>WSSecurity Signature</title>
			<para>TODO </para>
		</sect2>

		<sect2 id="sicurezza_soap_encrypt">
			<title>WSSecurity Encrypt</title>
			<para>TODO </para>
		</sect2>

		<sect2 id="sicurezza_soap_saml">
			<title>WSSecurity SAML</title>
			<para>TODO </para>
		</sect2>

		<sect2 id="validazione_rest_jws">
			<title>JWT Signature</title>
			<para>TODO </para>
		</sect2>

		<sect2 id="validazione_rest_jwe">
			<title>JWT Encrypt</title>
			<para>TODO </para>
		</sect2>

	</sect1>

	<sect1 id="dump">
		<title>Registrazione Messaggi</title>

		<para>TODO: Descrizione generica scenario </para>



	</sect1>

	<sect1 id="tracciamento">
		<title>Tracciamento</title>

		<para>TODO: Descrizione generica scenario </para>

		<sect2 id="tracciamento_rest">
			<title>Correlazione Applicativa su API REST</title>
			<para>TODO </para>
		</sect2>

		<sect2 id="tracciamento_soap">
			<title>Correlazione Applicativa su API SOAP</title>
			<para>TODO </para>
		</sect2>

		<sect2 id="tracciamento_disabilitato">
			<title>Disattivazione</title>
			<para>TODO </para>
		</sect2>

		<sect2 id="tracciamento_log">
			<title>Livello di Log</title>
			<para>TODO </para>
		</sect2>

	</sect1>

	<sect1 id="mtom">
		<title>MTOM</title>

		<para>TODO: Descrizione generica scenario dove viene simulato l'invio e la ricezione. </para>

		<sect2 id="mtom_packaging">
			<title>Packaging</title>
			<para>TODO </para>
		</sect2>

		<sect2 id="mtom_unpackaging">
			<title>Unpackaging</title>
			<para>TODO </para>
		</sect2>

		<sect2 id="mtom_validaziones">
			<title>Validazione</title>
			<para>TODO </para>
		</sect2>

		<sect2 id="mtom_verifica">
			<title>Verifica</title>
			<para>TODO </para>
		</sect2>

	</sect1>

	<sect1 id="fatturaPA">
		<title>Profilo FatturaPA</title>

		<para>TODO: Descrizione generica </para>

		<sect2 id="sdi_attiva">
			<title>Fatturazione Attiva</title>
			<para>TODO </para>
		</sect2>

		<sect2 id="sdi_passiva">
			<title>Fatturazione Passiva</title>
			<para>TODO </para>
		</sect2>

	</sect1>

	<sect1 id="spcoop">
		<title>Profilo SPCoop</title>

		<para>TODO: Descrizione generica </para>

		<sect2 id="spcoop_oneway">
			<title>Profilo Oneway</title>
			<para>TODO </para>
		</sect2>

		<sect2 id="spcoop_sincrono">
			<title>Profilo Sincrono</title>
			<para>TODO </para>
		</sect2>

		<sect2 id="spcoop_asincrono_simmetrico">
			<title>Profilo Asincrono Simmetrico</title>
			<para>TODO </para>
		</sect2>

		<sect2 id="spcoop_asincrono_asimmetrico">
			<title>Profilo Asincrono Asimmetrico</title>
			<para>TODO </para>
		</sect2>

	</sect1>

	<sect1>
		<title>Analisi Statistica</title>

		<para>TODO: Descrizione generica </para>

		<sect2 id="stats_1">
			<title>Distribuzione Temporale</title>
			<para>TODO </para>
		</sect2>

		<sect2 id="stats_2">
			<title>Distribuzione per Esiti</title>
			<para>TODO </para>
		</sect2>


	</sect1>

</article>
