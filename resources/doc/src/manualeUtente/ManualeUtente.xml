<?xml version='1.0'?>
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook V5.0//IT"
                   "/usr/share/sgml/docbook/xml-dtd-4.5/docbookx.dtd">
<article lang="it">
	<articleinfo>
		<title>Guida Utente della govwayConsole</title>

		<titleabbrev>Guida Utente della govwayConsole</titleabbrev>

		<copyright>
			<year>2005-2018</year>

			<holder>
				<ulink url="http://www.link.it">
					<citetitle>Link.it srl</citetitle>
				</ulink>
			</holder>
		</copyright>

		<address> Link.it SRL <street> Via S. Martino,51 </street>
			<postcode>I-56125</postcode><city> Pisa</city>
			<country> ITALY </country>
			<email>e-mail: info@link.it</email>
		</address>
	</articleinfo>

	<!-- 1. Scopo del Documento -->

	<sect1 id="intro">
		<title>Introduzione</title>

		<para>Questo manuale documenta le funzionalità e le modalità d'uso della <emphasis>Console
				di Gestione</emphasis> del prodotto <emphasis>GovWay</emphasis> (<ulink
				url="http://govway.org/">http://gowway.org</ulink>). </para>
		<note>
			<para> Oltre alla console di Gestione, GowWay mette a disposizione dei gestori una
				seconda console utilizzata per il monitoraggio delle richieste applicative gestite
				dal gateway. Per informazioni sulle modalità di utilizzo della Console di
				Monitoraggio si rimanda alla relativa manualistica distribuita con il prodotto.
			</para>
		</note>

		<para>Nel prosieguo si assume che il prodotto GovWay sia già correttamente installato e la
			console di gestione sia accessibile via browser dai Gestori del Sistema. </para>
		<para> L'indirizzo standard della Console di Gestione è
				<emphasis>http://ip:porta/govwayConsole</emphasis>, che dovrà essere correttamente
			perfezionato con ip e porta del proprio ambiente di installazione. Per informazioni
			sulle modalità di installazione si rimanda alla relativa manualistica distribuita con il
			prodotto. </para>
		<note>
			<para> L'accesso alle diverse funzionalità della console è sempre mediato da un sistema
				di autorizzazione che verifica che l'utente sia in possesso dei dovuti permessi. Le
				istruzioni operative sulla gestione degli utenti e la configurazione dei permessi
				sono descritte nella <xref linkend="config-utenti"/>. </para>
		</note>

		<sect2 id="profili">
			<title>I Profili di Interoperabilità</title>
			<para> GovWay si differenzia dagli API Gateway tradizionali per essere progettato in
				conformità con i principali profili di interoperabilità in uso nella Pubblica
				Amministrazione italiana ed europea. Per tale motivo, le modalità di configurazione
				del prodotto si differenziano in funzione dello specifico profilo a cui le API
				debbano conformarsi. I profili di interoperabilità supportati dalla distribuzione
				standard del prodotto sono i seguenti: <itemizedlist>
					<listitem>
						<para><emphasis>API Gateway</emphasis>: è il profilo più generico e permette
							di supportare, in accordo alle linee guida di interoperabilità di AGID,
							qualunque generica API basata su scambio di messaggi SOAP e REST.</para>
					</listitem>
					<listitem>
						<para><emphasis>eDelivery</emphasis>: è il profilo standard adottato a
							livello europeo nell'ambito del progetto <emphasis>CEF</emphasis>, e
							basato sul protocollo AS4. </para>
					</listitem>
					<listitem>
						<para><emphasis>SPCoop</emphasis>: il profilo SPCoop è il profilo basato
							sull'uso della busta eGov e sulla Porta di Dominio, recentemente
							deprecato da AGID, ma ancora in uso per la quasi totalità dei servizi
							centrali erogati dalla Pubblica Amministrazione italiana.</para>
					</listitem>
					<listitem>
						<para><emphasis>FatturaPA</emphasis>: questo profilo supporta le modalità di
							scambio delle fatture elettroniche veicolate tramite il Sistema di
							Interscambio della Fatturazione Elettronica.</para>
					</listitem>
				</itemizedlist>
			</para>

			<para> In fase di installazione possono essere scelti i profili di proprio interesse
				(per default viene proposto il solo profilo di API Gateway). </para>
			<para> Durante l'utilizzo della Console di Gestione è preferibile selezionare il profilo
				di interoperabilità adeguato in base al tipo di configurazioni sui quali si lavora.
				La selezione del profilo di interoperabilità, tramite il menu presente in testata
					(<xref linkend="profilo_fig"/>), comporta la visualizzazione dei soli elementi
				dell'interfaccia, e relativi dati, attinenti con tale profilo. <figure
					id="profilo_fig">
					<title>Selezione del profilo di interoperabilità</title>
					<mediaobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/profiloInteroperabilita.png"
							/>
						</imageobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/profiloInteroperabilita.pdf"
							/>
						</imageobject>
					</mediaobject>
				</figure>
			</para>
			<para> Esiste la possibilità (non consigliata) di operare sulla console selezionando il
				profilo <emphasis>Tutti</emphasis>. In tal caso non saranno applicati filtri sui
				contenuti e le maschere di visualizzazione e di configurazione potranno apparire più
				complesse di quanto avviene selezionando lo specifico profilo su cui si sta
				lavorando. </para>

			<note>
				<para> Ulteriori profili sono programmabili in GovWay ed alcuni di questi sono in
					uso in importanti progetti della pubblica amministrazione, come la Porta di
					Comunicazione del Sistema di Interscambio del Mercato dell'Energia. </para>
			</note>

		</sect2>
		<sect2 id="entita">
			<title>Le entità di configurazione dei servizi</title>
			<para>Prima di descrivere le entità di configurazione presenti nel registro è importante
				chiarire il concetto di <emphasis>Dominio</emphasis> cui alcuni elementi di
				configurazione fanno riferimento. Il dominio rappresenta il confine logico
				(tipicamente un ente amministrativo) entro il quale sono racchiuse le risorse
				applicative da condividere con l'esterno. Nel seguito si fa distinzione tra i
				seguenti: <itemizedlist>
					<listitem>
						<para><emphasis>Dominio Gestito</emphasis>: l'insieme delle risorse
							applicative i cui flussi di comunicazione sono sotto il controllo del
							GovWay di propria gestione.</para>
					</listitem>
					<listitem>
						<para><emphasis>Dominio Esterno</emphasis>: Insieme di risorse applicative
							esterne al dominio gestito.</para>
					</listitem>
				</itemizedlist> Le principali entità di configurazione del Registro sono: <itemizedlist>
					<listitem>
						<para>
							<emphasis>Soggetto</emphasis>
						</para>
						<para> Entità che rappresenta la singola organizzazione, o ente
							amministrativo, coinvolto nei flussi di comunicazione. Ciascun soggetto
							censito nel registro può appartenere al dominio interno o esterno e può
							avere associata un'unica modalità operativa. </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>API</emphasis>
						</para>
						<para> Descrizione formale dei flussi di comunicazione previsti da un dato
							servizio, erogato o fruito nel proprio dominio. Ad ogni API è assegnata
							una singola modalità operativa e, in base ad essa, sarà fornita una
							descrizione formale delle interfacce di dialogo supportate. Ad esempio
							saranno forniti WSDL/XSD per le interfacce Soap o un file YAML in
							formato Swagger per quelle Rest.</para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Erogazione</emphasis>
						</para>
						<para> Registrazione di una specifica istanza di servizio che un soggetto
							del dominio interno eroga in accordo alle interfacce applicative
							descritte da un set di API censito nel registro.</para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Fruizione</emphasis>
						</para>
						<para> Registrazione di una specifica istanza di servizio che un soggetto
							del dominio interno fruisce in accordo alle interfacce applicative
							descritte da un set di API censito nel registro.</para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Ruolo</emphasis>
						</para>
						<para> Entità per censire i ruoli che possono essere utilizzati nell'ambito
							del controllo degli accessi per costruire specifici criteri di
							autorizzazione. I ruoli possono avere origine interna al registro oppure
							essere passati da un sistema esterno, sia in contesti fruizione che di
							erogazione.</para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Applicativo</emphasis>
						</para>
						<para> Entità per censire i client, riferiti ad uno specifico soggetto (e
							quindi modalità), che fruiscono di servizi. Censire un applicativo è
							indispensabile nei casi in cui l'identificazione è necessaria per poter
							superare i criteri di autenticazione autorizzazione specificati nella
							configurazione del <emphasis>Controllo degli Accessi</emphasis> per
							ciascun servizio fruito.</para>
					</listitem>
				</itemizedlist>
			</para>
		</sect2>
		<sect2 id="processo">
			<title>Il processo di configurazione dei servizi</title>
			<para> Le sezioni successive del documento illustrano i passi necessari per realizzare
				le configurazioni necessarie per rendere operativi i flussi di erogazione/fruizione
				dei servizi nei diversi profili di interoperabilità supportati. </para>
			<para> Per semplificare il processo di configurazione, nel caso di configurazioni per
				l'interoperabilità con le note piattaforme di erogazione di servizi centralizzate,
				GovWay mette a disposizione specifici package, denominati
					<emphasis>Govlet</emphasis>. Il Govlet, attraverso un modello di tipo wizard,
				consente all'utente di fornire i dati necessari a produrre le entità di
				configurazione per uno specifico servizio. I Govlet disponibili possono essere
				acquisiti dal sito di Govway al seguente indirizzo <ulink
					url="http://www.govway.org/govlets">http://www.govway.org/govlets</ulink>.
				Alcuni esempi di Govlet: <itemizedlist>
					<listitem>
						<para>
							<emphasis>FatturaPA - Fatturazione Attiva</emphasis>: configurazione del
							servizio per l'invio di fatture elettroniche al Sistema d'Interscambio
							(SDI). </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>FatturaPA - Fatturazione Passiva</emphasis>: configurazione
							del servizio per la ricezione di fatture elettroniche dal Sistema
							d'Interscambio (SDI). </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>SIOPE+</emphasis>: configurazione del servizio per l'invio
							degli ordinativi di pagamento alla piattaforma SIOPE+ e ricezione delle
							relative notifiche e giornale di cassa. </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>pagoPA</emphasis>: configurazione del servizio per l'accesso
							alla piattaforma dei pagamenti elettronici pagoPA. </para>
					</listitem>
				</itemizedlist>
			</para>
			<para> Una volta entrati in possesso del Govlet è necessario eseguirlo sulla
				govwayConsole tramite la funzione <emphasis>Importa</emphasis> descritta nella <xref
					linkend="config-importa"/>. </para>
			<para> Per procedere manualmente alla produzione delle configurazioni per i servizi, si
				utilizzano le funzionalità presenti nella sezione <emphasis>Registro</emphasis>
				della GovWayConsole. Il processo manuale di configurazione può essere schematizzato
				nei passi seguenti: <orderedlist>
					<listitem>
						<para>
							<emphasis>Definizione delle API</emphasis>. Il primo passo prevede la
							definizione delle API relative ai servizi che si vogliono utilizzare. In
							questa fase tipicamente si provvede al caricamento del descrittore
							formale delle interfacce (WSDL, WADL, ...). </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Registrazione dell'erogazione o fruizione</emphasis>. Il
							secondo passo, dopo aver registrato l'API del servizio, prevede la
							creazione di una Erogazione, o di una Fruizione, a seconda del ruolo
							previsto nell'interazione col servizio. </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Configurazione Specifica</emphasis>. Le interfacce della
							GovWayConsole sono state progettate in modo che, il completamento dei
							primi due passi di configurazione, sia sufficiente a disporre di una
							configurazione funzionante del servizio. Il terzo, e quindi opzionale
							passo, consiste nella produzione di tutti i dettaglio aggiuntivi di
							configurazione che sono necessari alla particolare situazione. </para>
						<para> In questo passo si forniscono i dettagli delle funzionalità
							aggiuntive, che riguardano: <itemizedlist>
								<listitem>
									<para>
										<emphasis>Controllo degli Accessi</emphasis>: indicazione
										dei criteri di autenticazione e autorizzazione necessari per
										l'accesso al servizio. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis>Validazione</emphasis>: processo di validazione
										dei messaggi in transito sul gateway. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis>Sicurezza Messaggio</emphasis>: misure di
										sicurezza al livello del messaggio richieste. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis>Tracciamento</emphasis>: personalizzazione delle
										tracce prodotte nel corso dell'elaborazione delle richieste
										di servizio. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis>Registrazione Messaggi</emphasis>: indicazione dei
										criteri di salvataggio degli elementi che compongono le
										richieste di servizio (payload, header, allegati, ...).
									</para>
								</listitem>
							</itemizedlist>
						</para>
					</listitem>
				</orderedlist>
			</para>
			<para> La <xref linkend="fasiProcessamento_fig"/> descrive lo scenario generale in cui
				opera GovWay <figure id="fasiProcessamento_fig">
					<title>Fasi dell'elaborazione di una richiesta</title>
					<mediaobject>
						<imageobject>
							<imagedata width="80%"
								fileref="FIGURE_OUT/ArchitetturaFunzionaleGovWay.png"/>
						</imageobject>
						<imageobject>
							<imagedata width="80%"
								fileref="FIGURE_OUT/ArchitetturaFunzionaleGovWay.pdf"/>
						</imageobject>
					</mediaobject>
				</figure>
			</para>
			<para> La sezioni successive descrivono in dettaglio il processo di configurazione di
				cui sopra, fornendo i dettagli specifici per ciascun profilo di interoperabilità.
			</para>
		</sect2>
	</sect1>


	<!-- EROGAZIONE API GATEWAY -->

	<sect1 id="gateway">
		<title>Profilo "API Gateway"</title>
		<para>In questa sezione descriviamo le fasi di configurazione di GovWay al fine di attivare
			l'erogazione o la fruizione di servizi che rispettano lo standard Soap o Rest. Per
			semplificare l'utilizzo della console grafica govwayConsole, è consigliabile effettuare
			la selezione del profilo <emphasis>API Gateway</emphasis> tramite l'apposito selettore
			posto nell'intestazione della pagina.</para>

		<sect2>
			<title>Definizione delle API</title>
			<para> Indipendentemente che si voglia erogare o fruire un servizio, è necessario
				iniziare il processo di configurazione con il censimento delle relative API. Questa
				operazione si effettua sulla govwayConsole posizionandosi nella sezione
					<emphasis>Registro > API</emphasis>. </para>
			<para> La pagina di ingresso mostra l'elenco delle API eventualmente già presenti in
				configurazione. Ciascun elemento dell'elenco riporta l'identificativo, il tipo SOAP
				o REST e il formato del descrittore fornito in configurazione (<xref
					linkend="API-list-fig"/>). <figure id="API-list-fig">
					<title>Elenco delle API</title>
					<mediaobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/API-list.pdf"/>
						</imageobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/API-list.png"/>
						</imageobject>
					</mediaobject>
				</figure>
			</para>
			<para>Gli elementi dell'elenco possono essere selezionati per l'eliminazione, con il
				pulsante Elimina, e per l'esportazione, con il pulsante Esporta. La funzione di
				esportazione è descritta nella <xref linkend="config-Esporta"/>. </para>
			<note>
				<para> Le API in elenco sono visualizzate con un'icona colorata affiancata al nome.
					L'icona di colore rosso indica un problema nella configurazione e quindi
					l'inutilizzabilità della API. L'icona gialla indica il parziale utilizzo
					limitato agli elementi configurati correttamente. L'icona verde indica la piena
					funzionalità. </para>
			</note>
			<para>Si crea una nuova API premendo il pulsante <emphasis>Aggiungi</emphasis>. </para>
			<figure id="API-new-fig">
				<title>Definizione di una API</title>
				<mediaobject>
					<imageobject>
						<imagedata width="60%" fileref="FIGURE_OUT/API-new.pdf"/>
					</imageobject>
					<imageobject>
						<imagedata width="60%" fileref="FIGURE_OUT/API-new.png"/>
					</imageobject>
				</mediaobject>
			</figure>
			<para> Compilare il form (<xref linkend="API-new-fig"/>) inserendo i seguenti dati: <itemizedlist>
					<listitem>
						<para>
							<emphasis>Tipo</emphasis>: Selezionare il tipo delle API a scelta tra
							"Soap" e "Rest". </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Nome</emphasis>: Assegnare un nome che identifichi le API.
						</para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Descrizione</emphasis>: un testo opzionale di descrizione.
						</para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Versione</emphasis>: progressivo numerico che identifica
							l'indice di revisione. </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Specifica delle Interfacce</emphasis>: In questa sezione è
							possibile caricare il descrittore formale dell'interfaccia, analizzando
							il quale, il gateway produce la corrispondente configurazione. Nel caso
							di interfacce Soap si potrà caricare il relativo WSDL. Nel caso di
							interfacce Rest si potrà scegliere tra i formati: WADL, Swagger 2.0 e
							OpenAPI 3.0. </para>
						<para> Nel caso non si disponga del descrittore dell'interfaccia è sempre
							possibile inserire manualmente la relativa configurazione seguendo le
							modalità descritte alla <xref linkend="api-interfacce"/>. </para>
					</listitem>
				</itemizedlist>
			</para>
		</sect2>

		<sect2 id="gw-erogazione">
			<title>Registrazione dell'erogazione</title>
			<para> Una volta disponibile la definizione delle API, si passa alla registrazione
				dell'erogazione fornendo i dati di base per l'esposizione del servizio erogato
				tramite GovWay. In <xref linkend="ErogazioneScenario-fig"/> è illustrato
				graficamente il caso dell'erogazione. <figure id="ErogazioneScenario-fig">
					<title>Scenario di riferimento per l'erogazione</title>
					<mediaobject>
						<imageobject>
							<imagedata width="80%" fileref="FIGURE_OUT/ErogazioneScenario.pdf"/>
						</imageobject>
						<imageobject>
							<imagedata width="80%" fileref="FIGURE_OUT/ErogazioneScenario.png"/>
						</imageobject>
					</mediaobject>
				</figure>
			</para>
			<para> Per registrare l'erogazione del servizio ci si posiziona nella sezione
					<emphasis>Registro > Erogazioni</emphasis> e si preme il pulsante
					<emphasis>Aggiungi</emphasis>.</para>
			<figure id="Erogazione-new-fig">
				<title>Registrazione di una Erogazione</title>
				<mediaobject>
					<imageobject>
						<imagedata width="60%" fileref="FIGURE_OUT/Erogazione-new.pdf"/>
					</imageobject>
					<imageobject>
						<imagedata width="60%" fileref="FIGURE_OUT/Erogazione-new.png"/>
					</imageobject>
				</mediaobject>
			</figure>
			<para>Compilare il form (<xref linkend="Erogazione-new-fig"/>) inserendo i seguenti
				dati: <itemizedlist>
					<listitem>
						<para><emphasis>API - Nome:</emphasis> Selezionare dall'elenco il nome e la
							versione relativa alla API cui l'erogazione fa riferimento. Se la API
							selezionata è di tipo Soap, sarà necessario selezionare anche il
							Servizio che si vuole erogare.</para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Autenticazione:</emphasis> In questa sezione è possibile
							configurare il meccanismo di autenticazione richiesto per l'accesso al
							servizio da parte dei fruitori. Il valore di default proposto prevede
							l'autenticazione di tipo <emphasis>https</emphasis>. </para>
						<para> Come mostrato in <xref linkend="Erogazione-new-fig"/>, è possibile
							selezionare il tipo di autenticazione a livello del trasporto,
							selezionando uno tra i valori disponibili: <itemizedlist>
								<listitem>
									<para><emphasis>disabilitato</emphasis>: nessuna
										autenticazione</para>
								</listitem>
								<listitem>
									<para><emphasis>ssl</emphasis>: autenticazione ssl</para>
								</listitem>
								<listitem>
									<para><emphasis>basic</emphasis>: autenticazione
										http-basic</para>
								</listitem>
								<listitem>
									<para><emphasis>principal</emphasis>: autenticazione
										sull'application server con identificazione tramite
										principal</para>
								</listitem>
								<listitem>
									<para><emphasis>custom</emphasis>: metodo di autenticazione
										fornito tramite estensione di GovWay</para>
								</listitem>
							</itemizedlist>
						</para>
						<para> Il flag <emphasis>Opzionale</emphasis> consente di non rendere
							bloccante il superamento dell'autenticazione per l'accesso al servizio.
						</para>
					</listitem>
					<listitem>
						<para><emphasis>Connettore:</emphasis> In questa sezione devono essere
							specificati i riferimenti al servizio, al fine di rendere possibile il
							corretto instradamento delle richieste inviate dai soggetti fruitori.
							Questo connettore riferisce il servizio del dominio interno che si sta
							erogando.</para>
						<para>Le informazioni da fornire sono: <itemizedlist>
								<listitem>
									<para><emphasis>Endpoint:</emphasis> la url per la consegna
										delle richieste al servizio.</para>
								</listitem>
								<listitem>
									<para><emphasis>Autenticazione Http:</emphasis> credenziali da
										fornire nel caso in cui il servizio richieda autenticazione
										di tipo HTTP-BASIC.</para>
								</listitem>
								<listitem>
									<para><emphasis>Autenticazione Https:</emphasis> credenziali da
										fornire nel caso in cui il servizio richieda autenticazione
										di tipo HTTPS.</para>
								</listitem>
								<listitem>
									<para><emphasis>Proxy:</emphasis> nel caso in cui l'endpoint del
										servizio sia raggiungibile solo attraverso un proxy, possono
										essere indicati qui i relativi riferimenti.</para>
								</listitem>
								<listitem>
									<para><emphasis>Ridefinisci Tempi Risposta:</emphasis> permette
										di ridefinire i tempi di risposta che sono stati configurati
										a livello generale, nell'ambito del controllo del traffico
										(vedi <xref linkend="config-controllotraffico-tempirisposta"
										/>)</para>
								</listitem>
							</itemizedlist>
						</para>
					</listitem>
				</itemizedlist>
			</para>
			<sect3 id="gw-erogazione-url">
				<title>Completamento configurazione e indirizzamento del servizio</title>
				<para> Dopo aver definito le API e registrato la relativa erogazione, come descritto
					nelle sezioni precedenti, si dispone della configurazione di un servizio erogato
					i cui riferimenti possono essere comunicati ai fruitori. </para>
				<para> Per aggiungere ulteriori dettagli di configurazione, o semplicemente per
					conoscere il giusto endpoint cui il fruitore deve indirizzare le richieste, si
					procede dalla pagina di dettaglio dell'erogazione già creata. Il dettaglio
					dell'erogazione si raggiunge andando alla sezione del menu <emphasis>Registro >
						Erogazioni</emphasis>, cliccando sull'elemento visualizzato nell'elenco
					delle erogazioni presenti nel registro (<xref linkend="listaErogazioni"/>).
						<figure id="listaErogazioni">
						<title>Elenco Erogazioni presenti nel registro</title>
						<mediaobject>
							<imageobject>
								<imagedata width="60%" fileref="FIGURE_OUT/ListaErogazioni.pdf"/>
							</imageobject>
							<imageobject>
								<imagedata width="60%" fileref="FIGURE_OUT/ListaErogazioni.png"/>
							</imageobject>
						</mediaobject>
					</figure>
				</para>
				<note>
					<para> Le erogazioni in elenco sono visualizzate con un'icona colorata
						affiancata al nome. L'icona di colore rosso indica che l'erogazione è
						disabilitata. L'icona di colore giallo indica che solo alcuni gruppi di
						risorse/azioni sono abilitati all'uso. L'icona verde indica lo stato
						abilitato. </para>
				</note>
				<para> Per la ricerca dell'elemento nell'elenco delle erogazioni è possibile
					filtrare i dati visualizzati tramite la maschera di filtro che compare cliccando
					sulla voce <emphasis>Erogazioni</emphasis> nell'intestazione dell'elenco (<xref
						linkend="filtroErogazioni"/>). <figure id="filtroErogazioni">
						<title>Filtro delle Erogazioni presenti nel registro</title>
						<mediaobject>
							<imageobject>
								<imagedata width="50%" fileref="FIGURE_OUT/FiltroErogazioni.pdf"/>
							</imageobject>
							<imageobject>
								<imagedata width="50%" fileref="FIGURE_OUT/FiltroErogazioni.png"/>
							</imageobject>
						</mediaobject>
					</figure>
				</para>
				<para> Il dettaglio dell'erogazione mostra i dati principali e con le icone "matita"
					è possibile entrare sulle maschere di editing per effettuare delle modifiche. In
					corrispondenza della API riferita, è possibile accedere al relativo dettaglio
					aprendo un nuovo tab del browser (<xref linkend="dettaglioErogazione"/>).
						<figure id="dettaglioErogazione">
						<title>Dettaglio dell'erogazione</title>
						<mediaobject>
							<imageobject>
								<imagedata width="60%" fileref="FIGURE_OUT/DettaglioErogazione.pdf"
								/>
							</imageobject>
							<imageobject>
								<imagedata width="60%" fileref="FIGURE_OUT/DettaglioErogazione.png"
								/>
							</imageobject>
						</mediaobject>
					</figure>
				</para>
				<para> La pagina di dettaglio dell'erogazione comprende inoltre i seguenti elementi: <itemizedlist>
						<listitem>
							<para>
								<emphasis>Gestione Configurazione</emphasis>: link per accedere alla
								configurazione specifica per l'aggiunta di ulteriori funzionalità
								all'erogazione (vedi <xref linkend="config-specifica"/>). </para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Gestione Gruppi Risorse/Azioni</emphasis>: link per
								differenziare la configurazione specifica sulla base di diversi
								gruppi di azioni/risorse, come meglio spiegato alla <xref
									linkend="gw-erogazione-config"/>. </para>
						</listitem>
					</itemizedlist>
				</para>
				<para> Dal dettaglio dell'erogazione si ricava il valore <emphasis>URL
						Invocazione</emphasis> che rappresenta l'endpoint da comunicare ai fruitori
					per contattare il servizio. Questo dato rappresenta la <emphasis>URL</emphasis>
					del servizio nel caso Soap o la <emphasis>Base URL</emphasis> nel caso Rest. </para>
				<para> Per la selezione dell'operazione da invocare si distinguono i seguenti casi: <itemizedlist>
						<listitem>
							<para>
								<emphasis>REST</emphasis>: Indipendentemente che l'API sia stata
								configurata fornendo il relativo descrittore, WADL o OpenAPI,
								l'identificazione dell'operation sarà sempre effettuata in
								automatico dal contesto di invocazione. Non è quindi necessario
								fornire ulteriori indicazioni. </para>
						</listitem>
						<listitem>
							<para>
								<emphasis>SOAP</emphasis>
								<itemizedlist>
									<listitem>
										<para>
											<emphasis>API con WSDL</emphasis>: l'operation viene
											automaticamente identificata dal contesto di invocazione
											grazie alle informazioni presenti nel descrittore.
										</para>
									</listitem>
									<listitem>
										<para>
											<emphasis>API senza WSDL</emphasis>: l'operation viene
											identificata inserendo il relativo identificativo nella
											URL di invocazione: <itemizedlist>
												<listitem>
												<para>&lt;URL_Invocazione&gt;/&lt;Azione&gt;</para>
												</listitem>
											</itemizedlist>
										</para>
										<para> Sono disponibili ulteriori metodi per
											l'identificazione dell'operation nel caso SOAP, per i
											cui dettagli si rimanda alla <xref
												linkend="identificazione-azione"/>. </para>
									</listitem>
								</itemizedlist>
							</para>
						</listitem>
					</itemizedlist>
				</para>
			</sect3>
			<sect3 id="erogazioneIntegrazione">
				<title>Condivisione dei dati di integrazione</title>
				<para> Le richieste di erogazione, pervenute a GovWay, vengono elaborate e, nel
					corso dell'operazione, vengono creati i riferimenti alle entità di
					configurazione presenti nel registro. </para>
				<para> GovWay comunica i dati di contesto ricavati, ai sistemi interlocutori, ed in
					particolare: <itemizedlist>
						<listitem>
							<para> Tutti i dati dell'header di integrazione, relativi al messaggio
								di richiesta, vengono inviati all'applicativo destinatario
								(erogatore). I dati che compongono l'header di integrazione sono
								quelli descritti nelle tabelle presenti alla <xref
									linkend="header-integrazione"/>. </para>
						</listitem>
						<listitem>
							<para> Un sottoinsieme dell'header di integrazione, relativo al
								messaggio di risposta, viene inviato al soggetto mittente
								(fruitore). I dati inviati (sempre in riferimento alle tabelle della
									<xref linkend="header-integrazione"/>) sono: <itemizedlist>
									<listitem>
										<para>
											<emphasis>GovWay-Message-ID</emphasis>
										</para>
									</listitem>
									<listitem>
										<para>
											<emphasis>GovWay-Relates-To</emphasis>
										</para>
									</listitem>
									<listitem>
										<para>
											<emphasis>GovWay-Conversation-ID</emphasis>
										</para>
									</listitem>
									<listitem>
										<para>
											<emphasis>GovWay-Transaction-ID</emphasis>
										</para>
									</listitem>
								</itemizedlist>
							</para>
						</listitem>
					</itemizedlist>
				</para>
			</sect3>
			<sect3 id="erogazioneErrori">
				<title>Errori Generati dal Gateway</title>
				<para> La gestione dei casi di errore nelle comunicazioni mediate da un Gateway
					devono tenere conto di ulteriori situazioni che possono presentarsi rispetto
					alla situazione di dialogo diretto tra gli applicativi. Oltre agli errori
					conosciuti dagli applicativi, e quindi previsti nei descrittori del servizio,
					gli applicativi client possono ricevere ulteriori errori generati dal gateway. </para>
				<para>Govway genera differenti errori a seconda se l'erogazione o la fruizione
					riguarda una API di tipologia SOAP o REST. <itemizedlist>
						<listitem>
							<para>
								<emphasis>REST</emphasis>: viene generato un oggetto
									<emphasis>Problem Details</emphasis> come definito nella
								specifica <emphasis>RFC 7807</emphasis> (<ulink
									url="https://tools.ietf.org/html/rfc7807"
									>https://tools.ietf.org/html/rfc7807</ulink>). Ulteriori
								dettagli vengono descritti nella sezione <xref
									linkend="gateway-problem-rest"/>. </para>
						</listitem>
						<listitem>
							<para>
								<emphasis>SOAP</emphasis>: viene generato un SOAPFault contenente un
								actor (o role in SOAP 1.2) valorizzato con
									<emphasis>http://govway.org/integration</emphasis>.
								Nell'elemento <emphasis>fault string</emphasis> è presente il
								dettaglio dell'errore mentre nell'elemento <emphasis>fault code
								</emphasis> una codifica di tale errore. Ulteriori dettagli vengono
								descritti nella sezione <xref linkend="gateway-problem-soap"/>.
							</para>
						</listitem>
					</itemizedlist>
				</para>
			</sect3>
		</sect2>


		<!-- FRUIZIONE API GATEWAY -->

		<sect2 id="gw-fruizione">
			<title>Registrazione della fruizione</title>
			<para> Nel processo di fruizione sono coinvolti i client (o applicativi) interni al
				dominio che richiedono, tramite accesso sul gateway, un servizio erogato da un
				soggetto di un dominio esterno.</para>
			<para>In <xref linkend="FruizioneScenario-fig"/> è illustrato graficamente il caso della
				fruizione. </para>
			<figure id="FruizioneScenario-fig">
				<title>Scenario di riferimento per la fruizione</title>
				<mediaobject>
					<imageobject>
						<imagedata width="80%" fileref="FIGURE_OUT/FruizioneScenario.pdf"/>
					</imageobject>
					<imageobject>
						<imagedata width="80%" fileref="FIGURE_OUT/FruizioneScenario.png"/>
					</imageobject>
				</mediaobject>
			</figure>
			<para> Analogamente a quanto descritto per le erogazioni, è possibile procedere con la
				configurazione delle fruizioni accedendo alla sezione di menu <emphasis>Registro >
					Fruizioni</emphasis>. </para>
			<para> La configurazione delle fruizioni presenta maschere della GovWayConsole del tutto
				analoghe al caso dell'erogazione. È quindi possibile seguire il processo di
				configurazione attuando i medesimi passi, illustrati per le erogazioni, calandole
				sul contesto delle fruizioni. </para>
			<para> L'unica differenza, rispetto al processo di configurazione delle erogazioni, è
				rappresentata dalla presenza del campo <emphasis>Soggetto Erogatore</emphasis>, da
				selezionare come soggetto che eroga il servizio (<xref
					linkend="gw-fruizione-new-fig"/>). <figure id="gw-fruizione-new-fig">
					<title>Registrazione di una Fruizione</title>
					<mediaobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/Fruizione-new.pdf"/>
						</imageobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/Fruizione-new.png"/>
						</imageobject>
					</mediaobject>
				</figure>
			</para>
			<note>
				<para> Benché non vi siano differenze nelle modalità di configurazione del
						<emphasis>Connettore</emphasis>, nel caso della fruizione questi consiste
					nei dati di puntamento al servizio erogato sul dominio esterno. </para>
			</note>
			<sect3 id="fruizioneIntegrazione">
				<title>Condivisione dei dati di integrazione</title>
				<para> Le richieste di fruizione, pervenute a GovWay, vengono elaborate e, nel corso
					dell'operazione, vengono creati i riferimenti alle entità di configurazione
					presenti nel registro. </para>
				<para> GovWay comunica i dati di contesto ricavati, ai sistemi interlocutori: <itemizedlist>
						<listitem>
							<para>
								<emphasis>GovWay-Message-ID</emphasis>
							</para>
						</listitem>
						<listitem>
							<para>
								<emphasis>GovWay-Relates-To</emphasis>
							</para>
						</listitem>
						<listitem>
							<para>
								<emphasis>GovWay-Conversation-ID</emphasis>
							</para>
						</listitem>
						<listitem>
							<para>
								<emphasis>GovWay-Transaction-ID</emphasis>
							</para>
						</listitem>
					</itemizedlist> Per ulteriori dettagli si consiglia di consultare la sezione
						<xref linkend="header-integrazione"/>. </para>
			</sect3>
			<sect3 id="fruizioniErrori">
				<title>Errori Generati dal Gateway</title>
				<para> Analogamente a quanto descritto per le erogazioni, la gestione dei casi di
					errore nelle comunicazioni mediate da un Gateway devono tenere conto di
					ulteriori situazioni che possono presentarsi rispetto alla situazione di dialogo
					diretto tra gli applicativi. Oltre agli errori conosciuti dagli applicativi, e
					quindi previsti nei descrittori del servizio, gli applicativi client possono
					ricevere ulteriori errori generati dal gateway. </para>
				<para>Govway genera differenti errori a seconda se l'erogazione o la fruizione
					riguarda una API di tipologia SOAP o REST. <itemizedlist>
						<listitem>
							<para>
								<emphasis>REST</emphasis>: viene generato un oggetto
									<emphasis>Problem Details</emphasis> come definito nella
								specifica <emphasis>RFC 7807</emphasis> (<ulink
									url="https://tools.ietf.org/html/rfc7807"
									>https://tools.ietf.org/html/rfc7807</ulink>). Ulteriori
								dettagli vengono descritti nella sezione <xref
									linkend="gateway-problem-rest"/>. </para>
						</listitem>
						<listitem>
							<para>
								<emphasis>SOAP</emphasis>: viene generato un SOAPFault contenente un
								actor (o role in SOAP 1.2) valorizzato con
									<emphasis>http://govway.org/integration</emphasis>.
								Nell'elemento <emphasis>fault string</emphasis> è presente il
								dettaglio dell'errore mentre nell'elemento <emphasis>fault code
								</emphasis> una codifica di tale errore. Ulteriori dettagli vengono
								descritti nella sezione <xref linkend="gateway-problem-soap"/>.
							</para>
						</listitem>
					</itemizedlist>
				</para>
			</sect3>
		</sect2>

		<sect2 id="config-specifica">
			<title>Configurazione Specifica</title>
			<para> I passi di configurazione fin qui descritti, per la registrazione di erogazioni e
				fruizioni, consentono di ottenere uno stato delle entità del registro pronto
				all'utilizzo in numerose situazioni. </para>
			<para> Nei casi in cui si abbia l'esigenza di aggiungere ulteriori elementi di
				configurazione, sfruttando le ulteriori funzionalità messe a disposizione da GovWay,
				si procede con le ulteriori configurazioni, disponibili a partire dall'erogazione o
				fruizione già creata in precedenza accedendo tramite il link <emphasis>Gestione
					Configurazione</emphasis> presente nel dettaglio dell'erogazione/fruizione. Le
				sezioni successive descrivono le configurazioni specifiche attuabili nei vari
				contesti. Tranne dove esplicitamente dichiarato, gli schemi di configurazione
				descritti in seguito possono essere attuati sia sulle erogazioni che sulle
				fruizioni. </para>
			<!-- 	   
		<sect3 id="gw-erogazione-allegati">
	    	<title>Documenti Allegati</title>
	    	<para>Ad una erogazione/fruizione registrata si possono allegare dei file di vario genere: documenti informali, semi-informali o 
	    	descrittori formali.</para>
	    	<para>Per fornire gli allegati è sufficiente seguire il collegamento presente nella colonna <emphasis>Allegati</emphasis> in corrispondenza della
	    	voce di erogazione/fruizione presente in elenco. Successivamente si preme il pulsante <emphasis>Aggiungi</emphasis>. Nel form che si apre si deve
	    	selezionare il <emphasis>Ruolo</emphasis> del file allegato, a scelta tra i seguenti:
	    	<itemizedlist>
	    		<listitem>
	    			<para><emphasis>allegato</emphasis>: nel caso di un generico allegato non riconducibile alla casistica descritta in seguito.</para>
	    		</listitem>
	    		<listitem>
	    			<para><emphasis>SpecificaSemiformale</emphasis>: nel caso di un documento di specifica semiformale che rientri nella seguente casistica: UML, HTML, XML, 
	    			JSON, Linguaggio Naturale.</para>
	    		</listitem>
	    		<listitem>
	    			<para><emphasis>SpecificaSicurezza</emphasis>: nel caso di un documento sulla sicurezza che rientri nella seguente casistica: WS-Policy, XACML-Policy,
	    			Linguaggio Naturale.</para>
	    		</listitem>
	    		<listitem>
	    			<para><emphasis>SpecificaLivelloServizio</emphasis>: nel caso di un documento sui livelli di servizio nella seguente casistica: WS-Agreement, WSLA.</para>
	    		</listitem>
	    	</itemizedlist>
	    	</para>
	    	<para>In ogni caso dovrà essere caricato l'allegato utilizzando il pulsante presente nel campo <emphasis>Documento</emphasis>.</para>
	    </sect3>
-->
			<sect3 id="gw-erogazione-connettore">
				<title>Connettore</title>
				<para> È possibile modificare le impostazioni del connettore (ad esempio per
					modificare l'endpoint o aggiungere il proxy) seguendo il collegamento presente
					nella riga <emphasis>Connettore</emphasis> del dettaglio di una erogazione o
					fruizione. I campi del form sono uguali a quelli già descritti per la fase di
					creazione dell'erogazione (<xref linkend="gw-erogazione"/>). </para>
			</sect3>
			<sect3 id="gw-erogazione-cors">
				<title>Gestione CORS</title>
				<para> Quando un'applicazione client in esecuzione su un browser (es. codice
					javascript) richiede l'accesso ad una risorsa di un differente dominio,
					protocollo o porta tale richiesta viene gestita dal browser tramite una politica
					di <emphasis>cross-origin HTTP request (CORS)</emphasis>. Il CORS definisce un
					modo nel quale un browser ed un server (o il gateway) possono interagire per
					abilitare interazioni attraverso differenti domini. </para>
				<para>In GovWay è possibile abilitare la gestione del CORS sia globalmente, in modo
					che sia valida per tutte le APIs, che singolarmente sulla singola erogazione o
					fruizione. </para>
				<para> È possibile modificare le impostazioni CORS seguendo il collegamento presente
					nella riga <emphasis>Gestione CORS</emphasis> del dettaglio di una erogazione o
					fruizione. L'impostazione permette di ridefinire la configurazione globale; i
					campi del form sono i medesimi descritti nella configurazione globale (<xref
						linkend="configurazione-cors"/>). </para>
			</sect3>
			<sect3 id="gw-erogazione-config">
				<title>Differenziare le configurazioni specifiche per risorsa/azione</title>
				<para>Le configurazioni specifiche che andiamo a descrivere si possono differenziare
					per sottoinsiemi delle azioni/risorse presenti nel servizio erogato/fruito. Il
					sistema crea automaticamente una configurazione unica, valida per tutte le
					azioni/risorse del servizio. Per intervenire su tale configurazione, o crearne
					di nuove, sia accede al collegamento presente nella colonna
						<emphasis>Configurazione</emphasis>, in corrispondenza della voce di
					erogazione/fruizione in elenco. Le funzionalità di configurazione disponibili
					per ciascun sottoinsieme di azioni/risorse sono raggruppabili in: <itemizedlist>
						<listitem>
							<para><emphasis>Controllo Accessi</emphasis>: per configurare i criteri
								di autenticazione, autorizzazione e gestione token delle richieste.
							</para>
						</listitem>
						<listitem>
							<para><emphasis>Validazione</emphasis>: per configurare i criteri di
								validazione dei messaggi in transito sul gateway.</para>
						</listitem>
						<listitem>
							<para><emphasis>Sicurezza Messaggio</emphasis>: per configurare le
								misure di sicurezza applicate a livello del messaggio.</para>
						</listitem>
						<listitem>
							<para><emphasis>Tracciamento</emphasis>: per configurare specifiche
								modalità di estrazione dati, dalle comunicazioni in transito, per
								l'arricchimento della traccia prodotta.</para>
						</listitem>
						<listitem>
							<para><emphasis>MTOM</emphasis>: per configurare l'utilizzo del
								protocollo ottimizzato per l'invio di attachment tra nodi
								SOAP.</para>
						</listitem>
						<listitem>
							<para><emphasis>Registrazione Messaggi</emphasis>: consente di
								ridefinire le politiche di archiviazione dei payload rispetto a
								quanto previsto dalla configurazione di default (vedi <xref
									linkend="config-tracciamento"/>).</para>
						</listitem>
					</itemizedlist>
				</para>
				<para>Per creare un nuovo gruppo di configurazione, dopo aver seguito il
					collegamento <emphasis>visualizza</emphasis> relativo all'erogazione/fruizione
					selezionata, si preme il pulsante <emphasis>Aggiungi</emphasis></para>
				<figure id="Config-new-fig">
					<title>Aggiunta di un gruppo di configurazioni</title>
					<mediaobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/Config-new.pdf"/>
						</imageobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/Config-new.png"/>
						</imageobject>
					</mediaobject>
				</figure>
				<para>Compilare il form di creazione della nuova configurazione (<xref
						linkend="Config-new-fig"/>): <itemizedlist>
						<listitem>
							<para><emphasis>Azioni:</emphasis> selezionare dall'elenco le azioni
								sulle quali si vuole abbia effetto la nuova configurazione.</para>
						</listitem>
						<listitem>
							<para><emphasis>Mode:</emphasis> effettuare la scelta tra
									<emphasis>Eredita Da</emphasis> e <emphasis>Nuova</emphasis>.
								Scegliendo la prima opzione, verrà creata una configurazione clone
								di quella selezionata nell'elemento del form subito successivo
								(Configurazione). Scegliendo la seconda opzione, si procederà alla
								creazione di una nuova configurazione, specificando subito le
								informazioni di Controllo degli Accessi e Connettore.</para>
						</listitem>
					</itemizedlist>
				</para>
				<note>
					<para>Dopo aver creato ulteriori configurazioni, si tenga presente che la
						configurazione di default verrà applicata alle sole azioni per le quali non
						è presente una regola di configurazione specifica.</para>
				</note>
				<note>
					<para>È possibile disabilitare un'intera configurazione, senza la necessità di
						eliminarla, utilizzando il collegamento presente nella colonna "Abilitato"
						in corrispondenza dell'elemento di configurazione. Un successivo clic farà
						tornare la configurazione nello stato abilitato.</para>
				</note>
			</sect3>
			<sect3 id="gw-erogazione-auth">
				<title>Controllo degli Accessi</title>
				<para>Tramite questa funzionalità è possibile configurare i criteri di gestione
					token, autenticazione e autorizzazione delle richieste in ingresso sul gateway.
					Per aggiungere questa funzionalità si procede selezionando prima il
					collegamento, presente nella colonna "Configurazione", relativo
					all'erogazione/fruizione presente nell'elenco. Successivamente si utilizza il
					collegamento, presente nella colonna "Controllo Accessi", relativamente alla
					configurazione che si vuole modificare (<xref linkend="ControlloAccessi-fig"/>). </para>
				<figure id="ControlloAccessi-fig">
					<title>Controllo degli Accessi</title>
					<mediaobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/ControlloAccessi.pdf"/>
						</imageobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/ControlloAccessi.png"/>
						</imageobject>
					</mediaobject>
				</figure>
				<para> Le tre sezioni seguenti descrivono le modalità per configurare i tre aspetti
					che compongono il controllo degli accessi. </para>
				<sect4 id="gestione-token">
					<title>Gestione Token</title>
					<para> Questa sezione consente di configurare il controllo degli accessi basato
						su Bearer Token OAuth2. Facendo transitare lo stato su "abilitato" compare
						l'elemento <emphasis>Policy</emphasis> (obbligatorio) per la selezione della
						policy di gestione token che si vuole applicare. In questa lista a discesa
						saranno visualizzate tutte le <emphasis>Token Policy</emphasis> che sono
						state registrate in precedenza. Per le istruzioni sulla registrazione delle
						Token Policy si faccia riferimento alla <xref linkend="TokenPolicy"/>. </para>
					<para> Una volta selezionata la policy compariranno sotto gli elementi per
						stabilire le specifiche azioni da abilitare rispetto al totale di quelle
						previste nella policy stessa (<xref linkend="GestioneToken-fig"/>). <figure
							id="GestioneToken-fig">
							<title>Configurazione della gestione token</title>
							<mediaobject>
								<imageobject>
									<imagedata width="60%" fileref="FIGURE_OUT/GestioneToken.pdf"/>
								</imageobject>
								<imageobject>
									<imagedata width="60%" fileref="FIGURE_OUT/GestioneToken.png"/>
								</imageobject>
							</mediaobject>
						</figure> Supponendo che la policy copra tutti gli aspetti disponibili, le
						opzioni configurabili sono le seguenti: <itemizedlist>
							<listitem>
								<para>
									<emphasis>Token Opzionale</emphasis>: consente di non forzare i
									richiedenti al passaggio del token, che rimane quindi
									un'operazione opzionale. </para>
							</listitem>
							<listitem>
								<para>
									<emphasis>Introspection</emphasis>: consente di
									abilitare/disabilitare l'operazione di Token Introspection, al
									fine di validare il token ricevuto ed ottenere le
									metainformazioni associate (ad esempio scope e riferimento al
									possessore del token). Selezionando l'opzione
										<emphasis>WarningOnly</emphasis> è possibile non rendere
									bloccante l'evento di fallimento della validazione, ottenendo
									come unico effetto l'emissione di un messaggio diagnostico di
									segnalazione. </para>
							</listitem>
							<listitem>
								<para>
									<emphasis>User Info</emphasis>: consente di
									abilitare/disabilitare l'operazione UserInfo al fine di ottenere
									le informazioni di dettaglio dell'utente possessore del token.
									Selezionando l'opzione <emphasis>WarningOnly</emphasis> è
									possibile non rendere bloccante l'evento di fallimento della
									validazione, ottenendo come unico effetto l'emissione di un
									messaggio diagnostico di segnalazione. </para>
							</listitem>
							<listitem>
								<para>
									<emphasis>Token Forward</emphasis>: consente di
									abilitare/disabilitare l'operazione di inoltro, al servizio
									destinatario, del token ricevuto dal mittente. </para>
							</listitem>
						</itemizedlist> Le azioni che sono state abilitate saranno effettuate in
						accordo a quanto configurato nella relativa Token Policy selezionata. <note>
							<para> È disponibile la Token Policy <emphasis>Google</emphasis>
								preconfigurata in modo da utilizzare i servizi di elaborazione token
								esposti pubblicamente da Google e quindi: <itemizedlist>
									<listitem>
										<para>La Validazione JWT basata su <emphasis>Google - ID
												Token</emphasis></para>
									</listitem>
									<listitem>
										<para>Il servizio di token introspection basato su
												<emphasis>Google - TokenInfo</emphasis></para>
									</listitem>
									<listitem>
										<para>Il servizio di User Info basato su <emphasis>Google -
												UserInfo</emphasis></para>
									</listitem>
								</itemizedlist>
							</para>
						</note>
					</para>
				</sect4>
				<sect4 id="autenticazione">
					<title>Autenticazione</title>
					<para> In questa sezione è possibile configurare il meccanismo di autenticazione
						richiesto per l'accesso al servizio. Come mostrato in <xref
							linkend="Autenticazione-fig"/>, si possono specificare: <itemizedlist>
							<listitem>
								<para> Il tipo di autenticazione, per il quale si procede come già
									descritto per l'attività di creazione dell'erogazione nella
										<xref linkend="gw-erogazione"/>. </para>
							</listitem>
							<listitem>
								<para> Se è stata attivata, al passo precedente, la gestione del
									token sarà possibile aggiungere ulteriori criteri di
									autenticazione basati sul contenuto del token ricevuto. In tal
									caso è possibile autenticare la richiesta sulla base delle
									seguenti metainformazioni presenti nel token: Issuer, ClientId,
									Subject, Username, Email. </para>
							</listitem>
						</itemizedlist>i criteri di autenticazione possono essere attuati sia a
						livello del trasporto che del token (se abilitata la gestione del token al
						passo precedente). <figure id="Autenticazione-fig">
							<title>Configurazione dell'autenticazione del servizio</title>
							<mediaobject>
								<imageobject>
									<imagedata width="60%" fileref="FIGURE_OUT/Autenticazione.pdf"/>
								</imageobject>
								<imageobject>
									<imagedata width="60%" fileref="FIGURE_OUT/Autenticazione.png"/>
								</imageobject>
							</mediaobject>
						</figure>
					</para>
				</sect4>
				<sect4 id="Autorizzazione">
					<title>Autorizzazione</title>
					<para> L'autorizzazione è un ulteriore meccanismo per il controllo degli accessi
						tramite il quale è possibile specificare con maggior dettaglio le richieste
						che sono in grado di essere accettate per l'accesso al servizio. </para>
					<para>I meccanismi supportati, per specificare i criteri di autorizzazione, sono
						i seguenti: <itemizedlist>
							<listitem>
								<para>
									<emphasis>Autorizzazione Puntuale</emphasis>: superato il
									processo di autenticazione, saranno accettate le sole richieste
									provenienti dai mittenti indicati singolarmente nella lista
									fornita con il criterio. Dopo aver abilitato questa opzione, ed
									aver confermato tramite il pulsante Invia, sarà possibile
									fornire la lista dei mittenti autorizzati ad accedere al
									servizio. </para>
								<para> I mittenti che possono essere indicati sono Soggetti (solo
									nel caso delle erogazioni) e Applicativi. Tali entità dovranno
									essere precedentemente registrate sulla govwayConsole seguendo
									le indicazioni fornite in <xref linkend="gw-erogazione-soggetti"
									/> e in <xref linkend="gw-fruizione-client"/>. </para>
								<note>
									<para> L'opzione di autorizzazione sui soggetti è disponibile
										solo se è stata attivata l'autenticazione. </para>
								</note>
								<note>
									<para> L'opzione di autorizzazione sugli applicativi, nel caso
										di una erogazione, viene utilizzata per gestire l'accesso al
										servizio da parte di applicativi interni al dominio di
										GovWay. </para>
								</note>
							</listitem>
							<listitem>
								<para>
									<emphasis>Autorizzazione per Ruoli</emphasis>: consente di
									concedere l'autorizzazione per il servizio solo ai richiedenti
									in possesso di determinati ruoli nel proprio profilo. Dopo aver
									barrato questa opzione, ed aver confermato tramite il pulsante
									Invia, sarà possibile fornire una lista dei ruoli che devono
									essere posseduti dal chiamante per poter accedere al servizio.
									In particolare si dovrà anche specificare la
										<emphasis>fonte</emphasis> di provenienza dei ruoli, che può
									essere <emphasis>esterna</emphasis>, cioè proveniente dal
									sistema che ha autenticato il chiamante, oppure
										<emphasis>registro</emphasis>, cioè i ruoli che sono stati
									censiti nel registro di GovWay e assegnati al soggetto
									chiamante. Inoltre si deve scegliere l'opzione <emphasis>Ruoli
										Richiesti</emphasis> per indicare se, in presenza di più di
									un ruolo come criterio, il chiamante deve possedere "tutti" i
									ruoli indicati o "almeno uno". </para>
								<para> Per le indicazioni sul censimento dei ruoli fare riferimento
									alla <xref linkend="gw-erogazione-ruoli"/>. </para>
							</listitem>
							<listitem>
								<para>
									<emphasis>Autorizzazione per Scope</emphasis>: criterio di
									autorizzazione che verifica la corrispondenza tra gli scope
									indicati e quelli estratti dal token presente nella richiesta
									ricevuta. Una volta attivata l'opzione si deve effettuare una
									scelta per l'elemento <emphasis>Scope Richiesti</emphasis>, tra
									i valori "tutti" (tutti gli scope indicati devono essere
									presenti nel token per superare l'autorizzazione) e "almeno uno"
									(è richiesta la presenza di almeno uno scope tra quelli indicati
									nella policy di autorizzazione). Dopo aver confermato la scelta
									con il pulsante "Invia" verrà richiesto di inserire gli scope
									tra quelli già censiti ed abilitati per l'uso nei contesti di
									erogazione (o qualsiasi contesto). </para>
								<note>
									<para>L'opzione di autorizzazione basata sugli scope è
										disponibile solo se è stata preventivamente attivata la
										Gestione Token e selezionata la relativa policy. </para>
								</note>
							</listitem>
							<listitem>
								<para>
									<emphasis>Autorizzazione per Token Claims</emphasis>: Se è stata
									abilitata la gestione del token si ha la possibilità di
									autorizzare le richieste inserendo i valori ammessi per i claims
									contenuti nel token. La configurazione viene effettuata
									inserendo nel campo di testo ciascun claim in una riga, facendo
									seguire dopo l'uguale i valori ammessi separati da virgola. </para>
								<note>
									<para> L'opzione di autorizzazione basata sui token è
										disponibile solo se è stata preventivamente attivata la
										Gestione Token e selezionata la relativa policy. </para>
								</note>
							</listitem>
							<listitem>
								<para>
									<emphasis>XACML-Policy</emphasis>: È possibile basare il
									meccanismo di autorizzazione sulla valutazione di una policy
									xacml selezionando la relativa opzione sulla lista "Stato". </para>
								<para> Per le indicazioni di dettaglio sulla configurazione delle
									xacml-Policy si faccia riferimento alla <xref
										linkend="gw-erogazione-xacml"/>
								</para>
							</listitem>
							<listitem>
								<para>
									<emphasis>Custom</emphasis>: Sulla lista "Stato", è possibile
									selezionare questo metodo di autorizzazione eventualmente
									fornito tramite estensione di GovWay. </para>
							</listitem>
						</itemizedlist>
					</para>
				</sect4>
				<sect4 id="gw-erogazione-soggetti">
					<title>Creazione di un soggetto</title>
					<para>Affinché possano essere utilizzate le funzionalità di autenticazione ed
						autorizzazione, associate alle erogazioni, è necessario che vengano censiti
						i soggetti fruitori che inviano le richieste di servizio. La registrazione
						di un soggetto consente di assegnargli delle credenziali che lo identificano
						ed eventuali ruoli provenienti dalla fonte "Registro".</para>
					<figure id="gw-erogazione-soggetti-fig">
						<title>Creazione di un soggetto</title>
						<mediaobject>
							<imageobject>
								<imagedata width="60%" fileref="FIGURE_OUT/Soggetto-new.pdf"/>
							</imageobject>
							<imageobject>
								<imagedata width="60%" fileref="FIGURE_OUT/Soggetto-new.png"/>
							</imageobject>
						</mediaobject>
					</figure>
					<para>Per creare il soggetto posizionarsi nella sezione <emphasis>Registro >
							Soggetti</emphasis>, quindi premere il pulsante
							<emphasis>Aggiungi</emphasis>. Compilare il form come segue (<xref
							linkend="gw-erogazione-soggetti-fig"/>): <itemizedlist>
							<listitem>
								<para><emphasis>Nome</emphasis>: Il nome del soggetto. È necessario
									che il nome indicato risulti univoco rispetto ai nomi già
									presenti per la modalità operativa selezionata (in questo caso
									API Gateway).</para>
							</listitem>
							<listitem>
								<para><emphasis>Tipologia</emphasis>: Indicare se si tratta di un
									soggetto esclusivamente erogatore, esclusivamente fruitore o con
									entrambi i ruoli.</para>
							</listitem>
							<listitem>
								<para><emphasis>Descrizione</emphasis>: Un testo di descrizione per
									il soggetto.</para>
							</listitem>
							<listitem>
								<para><emphasis>Modalità di Accesso alla Porta</emphasis>: Sezione
									presente solo nel caso il soggetto ricopra il ruolo di fruitore.
									Tramite il campo <emphasis>Tipo</emphasis> si seleziona il tipo
									di credenziali richieste per l'autenticazione del soggetto. In
									base alla scelta effettuata saranno mostrati i campi per
									consentire l'inserimento delle credenziali richieste.</para>
							</listitem>
						</itemizedlist>
					</para>
					<para>Dopo aver creato il soggetto è opzionalmente possibile assegnargli dei
						ruoli, tra quelli che sono presenti nel registro e contrassegnati come
							<emphasis>fonte registro</emphasis>. Per associare ruoli ad un soggetto
						seguire il collegamento presente nella colonna <emphasis>Ruoli</emphasis>,
						in corrispondenza del soggetto scelto. Premere quindi il pulsante
							<emphasis>Aggiungi</emphasis>. Nel form che si apre (<xref
							linkend="gw-erogazione-soggetti-ruoli-fig"/>) è presente una lista dalla
						quale è possibile selezionare un ruolo alla volta, che viene aggiunto
						confermando con il tasto <emphasis>Invia</emphasis>. <figure
							id="gw-erogazione-soggetti-ruoli-fig">
							<title>Assegnazione di ruoli ad un soggetto</title>
							<mediaobject>
								<imageobject>
									<imagedata width="60%" fileref="FIGURE_OUT/SoggettoRuoli.pdf"/>
								</imageobject>
								<imageobject>
									<imagedata width="60%" fileref="FIGURE_OUT/SoggettoRuoli.png"/>
								</imageobject>
							</mediaobject>
						</figure>
					</para>
				</sect4>
				<sect4 id="gw-fruizione-client">
					<title>Creazione di un applicativo</title>
					<para>Affinché possano essere utilizzate le funzionalità di autenticazione ed
						autorizzazione, associate alle fruizioni, è necessario che vengano censiti
						gli applicativi, interni al dominio, che inviano le richieste di servizio.
						La registrazione di un applicativo consente di assegnargli delle credenziali
						che lo identificano ed eventuali ruoli provenienti dalla fonte
						"Registro".</para>
					<figure id="gw-fruizione-client-fig">
						<title>Creazione di un applicativo</title>
						<mediaobject>
							<imageobject>
								<imagedata width="60%" fileref="FIGURE_OUT/Applicativo-new.pdf"/>
							</imageobject>
							<imageobject>
								<imagedata width="60%" fileref="FIGURE_OUT/Applicativo-new.png"/>
							</imageobject>
						</mediaobject>
					</figure>
					<para>Per registrare l'applicativo posizionarsi nella sezione <emphasis>Registro
							> Applicativi</emphasis>, quindi premere il pulsante
							<emphasis>Aggiungi</emphasis>. Compilare il form come segue (<xref
							linkend="gw-fruizione-client-fig"/>): <itemizedlist>
							<listitem>
								<para><emphasis>Nome</emphasis>: Assegnare un nome all'applicativo.
									È necessario che il nome indicato risulti univoco rispetto ai
									nomi già presenti per la modalità operativa selezionata (in
									questo caso API Gateway).</para>
							</listitem>
							<listitem>
								<para><emphasis>Modalità di Accesso alla Porta</emphasis>: Tramite
									il campo <emphasis>Tipo</emphasis> si seleziona il tipo di
									credenziali richieste per l'autenticazione dell'applicativo. In
									base alla scelta effettuata saranno mostrati i campi per
									consentire l'inserimento delle credenziali richieste.</para>
							</listitem>
						</itemizedlist>
					</para>
					<para>Dopo aver creato l'applicativo è opzionalmente possibile assegnargli dei
						ruoli, tra quelli che sono presenti nel registro e contrassegnati come
							<emphasis>fonte registro</emphasis>. Per associare ruoli ad un
						applicativo seguire il collegamento presente nella colonna
							<emphasis>Ruoli</emphasis>, in corrispondenza dell'applicativo scelto.
						Premere quindi il pulsante <emphasis>Aggiungi</emphasis>. Nel form che si
						apre è presente una lista dalla quale è possibile selezionare un ruolo alla
						volta, che viene aggiunto confermando con il tasto
							<emphasis>Invia</emphasis>. </para>
				</sect4>
				<sect4 id="gw-erogazione-ruoli">
					<title>Creazione di un ruolo</title>
					<para>È possibile censire i ruoli che potranno essere utilizzati come criterio
						di autorizzazione. Quelli contrassegnati come <emphasis>fonte
							registro</emphasis> potranno essere associandoli ai soggetti. Quelli
						invece contrassegnati come <emphasis>fonte esterna</emphasis> verranno
						assegnati dinamicamente ai soggetti che si autenticano, sulla base di quanto
						comunicato dal container dopo che l'utente ha effettuato l'autenticazione
						esternamente. </para>
					<para>Per creare un nuovo ruolo ci si posiziona nella sezione <emphasis>Registro
							> Ruoli</emphasis> e si preme il pulsante
						<emphasis>Aggiungi</emphasis>.</para>
					<figure id="gw-erogazione-ruoli-fig">
						<title>Registrazione di un ruolo</title>
						<mediaobject>
							<imageobject>
								<imagedata width="60%" fileref="FIGURE_OUT/Ruoli-new.pdf"/>
							</imageobject>
							<imageobject>
								<imagedata width="60%" fileref="FIGURE_OUT/Ruoli-new.png"/>
							</imageobject>
						</mediaobject>
					</figure>
					<para>Compilare il form (<xref linkend="gw-erogazione-ruoli-fig"/>) nel seguente
						modo: <itemizedlist>
							<listitem>
								<para>
									<emphasis>Nome</emphasis>: identifica univocamente il ruolo.
								</para>
							</listitem>
							<listitem>
								<para>
									<emphasis>Descrizione</emphasis>: rappresenta una descrizione
									generica del ruolo. </para>
							</listitem>
							<listitem>
								<para>
									<emphasis>Fonte</emphasis>: la gestione del ruolo può essere
									effettuata direttamente su GovWay (fonte: registro) dove può
									essere assegnato ad un soggetto o applicativo. In alternativa
									(fonte: esterna) la gestione può essere delegata all'Application
									Server o a qualunque altra modalità che permetta al gateway di
									accedere ai ruoli tramite la api
										<emphasis>HttpServletRequest.isUserInRole()</emphasis>. In
									questo caso il nome del ruolo deve corrispondere allo stesso
									identificativo utilizzato nella configurazione esterna. </para>
								<para>Se non viene specificata alcuna fonte il ruolo potrà essere
									utilizzato per entrambe le modalità.</para>
							</listitem>
							<listitem>
								<para>
									<emphasis>Contesto</emphasis>: l'utilizzo del ruolo può essere
									limitato ad un contesto di erogazione o fruizione di servizio
									attraverso questa opzione.</para>
							</listitem>
							<listitem>
								<para><emphasis>Identificativo Esterno</emphasis>: Nei casi in cui
									il ruolo provenga da un sistema esterno, è possibile che il suo
									identificativo sia differente rispetto a quello indicato nel
									contesto del Registro. In tal caso inserire in questo campo tale
									identificativo esterno.</para>
							</listitem>
						</itemizedlist>
					</para>
				</sect4>
				<sect4 id="ruoloLocale">
					<title>Attribuzione dei Ruoli a Soggetti ed Applicativi</title>
					<para>È possibile attribuire un ruolo ad un soggetto cliccando sulla voce
						'Ruoli' presente sia nell'elenco dei soggetti che nel dettaglio di un
						singolo soggetto. L'attribuzione consiste nello scegliere uno dei ruoli
						selezionabili per il soggetto tra quelli compatibili con il contesto di
						erogazione di servizio e che prevedono una fonte di registrazione interna al
						registro. <figure id="attribuzioneRuoloSoggetto">
							<title>Attribuzione di un ruolo ad un soggetto</title>
							<mediaobject>
								<imageobject>
									<imagedata width="60%" fileref="FIGURE_OUT/addRuoloSoggetto.pdf"
									/>
								</imageobject>
								<imageobject>
									<imagedata width="60%" fileref="FIGURE_OUT/addRuoloSoggetto.jpg"
									/>
								</imageobject>
							</mediaobject>
						</figure>
					</para>
					<para>In uguale maniera è possibile attribuire un ruolo ad un applicativo di
						tipologia <emphasis>Frutore</emphasis> cliccando sulla voce 'Ruoli' presente
						nel dettaglio dell'applicativo. L'attribuzione consiste nello scegliere uno
						dei ruoli selezionabili per il servizio applicativo tra quelli compatibili
						con il contesto di fruizione di servizio e che prevedono una fonte di
						registrazione interna al registro. <figure id="attribuzioneRuoloSA">
							<title>Attribuzione di un ruolo ad un applicativo</title>
							<mediaobject>
								<imageobject>
									<imagedata width="60%" fileref="FIGURE_OUT/addRuoloSA.pdf"/>
								</imageobject>
								<imageobject>
									<imagedata width="60%" fileref="FIGURE_OUT/addRuoloSA.jpg"/>
								</imageobject>
							</mediaobject>
						</figure>
					</para>
				</sect4>
				<sect4 id="gw-erogazione-xacml">
					<title>XACML-Policy</title>
					<para> Questa tipologia di autorizzazione prevede di limitare l'accesso ai soli
						applicativi o soggetti fruitori che soddisfino una determinata policy XACML.
						La policy deve essere caricata nel contesto dell'autorizzazione sul
						controllo degli accessi, come mostrato in <xref
							linkend="registrazioneXACMLPolicy"/>. <figure
							id="registrazioneXACMLPolicy">
							<title>Registrazione di una XACML-Policy per l'erogazione</title>
							<mediaobject>
								<imageobject>
									<imagedata width="60%" fileref="FIGURE_OUT/xacmlPolicyAdd.pdf"/>
								</imageobject>
								<imageobject>
									<imagedata width="60%" fileref="FIGURE_OUT/xacmlPolicyAdd.png"/>
								</imageobject>
							</mediaobject>
						</figure>
					</para>
					<para>In fase di autorizzazione, il gateway costruisce una XACMLRequest
						contenente tutti i parametri della richiesta, comprese le informazioni
						relative al chiamante (credenziali ed eventuali ruoli), e la valida rispetto
						alla XACML-Policy associata all'erogazione. I parametri inseriti nella
						XACMLRequest, che possono essere utilizzati per effettuare la verifica
						all'interno di una XACML-Policy, sono i seguenti: <table
							id="xacmlRequestParams">
							<title>Parametri inseriti in una XACMLRequest</title>
							<tgroup align="left" cols="2" colsep="1" rowsep="1">
								<colspec colname="c1"/>
								<colspec colname="c2"/>
								<thead>
									<row>
										<entry>Nome</entry>
										<entry>Descrizione</entry>
									</row>
								</thead>
								<tbody>
									<row>
										<entry align="left" nameend="c2" namest="c1">
											<emphasis>Sezione 'Action'</emphasis>
										</entry>
									</row>
									<row>
										<entry>org:govway:action:provider</entry>
										<entry>Indica il soggetto erogatore del servizio</entry>
									</row>
									<row>
										<entry>org:govway:action:service</entry>
										<entry>Indica il servizio nel formato tipo/nome</entry>
									</row>
									<row>
										<entry>org:govway:action:action</entry>
										<entry>Nome dell'operazione del servizio invocata</entry>
									</row>
									<row>
										<entry>org:govway:action:url</entry>
										<entry>Url di invocazione utilizzata dal mittente</entry>
									</row>
									<row>
										<entry>org:govway:action:url:parameter:NOME_PARAM</entry>
										<entry>Tutti i parametri presenti nell'url di invocazione
											saranno inseriti nella XACMLRequest con questo
											formato</entry>
									</row>
									<row>
										<entry>org:govway:action:transport:header:NOME_HDR</entry>
										<entry>Tutti gli header http presenti nell'url di
											invocazione saranno inseriti nella XACMLRequest con
											questo formato</entry>
									</row>
									<row>
										<entry>org:govway:action:soapAction</entry>
										<entry>Valore della SOAPAction</entry>
									</row>
									<row>
										<entry>org:govway:action:gwService</entry>
										<entry>Ruolo della transazione (inbound/outbound)</entry>
									</row>
									<row>
										<entry>org:govway:action:protocol</entry>
										<entry>Modalità associata al servizio richiesto (es.
											spcoop)</entry>
									</row>
									<row>
										<entry>org:govway:action:token:audience</entry>
										<entry>Destinatario del token</entry>
									</row>
									<row>
										<entry>org:govway:action:token:scope</entry>
										<entry>Lista di scopes</entry>
									</row>
									<row>
										<entry>org:govway:action:token:jwt:claim:&lt;nome&gt;=&lt;valore&gt;</entry>
										<entry>Tutti i claims presenti nel jwt validato</entry>
									</row>
									<row>
										<entry>org:govway:action:token:introspection:claim:&lt;nome&gt;=&lt;valore&gt;</entry>
										<entry>Tutti i claims presenti nella risposta del servizio
											di introspection</entry>
									</row>
									<row>
										<entry align="left" nameend="c2" namest="c1">
											<emphasis>Sezione 'Subject'</emphasis>
										</entry>
									</row>
									<row>
										<entry>org:govway:subject:organization</entry>
										<entry>Indica il soggetto fruitore</entry>
									</row>
									<row>
										<entry>org:govway:subject:client</entry>
										<entry>Identificativo del servizio applicativo
											client</entry>
									</row>
									<row>
										<entry>org:govway:subject:credential</entry>
										<entry>Rappresenta la credenziale di accesso (username,
											subject o il principal) utilizzata dal client per
											richiedere il servizio</entry>
									</row>
									<row>
										<entry>org:govway:subject:role</entry>
										<entry>Elenco dei ruoli che possiede il client che ha
											richiesto il servizio</entry>
									</row>
									<row>
										<entry>org:govway:subject:token:issuer</entry>
										<entry>Issuer del token</entry>
									</row>
									<row>
										<entry>org:govway:subject:token:subject</entry>
										<entry>Subject del token</entry>
									</row>
									<row>
										<entry>org:govway:subject:token:username</entry>
										<entry>Username dell'utente cui è associato il token</entry>
									</row>
									<row>
										<entry>org:govway:subject:token:clientId</entry>
										<entry>Identificativo del client che ha negoziato il
											token</entry>
									</row>
									<row>
										<entry>org:govway:subject:token:userInfo:fullName</entry>
										<entry>Nome completo dell'utente cui è associato il
											token</entry>
									</row>
									<row>
										<entry>org:govway:subject:token:userInfo:firstName</entry>
										<entry>Nome dell'utente cui è associato il token</entry>
									</row>
									<row>
										<entry>org:govway:subject:token:userInfo:middleName</entry>
										<entry>Secondo nome (o nomi aggiuntivi) dell'utente cui è
											associato il token</entry>
									</row>
									<row>
										<entry>org:govway:subject:token:userInfo:familyName</entry>
										<entry>Cognome dell'utente cui è associato il token</entry>
									</row>
									<row>
										<entry>org:govway:subject:token:userInfo:eMail</entry>
										<entry>Email dell'utente cui è associato il token</entry>
									</row>
									<row>
										<entry>org:govway:subject:token:userInfo:claim:&lt;nome&gt;=&lt;valore&gt;</entry>
										<entry>Tutti i claims presenti nella risposta del servizio
											di UserInfo</entry>
									</row>
								</tbody>
							</tgroup>
						</table> Di seguito un esempio di XACMLPolicy che autorizza le richieste dei
						chiamanti che possiedono il ruolo 'Amministratore' ed uno tra i due ruoli
						'Operatore1' e 'Operatore2':
						<screen>
		&lt;Policy PolicyId="Policy"
			RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides"
			xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
			xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os http://docs.oasis-open.org/xacml/2.0/access_control-xacml-2.0-policy-schema-os.xsd">
			&lt;Target />
			&lt;Rule Effect="Permit" RuleId="ok">
				&lt;Condition>
					&lt;Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and">
		
						&lt;Apply
							FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-at-least-one-member-of">
							&lt;SubjectAttributeDesignator
								AttributeId="org:govway:subject:role"
								DataType="http://www.w3.org/2001/XMLSchema#string" />
							&lt;Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-bag">
								&lt;AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Amministratore&lt;/AttributeValue>
							&lt;/Apply>
						&lt;/Apply>
		
						&lt;Apply
							FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-at-least-one-member-of">
							&lt;SubjectAttributeDesignator
								AttributeId="org:govway:subject:role"
								DataType="http://www.w3.org/2001/XMLSchema#string" />
							&lt;Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-bag">
								&lt;AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Operatore1&lt;/AttributeValue>
								&lt;AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Operatore2&lt;/AttributeValue>
							&lt;/Apply>
						&lt;/Apply>
		
					&lt;/Apply>
				&lt;/Condition>
			&lt;/Rule>
			&lt;Rule Effect="Deny" RuleId="ko" />
		&lt;/Policy>
		</screen>
					</para>
				</sect4>

				<sect4 id="gw-erogazione-scope">
					<title>Scope</title>
					<para> Nella sezione <emphasis>Registro > Scope</emphasis> è possibile gestire
						il censimento degli scope da utilizzare successivamente per le politiche di
						autorizzazione nell'ambito del controllo degli accessi. </para>
					<para> La maschera di creazione di uno scope è quella mostrata in <xref
							linkend="gw-erogazione-scope-fig"/>. <figure
							id="gw-erogazione-scope-fig">
							<title>Creazione di uno Scope</title>
							<mediaobject>
								<imageobject>
									<imagedata width="60%" fileref="FIGURE_OUT/AggiungiScope.pdf"/>
								</imageobject>
								<imageobject>
									<imagedata width="60%" fileref="FIGURE_OUT/AggiungiScope.png"/>
								</imageobject>
							</mediaobject>
						</figure> I dati da fornire sono: <itemizedlist>
							<listitem>
								<para>
									<emphasis>Nome</emphasis>: nome assegnato internamente allo
									scope </para>
							</listitem>
							<listitem>
								<para>
									<emphasis>Descrizione</emphasis>: un testo di descrizione
								</para>
							</listitem>
							<listitem>
								<para>
									<emphasis>Identificativo Esterno</emphasis>: nome originale
									dello scope presente nel token </para>
							</listitem>
							<listitem>
								<para>
									<emphasis>Contesto</emphasis>: specifica se lo scope si utilizza
									solo nei contesti di erogazione, fruizione o entrambe le
									possibilità. </para>
							</listitem>
						</itemizedlist>
					</para>
				</sect4>
			</sect3>
			<sect3 id="gw-erogazione-ratelimiting">
				<title>Rate Limiting</title>
				<para> Questa sezione di configurazione, specifica per erogazioni e fruizioni (o
					specifico gruppo di configurazione nell'ambito di un'erogazione/fruizione),
					consente di attivare delle policy di rate limiting specifiche per l'istanza
					configurata. </para>
				<para> L'attivazione di policy di rate limiting rientra nell'ambito degli strumenti
					per il controllo del traffico. La descrizione di dettaglio di questi strumenti è
					presente nella <xref linkend="config-controllotraffico"/>, dove viene illustrato
					il meccanismo per configurare le policy e più in dettaglio nella <xref
						linkend="config-controllotraffico-policy"/> riguardo l'attivazione di policy
					a valenza globale. </para>
				<para> Sono presenti alcune policy di rate limiting preconfigurate e pronte all'uso.
					L'utente può crearne di nuove seguendo le indicazioni presenti nella <xref
						linkend="config-controllotraffico"/>. Le policy preconfigurate sono le
					seguenti: <itemizedlist>
						<listitem>
							<para>
								<emphasis>NumeroRichieste-ControlloRealtimeGiornaliero</emphasis>:
								La policy confronta il numero di richieste, sulla finestra
								giornaliera corrente, della specifica istanza di servizio, con la
								soglia stabilita. </para>
						</listitem>
						<listitem>
							<para>
								<emphasis>NumeroRichieste-ControlloRealtimeMinuti</emphasis>: La
								policy confronta il numero di richieste, sulla finestra del minuto
								corrente, della specifica istanza di servizio, con la soglia
								stabilita. </para>
						</listitem>
						<listitem>
							<para>
								<emphasis>NumeroRichieste-ControlloRealtimeOrario</emphasis>: La
								policy confronta il numero di richieste, sulla finestra oraria
								corrente, della specifica istanza di servizio, con la soglia
								stabilita. </para>
						</listitem>
						<listitem>
							<para>
								<emphasis>NumeroRichieste-RichiesteSimultanee</emphasis>: La policy
								confronta il numero di richieste simultaneamente attive della
								specifica istanza di servizio, con la soglia stabilita. </para>
						</listitem>
						<listitem>
							<para>
								<emphasis>OccupazioneBanda-ControlloRealtimeOrario</emphasis>: La
								policy confronta l'occupazione di banda della specifica istanza di
								servizio, sulla finestra oraria corrente, con la soglia stabilita.
							</para>
						</listitem>
						<listitem>
							<para>
								<emphasis>TempoMedioRisposta-ControlloRealtimeOrario</emphasis>: La
								policy confronta il tempo medio di risposta della specifica istanza
								di servizio, sulla finestra oraria corrente, con la soglia
								stabilita. </para>
						</listitem>
					</itemizedlist>
				</para>
				<note>
					<title>Header HTTP ritornati all'applicativo</title>
					<para>L'attivazione di policy di Rate Limiting fa si che il Gateway generi gli
						header http descritti nella sezione <xref
							linkend="header-integrazione-risposta-client"/>.</para>
				</note>
				<para> Per attivare una nuova policy dalla sezione di rate limiting si procede
					utilizzando il pulsante <emphasis>Aggiungi</emphasis> che apre il form di <xref
						linkend="gw-erogazione-ratelimiting-fig"/>. <figure
						id="gw-erogazione-ratelimiting-fig">
						<title>Attivazione di una policy di Rate Limiting</title>
						<mediaobject>
							<imageobject>
								<imagedata width="60%"
									fileref="FIGURE_OUT/ErogazioneRateLimiting_Aggiungi.png"/>
							</imageobject>
							<imageobject>
								<imagedata width="60%"
									fileref="FIGURE_OUT/ErogazioneRateLimiting_Aggiungi.pdf"/>
							</imageobject>
						</mediaobject>
					</figure> Si compilano i campi seguenti: <itemizedlist>
						<listitem>
							<para>
								<emphasis>Policy</emphasis>: la policy da attivare. Si compone di: <itemizedlist>
									<listitem>
										<para>
											<emphasis>Identificativo</emphasis>: Identificativo
											univoco assegnato automaticamente all'istanza di policy.
										</para>
									</listitem>
									<listitem>
										<para>
											<emphasis>Policy</emphasis>: L'elemento del registro
											delle policy che si vuole attivare. Inizialmente saranno
											presenti solo le policy preconfigurate. Eventualmente
											saranno presenti in seguito le policy definite
											dall'utente</para>
									</listitem>
									<listitem>
										<para>
											<emphasis>Nome</emphasis>: Opzionale. Permette di
											identificare l’istanza della policy tramite un nome
											alternativo all’identificativo assegnato automaticamente
											dal sistema. </para>
									</listitem>
									<listitem>
										<para>
											<emphasis>Descrizione</emphasis>: Il testo di
											descrizione della policy. </para>
									</listitem>
									<listitem>
										<para>
											<emphasis>Stato</emphasis>: Lo stato dell'istanza di
											policy una volta creata. Sono disponibili le seguenti
											opzioni: <itemizedlist>
												<listitem>
												<para>
												<emphasis>Abilitato</emphasis>: L'istanza di
												policy è abilitata. Questo significa che le
												violazioni rilevate saranno gestite in maniera
												restrittiva (negazione del servizio). </para>
												</listitem>
												<listitem>
												<para>
												<emphasis>WarningOnly</emphasis>: L'istanza di
												policy è abilitata in modalità WarningOnly. Questo
												significa che le violazioni rilevate saranno solo
												segnalate tramite messaggi diagnostici ma non ci
												saranno ripercussioni sull'elaborazione della
												richiesta. </para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Disabilitato</emphasis>: L'istanza di
												policy è disabilitata. </para>
												</listitem>
											</itemizedlist>
										</para>
									</listitem>
									<listitem>
										<para>
											<emphasis>Ridefinisci Valori di Soglia</emphasis>:
											Attivando questa opzione sarà possibile utilizzare una
											soglia per l'istanza di policy differente rispetto al
											valore di default previsto dalla policy d'origine.
										</para>
									</listitem>
								</itemizedlist>
							</para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Filtro</emphasis>: Abilitando questa sezione dell'istanza
								di policy è possibile indicare i criteri per stabilire quali
								richieste, nell'ambito della istanza in fase di configurazione, sono
								soggette alla policy che si sta istanziando. In assenza di filtro,
								l'istanza della policy sarà valutata su tutte le richieste in
								ingresso per la specifica istanza di servizio che si sta
								configurando. </para>
							<para> Per la creazione del filtro sono disponibili i seguenti campi: <itemizedlist>
									<listitem>
										<para>
											<emphasis>Azione</emphasis>: Opzione per filtrare le
											richieste in base all'azione invocata. </para>
									</listitem>
									<listitem>
										<para>
											<emphasis>Soggetto Fruitore</emphasis>: Opzione
											disponibile per le erogazioni al fine di filtrare le
											richieste di servizio in base al soggetto fruitore.
										</para>
									</listitem>
									<listitem>
										<para>
											<emphasis>Applicativo Fruitore</emphasis>: Opzione
											disponibile per le fruizioni al fine di filtrare le
											richieste di servizio in base all'applicativo fruitore
										</para>
									</listitem>
									<listitem>
										<para>
											<emphasis>Filtro per Chiave</emphasis>: Si tratta di
											un'opzione avanzata che consente di filtrare le
											richieste in ingresso sul gateway base ad una chiave che
											può essere specificata in maniera personalizzata
											effettuando una delle seguenti scelte per il campo
												<emphasis>Tipologia</emphasis>: <itemizedlist>
												<listitem>
												<para>
												<emphasis>HeaderBased</emphasis>: Occorre fornire
												i dati “Nome” e “Valore”. La policy si applicherà
												soltanto alle richieste che hanno, nell'header di
												trasporto, una proprietà che corrisponde. </para>
												</listitem>
												<listitem>
												<para>
												<emphasis>URLBased</emphasis>: Occorre fornire i
												dati “Espressione Regolare” e “Valore”. La policy
												si applicherà soltanto alle richieste ove,
												applicando l'espressione regolare alla URL di
												invocazione, si ottiene un valore identico a
												quello fornito. </para>
												</listitem>
												<listitem>
												<para>
												<emphasis>FormBased</emphasis>: Occorre fornire i
												dati “Nome” e “Valore”. La policy si applicherà
												soltanto alle richieste che contengono nella query
												string un parametro corrispondente ai dati
												forniti. </para>
												</listitem>
												<listitem>
												<para>
												<emphasis>SOAPActionBased</emphasis>: Occorre
												fornire il dato “Valore”. + La policy si
												applicherà soltanto alle richieste che si
												presentano con una SOAPAction avente il valore
												fornito. </para>
												</listitem>
												<listitem>
												<para>
												<emphasis>ContentBased</emphasis>: Occorre fornire
												i dati “Espressione XPath” e “Valore”. La policy
												si applicherà soltanto alle richieste dove,
												applicando l'espressione XPath al messaggio di
												richiesta, si ottiene un valore identico a quello
												fornito. </para>
												</listitem>
												<listitem>
												<para>
												<emphasis>PluginBased</emphasis>: Occorre fonire i
												dati “Tipo Personalizzato” e “Valore”. Il
												parametro “Tipo Personalizzato” è una chiave,
												registrata nella configurazione, cui corrisponde
												una classe java che restituisce un valore da
												confrontare con quello fornito. Per realizzare un
												plugin con una logica di filtro personalizzata è
												necessario fornire un'implementazione della
												seguente interfaccia:
												<screen>
package org.openspcoop2.pdd.core.controllo_traffico.plugins; 
public interface IRateLimiting {
	public String estraiValoreFiltro(Logger log,Dati datiRichiesta) throws PluginsException;
	public String estraiValoreCollezionamentoDati(Logger log,Dati datiRichiesta) throws PluginsException;
}
</screen>
												La classe realizzata viene successivamente
												registrata tramite una entry nel file
												<emphasis>className.properties</emphasis> di
												GovWay:
												<screen>
org.openspcoop2.pdd.controlloTraffico.rateLimiting.test=&lt;fully qualified class name&gt;
</screen>
												La stringa &lt;nome&gt;, fornita in
												configurazione, diventa utilizzabile come “Tipo
												Personalizzato”. </para>
												</listitem>
											</itemizedlist>
										</para>
									</listitem>
								</itemizedlist>
							</para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Criterio di Collezionamento dei Dati</emphasis>: In questa
								sezione è possibile attivare opzionalmente alcuni criteri per il
								raggruppamento dei dati utilizzati come indicatori di confronto per
								l'applicabilità della policy. Ad esempio se si è attivata una policy
								che limita a 20 il numero di richieste su una finestra di 5 minuti,
								significa che al raggiungimento della ventunesima richiesta, nella
								stessa finestra temporale, si otterrà una violazione della policy. </para>
							<para> Aggiungendo un criterio di collezionamento per Azione, saranno
								conteggiate separatamente le richieste in base alla specifica azione
								invocata. In questo caso la policy risulterà violata solo al
								raggiungimento della ventunesima richiesta, nella stessa finestra
								temporale, relativa alla medesima azione. </para>
							<para> È ammesso anche il raggruppamento su criteri multipli. La logica
								è del tutto analoga a quella dell'operatore GROUP BY del linguaggio
								SQL. </para>
							<para> I criteri di raggruppamento selezionabili sono: <itemizedlist>
									<listitem>
										<para>
											<emphasis>Azione</emphasis>
										</para>
									</listitem>
									<listitem>
										<para>
											<emphasis>Soggetto Fruitore</emphasis> (caso erogazioni)
										</para>
									</listitem>
									<listitem>
										<para>
											<emphasis>Applicativo Fruitore</emphasis> (caso
											fruizioni) </para>
									</listitem>
									<listitem>
										<para>
											<emphasis>Raggruppamento per Chiave</emphasis>: le
											richieste saranno raggruppate in base al valore di una
											chiave personalizzata il cui valore viene fornito
											secondo uno dei metodi selezionati tra i seguenti: <itemizedlist>
												<listitem>
												<para>
												<emphasis>HeaderBased</emphasis>: La chiave è
												presente nell'header di trasporto indicato nella
												proprietà "Nome". </para>
												</listitem>
												<listitem>
												<para>
												<emphasis>URLBased</emphasis>: La chiave è
												presente nella URL ricavandola tramite
												l'espressione regolare fornita nell'elemento
												seguente. </para>
												</listitem>
												<listitem>
												<para>
												<emphasis>FormBased</emphasis>: La chiave viene
												fornita in modalità Form Encoded con il parametro
												indicato nell'elemento "Nome". </para>
												</listitem>
												<listitem>
												<para>
												<emphasis>SOAPActionBased</emphasis>: La chiave
												corrisponde al valore della SoapAction. </para>
												</listitem>
												<listitem>
												<para>
												<emphasis>ContentBased</emphasis>: La chiave è
												presente nel body del messaggio e viene ricavata
												tramite il valore Xpath fornito nell'elemento
												seguente. </para>
												</listitem>
												<listitem>
												<para>
												<emphasis>PluginBased</emphasis>: La chiave viene
												restituita tramite l'esecuzione di una classe il
												cui nome viene fornito con il campo "Tipo
												Personalizzato" </para>
												</listitem>
											</itemizedlist>
										</para>
									</listitem>
								</itemizedlist>
							</para>
						</listitem>
					</itemizedlist>
				</para>
			</sect3>
			<sect3 id="gw-erogazione-validazione">
				<title>Validazione dei messaggi</title>
				<para> Per attivare la validazione dei messaggi in transito sul gateway si accede al
					collegamento presente nella colonna <emphasis>Validazione</emphasis> presente
					tra gli elementi di configurazione della specifica erogazione/fruizione. <figure
						id="gw-erogazione-validazione-fig">
						<title>Validazione dei messaggi</title>
						<mediaobject>
							<imageobject>
								<imagedata width="50%" fileref="FIGURE_OUT/Validazione.pdf"/>
							</imageobject>
							<imageobject>
								<imagedata width="50%" fileref="FIGURE_OUT/Validazione.png"/>
							</imageobject>
						</mediaobject>
					</figure> Compilare il form di configurazione (<xref
						linkend="gw-erogazione-validazione-fig"/>): <itemizedlist>
						<listitem>
							<para><emphasis>Stato</emphasis>: Consente di abilitare/disabilitare la
								funzionalità di validazione sulla voce di configurazione scelta.
								L'opzione <emphasis>warnignOnly</emphasis> consente di attivare la
								funzionalità di validazione evitando però che, se tale fase non
								viene superata, venga bloccato il messaggio e restituito un errore.
								In quest'ultimo caso, gli errori di validazione verranno segnalati
								solo tramite l'emissione di opportuni messaggi diagnostici dal
								servizio di tracciamento.</para>
						</listitem>
						<listitem>
							<para><emphasis>Tipo</emphasis>: Nel caso si sia abilitato il servizio
								di validazione, questo campo consente di selezionare la metodologia
								che si vuole utilizzare. I valori selezionabili da questo elenco
								cambiano in base alla tipologia delle API cui fa riferimento
								l'erogazione/fruizione.</para>
						</listitem>
					</itemizedlist> I tipi di validazione previsti sono: <itemizedlist>
						<listitem>
							<para>
								<emphasis>Schemi XSD</emphasis>, la validazione si basa sugli schemi
								xsd allegati alle API. Utilizzato per la validazione sintattica dei
								messaggi XML sia nel caso Soap che Rest.</para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Wsdl</emphasis>, la validazione si basa sull'interfaccia
								wsdl fornita con la API. Questo tipo di validazione è più rigorosa
								in quanto controlla non solo la conformità sintattica ma viene
								validato il messaggio in transito verificando che sia idoneo al
								PortType e Operation in uso. Questo tipo di validazione è
								applicabile solo al caso Soap.</para>
							<para>
								<emphasis>Swagger 2.0 o OpenAPI 3.0</emphasis>, nei casi in cui si è
								fornito un descrittore formale per una API Rest, la validazione sarà
								effettuata utilizzando gli strumenti associati allo specifico
								formato.</para>
						</listitem>
					</itemizedlist>
				</para>
				<para>Nel caso di servizi Soap, se i messaggi che transitanto sulla porta di dominio
					possiedono il formato MTOM, per poterli validare è necessario attivare l'opzione
						<emphasis>Accetta MTOM</emphasis>. Tale opzione normalizza i messaggi prima
					di effettuarne la validazione e ripristina il formato originale una volta
					completato il processo di validazione. <note>
						<para> Si tenga presente che attivando la validazione dei messaggi, questa
							riguarderà sia le richieste, inviate al servizio, che le conseguenti
							risposte. </para>
					</note>
				</para>
			</sect3>
			<sect3 id="gw-erogazione-response-caching">
				<title>Caching Risposta</title>
				<para>In GovWay è possibile abilitare il salvataggio delle risposte in una cache sia
					globalmente, in modo che sia attivo per tutte le APIs, che singolarmente sulla
					singola erogazione o fruizione. Questa funzionalità permette ad un backend
					server di non dover riprocessare le stesse richieste più volte. </para>
				<para> Tramite il collegamento <emphasis>Caching Risposta</emphasis>, presente nella
					sezione di configurazione della specifica erogazione/fruizione, è possibile
					agire sulla configurazione di tale funzionalità. L'impostazione permette di
					ridefinire la configurazione globale; i campi del form sono i medesimi descritti
					nella configurazione globale (<xref linkend="configurazione-response-caching"
					/>). </para>
			</sect3>
			<sect3 id="gw-erogazione-security">
				<title>Sicurezza a livello del messaggio</title>
				<para>Tramite il collegamento <emphasis>Sicurezza Messaggio</emphasis>, presente
					nella sezione di configurazione della specifica erogazione/fruizione, è
					possibile impostare criteri di elaborazione dei messaggi in transito, attuati
					dal gateway, al fine di gestire i meccanismi di sicurezza previsti a livello del
					messaggio. </para>
				<para> Il form presenta inizialmente lo <emphasis>Stato</emphasis> disabilitato. Per
					abilitare la sicurezza, impostare il valore dello stato su abilitato e
					confermare con il pulsante <emphasis>Invia</emphasis>. Appariranno gli elementi
						<emphasis>Richiesta</emphasis> e <emphasis>Risposta</emphasis>, come nella
					figura seguente. <figure id="gw-erogazione-security-fig">
						<title>Abilitazione Sicurezza Messaggio</title>
						<mediaobject>
							<imageobject>
								<imagedata width="50%" fileref="FIGURE_OUT/SicurezzaMessaggio.png"/>
							</imageobject>
							<imageobject>
								<imagedata width="50%" fileref="FIGURE_OUT/SicurezzaMessaggio.pdf"/>
							</imageobject>
						</mediaobject>
					</figure>
				</para>
				<para>Il form consente di selezionare uno schema di sicurezza, tra quelli
					disponibili, da applicare al messaggio di richiesta ed a quello di risposta. Gli
					schemi di sicurezza applicabili cambiano in base alla tipologia del messaggio
					sul quale si applica. </para>
				<para> Per la gestione della sicurezza sul messaggio di richiesta, nel caso di una
					erogazione, il gateway agisce con il ruolo <emphasis>Receiver</emphasis> che
					comporta la seguente casistica: <itemizedlist>
						<listitem>
							<para>
								<emphasis>Nel caso del protocollo SOAP</emphasis>: <itemizedlist>
									<listitem>
										<para>
											<emphasis>WSSec Signature</emphasis>, in ricezione si
											attende un messaggio firmato; l'azione è quella di
											verificare la firma presente</para>
									</listitem>
									<listitem>
										<para>
											<emphasis>WSSec Decrypt</emphasis>, il messaggio
											ricevuto verrà decifrato</para>
									</listitem>
									<listitem>
										<para>
											<emphasis>WSSec SAML Token</emphasis>, si attende un
											messaggio contenente una asserzione SAML; viene
											effettuata la verifica dell'asserzione presente.</para>
									</listitem>
									<listitem>
										<para>
											<emphasis>WSSec Username Token</emphasis>, viene
											effettuata la validazione del token di
											autenticazione</para>
									</listitem>
									<listitem>
										<para>
											<emphasis>WSSec Timestamp</emphasis>, se è prevista una
											scadenza all'interno del timestamp presente nel
											messaggio, se ne verificherà la validità</para>
									</listitem>
								</itemizedlist>
							</para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Nel caso del protocollo REST</emphasis>
								<itemizedlist>
									<listitem>
										<para>
											<emphasis>JWT Decrypt</emphasis>: il messaggio JSON
											ricevuto viene decifrato. </para>
									</listitem>
									<listitem>
										<para>
											<emphasis>JWT Verifier Signature</emphasis>: al
											messaggio JSON ricevuto viene verificata la firma.
										</para>
									</listitem>
									<listitem>
										<para>
											<emphasis>XML Decrypt</emphasis>: il messaggio XML
											ricevuto viene decifrato. </para>
									</listitem>
									<listitem>
										<para>
											<emphasis>XML Verifier Signature</emphasis>: al
											messaggio XML ricevuto viene verificata la firma.
										</para>
									</listitem>
								</itemizedlist>
							</para>
						</listitem>
					</itemizedlist>
				</para>
				<para>Per la gestione della sicurezza sul messaggio di risposta, nel caso di una
					erogazione, il gateway agisce con il ruolo <emphasis>Sender</emphasis> che
					comporta la seguente casistica: <itemizedlist>
						<listitem>
							<para>
								<emphasis>Nel caso del protocollo SOAP</emphasis>: <itemizedlist>
									<listitem>
										<para>
											<emphasis>WSSec Signature</emphasis>, il messaggio verrà
											firmato</para>
									</listitem>
									<listitem>
										<para>
											<emphasis>WSSec Encrypt</emphasis>, il messaggio verrà
											cifrato</para>
									</listitem>
									<listitem>
										<para>
											<emphasis>WSSec SAML Token</emphasis>, sul messaggio
											verrà inserita una asserzione SAML</para>
									</listitem>
									<listitem>
										<para>
											<emphasis>WSSec Username Token</emphasis>, il messaggio
											verrà arrichito di un token di autenticazione</para>
									</listitem>
									<listitem>
										<para>
											<emphasis>WSSec Timestamp</emphasis>, il messaggio verrà
											arrichito di una informazione temporale (tipicamente
											utilizzato insieme alla firma del messaggio)</para>
									</listitem>
								</itemizedlist>
							</para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Nel caso del protocollo REST</emphasis>: <itemizedlist>
									<listitem>
										<para>
											<emphasis>JWT Encrypt</emphasis>: il messaggio JSON di
											risposta viene cifrato prima dell'invio. </para>
									</listitem>
									<listitem>
										<para>
											<emphasis>JWT Signature</emphasis>: il messaggio JSON di
											risposta viene firmato prima dell'invio. </para>
									</listitem>
									<listitem>
										<para>
											<emphasis>XML Encrypt</emphasis>: il messaggio XML di
											risposta viene cifrato prima dell'invio. </para>
									</listitem>
									<listitem>
										<para>
											<emphasis>XML Signature</emphasis>: il messaggio XML di
											risposta viene firmato prima dell'invio. </para>
									</listitem>
								</itemizedlist>
							</para>
						</listitem>
					</itemizedlist>
					<note>
						<para> Si tenga presente che, nel caso di una fruizione, il ruolo del
							gateway si inverte diventando <emphasis>Sender</emphasis> nel caso della
							richiesta e <emphasis>Receiver</emphasis> nel caso della risposta. Gli
							schemi di sicurezza disponibili, nel caso della fruizione, rimangono
							quelli già descritti per Sender e Receiver. </para>
					</note>
				</para>
			</sect3>
			<sect3 id="gw-erogazione-tracciamento">
				<title>Tracciamento</title>
				<para> Il tracciamento è la funzionalità del gateway che comporta la registrazione
					dei dati relativi alle comunicazioni in transito riguardanti i servizi erogati e
					fruiti. Nella logica del gateway, tutte le informazioni che riguardano una
					singola interlocuzione, a partire dalla richiesta pervenuta fino alla
					conclusione con l'invio dell'eventuale risposta, sono riconducibili ad un'unica
					entità denominata <emphasis>Transazione</emphasis>. </para>
				<para> Una transazione registrata dal gateway ha la seguente struttura: <itemizedlist>
						<listitem>
							<para>
								<emphasis>Dati di Identificazione Generale</emphasis>. Sono le
								informazioni che identificano la comunicazione specifica in termini
								dei soggetti coinvolti e del servizio richiesto: Soggetto Erogatore,
								Soggetto Fruitore, Servizio, Azione, Esito, ... </para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Dati della Richiesta</emphasis>. Sono le informazioni di
								dettaglio relative alla richiesta: Identificativo del Messaggio,
								Timestamp di ingresso, Timestamp di uscita, dimensioni del
								messaggio, ... </para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Dati della Risposta</emphasis>. Sono le medesime
								informazioni già citate al punto precedente, ma relative alla
								comunicazione di risposta. </para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Traccia Richiesta</emphasis>. La traccia emessa dal
								gateway con i dettagli relativi alla richiesta. </para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Traccia Risposta</emphasis>. La traccia emessa dal gateway
								con i dettagli relativi alla risposta. </para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Messaggi Diagnostici</emphasis>. La sequenza dei messaggi
								diagnostici, ordinati cronlogicamente, emessi dal gateway nel corso
								dell'elaborazione dell'intera transazione. </para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Fault di Ingresso</emphasis>. Viene registrato come Fault
								di Ingresso l'eventuale messaggio di errore ricevuto dal gateway
								durante l'invocazione di un servizio (interno o esterno al dominio
								gestito). </para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Fault di Uscita</emphasis>. Viene registrato come Fault di
								Uscita l'eventuale messaggio di errore inoltrato dal gateway al
								mittente della richiesta (interno o esterno al dominio gestito),
								dopo aver ricevuto un fault dal servizio invocato. </para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Parametri e Misurazioni</emphasis>. Sono i parametri e le
								misurazioni che riguardano la transazione, come ad esempio:
								l'identificativo della transazione, le url invocate, i tempi di
								latenza, ... </para>
						</listitem>
					</itemizedlist>
				</para>
				<para> In questa sezione è possibile personalizzare la configurazione di default del
					tracciamento definita in accordo a quanto descritto in <xref
						linkend="config-tracciamento"/>. Le personalizzazioni inserite in questo
					contesto avranno validità per le sole comunicazioni riguardanti la specifica
					erogazione/fruizione (<xref linkend="gw-erogazione-tracciamento-fig"/>). <figure
						id="gw-erogazione-tracciamento-fig">
						<title>Tracciamento per la singola erogazione/fruizione</title>
						<mediaobject>
							<imageobject>
								<imagedata width="60%" fileref="FIGURE_OUT/TracciamentoServizio.png"
								/>
							</imageobject>
							<imageobject>
								<imagedata width="60%" fileref="FIGURE_OUT/TracciamentoServizio.pdf"
								/>
							</imageobject>
						</mediaobject>
					</figure>
				</para>
				<para> Le sezioni presenti nella pagina sono: <itemizedlist>
						<listitem>
							<para>
								<emphasis>Transazioni Registrate</emphasis>: l'utente ha l'opzione
								per mantenere il default definito nella sezione di configurazione
								generale (<xref linkend="config-tracciamento"/>) oppure ridefinirlo.
							</para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Messaggi Diagnostici</emphasis>: l'utente ha l'opzione per
								mantenere il default definito nella sezione di configurazione
								generale (<xref linkend="config-tracciamento"/>) oppure ridefinire
								il criterio per la sola memorizzazione su Database. </para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Correlazione Applicativa</emphasis>: consente di impostare
								delle regole per estrarre dai messaggi in transito, codici,
								riferimenti, o altri contenuti al fine di arricchire i dati
								tracciamento generati dal gateway (<xref
									linkend="gw-erogazione-tracciamento-correlazione"/>). </para>
						</listitem>
					</itemizedlist>
				</para>

				<sect4 id="gw-erogazione-tracciamento-correlazione">
					<title>Correlazione Applicativa</title>
					<para> La funzione di <emphasis>Correlazione Applicativa</emphasis> consente al
						gateway che elabora il messaggio di richiesta, di estrarre un identificatore
						relativo al contenuto applicativo. L'identificatore, se presente, finisce
						nei sistemi di tracciamento e diagnostici, a completamento delle
						informazioni già presenti. I dati per configurare la correlazione
						applicativa consistono in un insieme di regole per l'estrazione di tale
						identificatore. </para>
					<para> Per accedere alla configurazione della correlazione applicativa, per una
						data erogazione/fruizione, si utilizza la sezione "Correlazione Applicativa"
						presente nell'ambito della configurazione del tracciamento di una
						fruizione/erogazione (<xref linkend="gw-erogazione-tracciamento"/>). </para>
					<para>Utilizzando il collegamento <emphasis>Regole</emphasis>, presente nel
						riquadro della Richiesta o Risposta, si accede all'elenco delle regole di
						correlazione applicativa presenti. Premere il pulsante
							<emphasis>Aggiungi</emphasis> per aggiungere una nuova regola (<xref
							linkend="gw-erogazione-correlazione-new-fig"/>)</para>

					<figure id="gw-erogazione-correlazione-new-fig">
						<title>Creazione di una regola di correlazione applicativa</title>

						<mediaobject>
							<imageobject>
								<imagedata width="60%"
									fileref="FIGURE_OUT/CorrelazioneApplicativa-new.pdf"/>
							</imageobject>
							<imageobject>
								<imagedata width="60%"
									fileref="FIGURE_OUT/CorrelazioneApplicativa-new.png"/>
							</imageobject>
						</mediaobject>
					</figure>

					<para>Per la creazione di una regola di correlazione applicativa si devono
						indicare i seguenti dati: <itemizedlist>
							<listitem>
								<para><emphasis>Elemento</emphasis>: Questo dato serve per capire su
									quali messaggi è applicabile la regola di correlazione
									applicativa che si sta definendo. Lasciando il campo vuoto si
									intende che la regola si applica a tutti i messaggi. In
									alternativa è possibile indicare: <itemizedlist>
										<listitem>
											<para><emphasis>Nome Azione o Risorsa</emphasis>: il
												nome esatto dell'azione o della risorsa su cui verrà
												applicativa la regola</para>
										</listitem>
										<listitem>
											<para><emphasis>LocalName dell'elemento xml</emphasis>:
												in caso il messaggio sia un xml (soap o rest), è
												possibile indicare il local name del root element
												xml su cui verrà applicativa la regola</para>
										</listitem>
										<listitem>
											<para><emphasis>XPath o JSONPath</emphasis>: Espressione
												che può rappresentare un XPath o JSONPath. Se
												l'espressione ha un match con il contenuto la regola
												verrà applicata</para>
										</listitem>
									</itemizedlist>
								</para>
							</listitem>

							<listitem>
								<para><emphasis>Modalità Identificazione</emphasis>: rappresenta la
									modalità di acquisizione dell'identificatore applicativo. Può
									assumere i seguenti valori:</para>

								<itemizedlist>
									<listitem>
										<para><emphasis>urlBased</emphasis>: il valore viene preso
											dalla url utilizzata dal servizio applicativo per
											l'invocazione. La regola per l'estrazione dalla url
											viene specificata tramite un'espressione regolare
											inserita nel campo pattern.</para>
									</listitem>

									<listitem>
										<para><emphasis>contentBased</emphasis>: Il valore viene
											estratto direttamente dal messaggio applicativo. La
											regola per l'estrazione dal messaggio è specificata
											tramite un'espressione XPath o JSONPath inserita nel
											campo pattern;</para>
									</listitem>

									<listitem>
										<para>
											<emphasis>headerBased</emphasis>: Il valore viene
											estratto dall'header di trasporto avente il nome
											indicato nel campo successivo. </para>
									</listitem>

									<listitem>
										<para><emphasis>inputBased</emphasis>: il valore viene
											estratto dall'header di integrazione GovWay e presente
											nel valore della proprietà
												<emphasis>IDApplicativo</emphasis>.</para>
									</listitem>

									<listitem>
										<para><emphasis>disabilitato</emphasis>: l'identificatore
											applicativo non viene estratto. Questa opzione è utile
											quando si vuole disabilitare l'estrazione dell'id
											applicativo solo per specifici messaggi;</para>
									</listitem>
								</itemizedlist>
							</listitem>

							<listitem>
								<para><emphasis>Pattern</emphasis>: definisce l'espressione
									regolare, nel caso di identificazione urlBased, o l'espressione
									XPath/JSONPath, nel caso di identificazione contentBased,
									utilizzata per l'acquisizione dell'identificatore
									applicativo.</para>
							</listitem>

							<listitem>
								<para><emphasis>Identificazione Fallita</emphasis>: azione da
									intraprendere nel caso fallisca l'estrazione dell'identificatore
									applicativo tramite la regola specificata. Nel caso sia stato
									indicato <emphasis>blocca</emphasis>, tali richieste non
									verranno accettate con restituzione di un errore al
									mittente;</para>
							</listitem>

							<listitem>
								<para><emphasis>Riuso ID</emphasis>: opzione per
									abilitare/disabilitare il riuso dell'identificatore del
									messaggio (assegnato dal gateway) nel caso in cui vengano
									inviati messaggi con identificatori applicativi già processati
									in precedenza.</para>
							</listitem>
						</itemizedlist>
					</para>
				</sect4>

			</sect3>

			<sect3 id="gw-erogazione-mtom">
				<title>MTOM</title>
				<para>Nei casi in cui il mittente e il destinatario si scambiano messaggi con
					allegati (nell'ambito del protocollo SOAP), utilizzando il protocollo MTOM,
					GovWay è in grado di gestire tali comunicazioni in modalità trasparente e quindi
					senza alcun intervento.</para>
				<para>In altre situazioni è possibile sfruttare le funzionalità di GovWay per
					beneficiare delle ottimizzazioni del protocollo MTOM quando uno dei due
					interlocutori non è in grado di supportare tale protocollo, oppure per
					effettuare verifiche di congruità dei messaggi in transito basati su MTOM. </para>
				<para>Nel caso di una erogazione, per il messaggio di richiesta, le opzioni
					disponibili sono: <itemizedlist>
						<listitem>
							<para>
								<emphasis>disable</emphasis>. Non viene svolta alcuna azione.
							</para>
						</listitem>
						<listitem>
							<para>
								<emphasis>unpackaging</emphasis>. In questo scenario il client
								fruitore invia dati binari nel formato MTOM ma l'erogatore non
								supporta tale formato. Il gateway effettua la trasformazione del
								messaggio inserendo i dati binari in modalità <emphasis>Base64
									encoded</emphasis> prima che venga inviato al destinatario.
								Sulla risposta sarà effettuato il processo inverso. </para>
						</listitem>
						<listitem>
							<para>
								<emphasis>verify</emphasis>. Sia il fruitore che l'erogatore
								utilizzano MTOM ma si vogliono validare i messaggi. Il gateway
								effettua, tramite opportuni pattern xpath forniti, la validazione
								dei messaggi al fine di verificare la conformità del formato del
								messaggio rispetto a quanto atteso dall'erogatore. </para>
						</listitem>
					</itemizedlist>
				</para>
				<para>Sempre nel caso di una erogazione, per il messaggio di risposta, le opzioni
					disponibili sono: <itemizedlist>
						<listitem>
							<para>
								<emphasis>disable</emphasis>. Non viene svolta alcuna azione.
							</para>
						</listitem>
						<listitem>
							<para>
								<emphasis>packaging</emphasis>. In questo scenario il client
								fruitore invia dati binari nella modalità Base64 encoded ma
								l'erogatore richiede il formato MTOM. Il gateway effettua la
								trasformazione del messaggio secondo il protocollo MTOM prima che
								venga inviato al destinatario. Sulla risposta sarà effettuato il
								processo inverso. </para>
						</listitem>
						<listitem>
							<para>
								<emphasis>verify</emphasis>. Analogo a quanto descritto per il
								messaggio di richiesta. </para>
						</listitem>
					</itemizedlist>
				</para>
				<para><emphasis role="bold">Nota</emphasis>: Nel caso si utilizzi la validazione dei
					contenuti, basata su xsd o wsdl, è possibile che la struttura MTOM non sia stata
					prevista negli schemi e quindi faccia fallire l'esito della stessa. In questo
					caso, quando si attiva la validazione è necessario abilitare l'opzione
						<emphasis>Accetta MTOM/XOP-Message</emphasis> affinché il processo di
					validazione tenga conto del formato MTOM.</para>
				<note>
					<para> Nel caso di una fruizione, le opzioni di configurazione disponibili per
						la richiesta diventano quelle per la risposta e viceversa. </para>
				</note>
			</sect3>

			<sect3 id="gw-erogazione-registrazionemessaggi">
				<title>Registrazione Messaggi</title>
				<para> Nella <xref linkend="config-tracciamento"/> è possibile fornire le
					configurazioni per attivare il salvataggio dei messaggi in transito sul gateway.
					In questa sezione si ha la possibilità di ridefinire le opzioni di
					configurazione, stabilite a livello generale, al fine di personalizzare il
					servizio di registrazione dei messaggi per la specifica configurazione
					dell'erogazione/fruizione. </para>
				<para>Per la descrizione delle opzioni di configurazione si faccia riferimento alla
					sezione generale precedentemente indicata.</para>
			</sect3>

		</sect2>

	</sect1>

	<!-- ###################################################################### -->

	<!-- ###################################################################### -->

	<!-- #############                                      ################### -->

	<!-- #############                                      ################### -->

	<!-- #############               EDELIVERY              ################### -->

	<!-- #############                                      ################### -->

	<!-- ###################################################################### -->

	<!-- ###################################################################### -->

	<sect1 id="edelivery">
		<title>Il Profilo "eDelivery"</title>
		<para>In questa modalità operativa la govwayConsole consente di produrre configurazioni di
			scenari di interoperabilità che si basano sullo standard europeo eDelivery. Per rendere
			il trattamento dei messaggi conforme a tale standard, GovWay si interfaccia ad una
			installazione del software Domibus (<ulink
				url="https://ec.europa.eu/cefdigital/wiki/display/CEFDIGITAL/Domibus"
				>https://ec.europa.eu/cefdigital/wiki/display/CEFDIGITAL/Domibus</ulink>).</para>

		<para>Il processo di configurazione rimane strutturalmente analogo a quanto già descritto
			per la modalità API Gateway. Sono però presenti proprietà specifiche del contesto
			eDelivery i cui valori devono essere foriniti affinché il dialogo con l'access point
			Domibus possa essere realizzato correttamente.</para>
		<para>Nel seguito andiamo a descrivere i passi di configurazione evidenziando, per
			differenza con il caso API Gateway, gli elementi di eDelivery che dovranno essere
			gestiti. Al termine della configurazione è necessario procedere con l'export dei dati in
			formato <emphasis>PMODE</emphasis>. Il file prodotto è quello necessario per permettere
			la configurazione dell'access point Domibus.</para>

		<sect2 id="edev-preliminari">
			<title>Passi preliminari di configurazione</title>
			<para>Per gestire in maniera più semplice i passi di configurazione dei servizi
				eDelivery è consigliabile impostare l'opportuna modalità operativa della
				govwayConsole selezionando la voce <emphasis>eDelivery</emphasis> sul selettore di
				modalità presente nella testata dell'applicazione.</para>
			<para>Prima di procedere con la configurazione dei servizi si devono verificare i dati
				relativi ai soggetti interlocutori. Nel caso del soggetto interno al proprio
				dominio, i dati di configurazione possono essere gestiti alla sezione
					<emphasis>Configurazione > Generale</emphasis> (<xref
					linkend="edev-soggetto-baseurl"/>).</para>
			<figure id="edev-soggetto-baseurl">
				<title>Configurazione delle Base URL eDelivery per il soggetto interno</title>
				<mediaobject>
					<imageobject>
						<imagedata width="60%" fileref="FIGURE_OUT/edev-BaseURL-SoggettoInterno.pdf"
						/>
					</imageobject>
					<imageobject>
						<imagedata width="60%" fileref="FIGURE_OUT/edev-BaseURL-SoggettoInterno.png"
						/>
					</imageobject>
				</mediaobject>
			</figure>
			<para> Sono presenti valori iniziali, inseriti dal processo di installazione, che devono
				essere verificati ed eventualmente aggiornati: </para>
			<itemizedlist>
				<listitem>
					<para><emphasis>Base URL Erogazione</emphasis>: Indirizzo pubblico del Domibus
						per la ricezione dei messaggi sul canale eDelivery.</para>
				</listitem>
				<listitem>
					<para><emphasis>Base URL Fruizione</emphasis>: Indirizzo del servizio di GovWay
						riservato ai client per l'invio di messaggi sul canale eDelivery.</para>
				</listitem>
			</itemizedlist>
			<para> Tramite il collegamento <emphasis>Visualizza Dati Soggetto</emphasis> è possibile
				accedere alla conffigurazione del soggetto interno (<xref
					linkend="edev-soggetto-interno"/>).</para>
			<figure id="edev-soggetto-interno">
				<title>Configurazione delle proprietà eDelivery per il soggetto interno</title>
				<mediaobject>
					<imageobject>
						<imagedata width="60%" fileref="FIGURE_OUT/edev-DatiSoggettoInterno.pdf"/>
					</imageobject>
					<imageobject>
						<imagedata width="60%" fileref="FIGURE_OUT/edev-DatiSoggettoInterno.png"/>
					</imageobject>
				</mediaobject>
			</figure>
			<para> Le proprietà eDelivery da fornire sono le seguenti: </para>
			<itemizedlist>
				<listitem>
					<para><emphasis>Party Info - Id</emphasis>: Identificativo del soggetto
						utilizzato nel canale eDelivery.</para>
				</listitem>
				<listitem>
					<para><emphasis>Party Info - Type Name</emphasis>: Nome assegnato internamente
						allo schema indicato nel Type Value.</para>
				</listitem>
				<listitem>
					<para><emphasis>Party Info - Type Value</emphasis>: Schema di generazione
						riferito all'identificativo del soggetto eDelivery.</para>
				</listitem>
				<listitem>
					<para><emphasis>Party Endpoint - URL</emphasis>: Indirizzo pubblico del Domibus
						per la ricezione dei messaggi sul canale eDelivery.</para>
				</listitem>
				<listitem>
					<para><emphasis>Party Endpoint - Common Name</emphasis>: Valore della omonima
						proprietà del certificato utilizzato dall'access point Domibus cui
						afferisce. Questo nome coincide con quello dell'access point.</para>
				</listitem>
			</itemizedlist>
		</sect2>
		<sect2 id="edev-erogazione">
			<title>Erogazione di servizi in modalità eDelivery</title>
			<para>Configurare un'erogazione eDelivery permette ad un'applicazione interna di
				ricevere i messaggi inviati da un generico access point eDelivery esterno.</para>
			<para>Il primo passo di configurazione prevede che venga censito il soggetto esterno
				mittente dei messaggi. La creazione di tale soggetto si realizza dalla sezione
					<emphasis>Registro > Soggetti</emphasis> della govwayConsole, impostando le
				proprietà eDelivery già descritte nella sezione precedente per il soggetto
				interno.</para>
			<para>Il passo successivo è quello di registrare le API corrispondenti al servizio
				eDelivery alla sezione <emphasis>Registro > API</emphasis>. Le proprietà eDelivery,
				presenti nel form di creazione, sono quelle mostrate in <xref linkend="edev-api-fig"
				/>.</para>
			<figure id="edev-api-fig">
				<title>Registrazione API eDelivery - Proprietà specifiche</title>
				<mediaobject>
					<imageobject>
						<imagedata width="60%" fileref="FIGURE_OUT/edev-api-props.pdf"/>
					</imageobject>
					<imageobject>
						<imagedata width="60%" fileref="FIGURE_OUT/edev-api-props.png"/>
					</imageobject>
				</mediaobject>
			</figure>
			<para>Le proprietà da specificare sono le seguenti: <itemizedlist>
					<listitem>
						<para><emphasis>Service Info - Type</emphasis>: Identificativo assegnato
							come tipo del servizio (opzionale).</para>
					</listitem>
					<listitem>
						<para><emphasis>Service Info - Name</emphasis>: Nome del servizio.</para>
					</listitem>
					<listitem>
						<para><emphasis>Payload Profiles - File</emphasis>: Campo per l'upload del
							descrittore XML che rappresenta il formato dei messaggi inviati dal
							mittente. Campo opzionale, utilizzabile per aggiungere nuovi profili
							rispetto a quelli già presenti nell'installazione standard di Domibus.
							Per la specifica del formato XML da adottare si consulti la
							documentazione ufficiale di Domibus.</para>
					</listitem>
					<listitem>
						<para><emphasis>Properties - File</emphasis>: Campo per l'upload del
							descrittore XML che definisce le proprietà custom che saranno presenti
							nei messaggi inviati dal mittente. Campo opzionale, utilizzabile per
							aggiungere nuove property rispetto a quelle già presenti
							nell'installazione standard di Domibus. Per la specifica del formato XML
							da adottare si consulti la documentazione ufficiale di Domibus.</para>
					</listitem>
				</itemizedlist> Dopo aver effettuato il salvataggio è necessario completare la
				configurazione del servizio utilizzando il link presente nella colonna
					<emphasis>Risorse</emphasis> o <emphasis>Servizi</emphasis>, a seconda che si
				tratti di un servizio Rest o Soap, in corrispondenza dell'elemento presente
				nell'indice dei servizi. Per ciascuna delle azioni/risorse elencate per il servizio
				(o create, nel caso che, non disponendo del descrittore del servizio, si proceda con
				la configurazione manuale delle azioni), si accede al dettaglio per completare la
				configurazione delle proprerty eDelivery (<xref linkend="edev-api-azione"/>).
					<figure id="edev-api-azione">
					<title>Proprietà eDelivery relative alle azioni delle API</title>
					<mediaobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/edev-api-azione.pdf"/>
						</imageobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/edev-api-azione.png"/>
						</imageobject>
					</mediaobject>
				</figure> I valori da impostare nel form sono: <itemizedlist>
					<listitem>
						<para><emphasis>Action Info - Name</emphasis>: Nome dell'azione.</para>
					</listitem>
					<listitem>
						<para><emphasis>Payload - Profile</emphasis>: Payload Profile, tra quelli
							disponibili, da utilizzare per l'azione.</para>
					</listitem>
					<listitem>
						<para><emphasis>Payload - Compress</emphasis>: Indicare se l'invio del
							messaggio farà uso di compressione dei dati.</para>
					</listitem>
				</itemizedlist>
			</para>
			<para>Dopo aver creato l'API si procede con la configurazione dell'erogazione alla
				sezione <emphasis>Registro > Erogazioni</emphasis> della govwayConsole (<xref
					linkend="edev-erogazione-fig"/>). <figure id="edev-erogazione-fig">
					<title>Proprietà eDelivery relative all'erogazione del servizio</title>
					<mediaobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/edev-erogazione.pdf"/>
						</imageobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/edev-erogazione.png"/>
						</imageobject>
					</mediaobject>
				</figure> L'unica impostazione eDelivery da fornire in questo contesto è: <itemizedlist>
					<listitem>
						<para><emphasis>Security Profile</emphasis>: profilo di sicurezza adottato
							dagli access point durante la comunicazione. E' necessario scegliere tra
							i valori presenti, che corrispondono alle policy standard, già presenti
							in Domibus con l'installazione.</para>
					</listitem>
				</itemizedlist>
				<note>
					<para> L'endpoint fornito alla voce Connettore sarà quello utilizzato da GovWay
						per la consegna dei messaggi consegnati all'access point Domibus interno.
					</para>
				</note>
				<note>
					<para> Affinché le configurazioni apportate in modalità eDelivery possano essere
						attuate sull'access point Domibus è necessario procedere alla generazione
						del PMODE nel modo descritto alla <xref linkend="edev-pmode"/>
					</para>
				</note>
			</para>
		</sect2>
		<sect2 id="edev-fruizione">
			<title>Fruizione di servizi in modalità eDelivery</title>
			<para> Configurare una fruizione eDelivery permette ad un'applicazione interna di
				inviare messaggi da veicolare verso un generico access point eDelivery esterno. </para>
			<para> Il processo di configurazione della fruizione eDelivery prevede inizialmente i
				medesimi passi già descritti per l'erogazione al paragrafo <xref
					linkend="edev-erogazione"/>. Dovranno quindi essere configurati i dati eDelivery
				relativi ai soggetti interlocutori, interno ed esterno, dovranno inoltre essere
				censite le API relative al servizio da fruire. </para>
			<para> Dopo aver censito le API si procede con la configurazione della fruizione creando
				un nuovo elemento nella sezione <emphasis>Registro > Fruizioni</emphasis> della
				govwayConsole. Analogamente al caso dell'erogazione si dovrà selezionare la security
				policy necessaria per gli scambi tra gli access point. <note>
					<para>Affinché le configurazioni apportate in modalità eDelivery possano essere
						attuate sull'access point Domibus è necessario procedere alla generazione
						del PMODE nel modo descritto alla <xref linkend="edev-pmode"/></para>
				</note>
			</para>
		</sect2>
		<sect2 id="edev-pmode">
			<title>Generazione del PMODE Domibus</title>
			<para>Affinché il Domibus interno al proprio dominio sia in grado di recepire tutte le
				configurazioni prodotte nella modalità eDelivery, è necessario che gli venga fornito
				il relativo file PMODE, così come prevede la configurazione dell'access point
				eDelivery.</para>
			<para>Dopo aver ultimato le configurazioni dei servizi eDelivery, tramite la
				govwayConsole, si procede all'esportazione del PMODE effettuando i seguenti passaggi
					(<xref linkend="edev-pmode-fig"/>): <itemizedlist>
					<listitem>
						<para>Selezionare la voce di menu <emphasis>Configurazione >
								Esporta</emphasis>.</para>
					</listitem>
					<listitem>
						<para>Selezionare la tipologia archivio
							<emphasis>domibus-pmode</emphasis>.</para>
					</listitem>
					<listitem>
						<para>Premere il pulsante Invia e salvare il file XML che viene
							restituito.</para>
					</listitem>
					<listitem>
						<para>Effettuare l'upload del file ottenuto sulla Domibus Console.</para>
					</listitem>
				</itemizedlist>
				<figure id="edev-pmode-fig">
					<title>Esportazione del PMODE</title>
					<mediaobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/edev-pmode.pdf"/>
						</imageobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/edev-pmode.png"/>
						</imageobject>
					</mediaobject>
				</figure>
			</para>
		</sect2>
	</sect1>



	<!-- ###################################################################### -->

	<!-- ###################################################################### -->

	<!-- #############                                      ################### -->

	<!-- #############                                      ################### -->

	<!-- #############               SPCOOP                 ################### -->

	<!-- #############                                      ################### -->

	<!-- ###################################################################### -->

	<!-- ###################################################################### -->


	<sect1 id="spcoop">
		<title>Il Profilo "SPCoop"</title>
		<para>In questa modalità operativa la govwayConsole consente di produrre le configurazioni
			per i servizi SPCoop, in accordo alla specifica di cooperazione applicativa della PA
			italiana. I passi di configurazione, per erogazioni e fruizioni, presentano minime
			differenze rispetto a quanto descritto per la modalità API Gateway. Nel seguito saranno
			descritte tali differenze.</para>
		<sect2 id="spcoop-config">
			<title>Configurazione di un servizio SPCoop</title>
			<para>Il primo passaggio per la configurazione di un servizio SPCoop è quello di creare
				il relativo Accordo di Servizio. Questi viene creato registrando una nuova API
				(sezione <emphasis>Registro > API</emphasis>). Come illustrato nelle figura
				seguente, la particolarità di questa configurazione, rispetto a quanto descritto in
				precedenza, risiede nella presenza del campo <emphasis>Soggetto
				referente</emphasis>, nel quale deve essere selezionato uno dei soggetti
				precedentemente registrati. <figure id="accordoSPCoop">
					<title>Creazione Accordo di Servizio SPCoop</title>
					<mediaobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/AggiungiAccordoSPCoop.png"/>
						</imageobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/AggiungiAccordoSPCoop.pdf"/>
						</imageobject>
					</mediaobject>
				</figure>
			</para>
			<para>Se non viene fornito un WSDL, relativo all'accordo di servizio, è necessario
				definire manualmente l'interfaccia del servizio, analogamente a quanto descritto in
					<xref linkend="api-interfacce"/>. In questo caso, l'aggiunta del servizio,
				comprende i profili di collaborazione asincroni oltre alle caratteristiche
				aggiuntive specifiche del protocollo SPCoop (vedi <xref linkend="profiliEgov"/>). La
				figura seguente mostra i dettagli di questo caso. <figure id="portTypeSPCoop">
					<title>Aggiunta Servizio SPCoop</title>
					<mediaobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/AggiungiPortTypeSPCoop.png"/>
						</imageobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/AggiungiPortTypeSPCoop.pdf"/>
						</imageobject>
					</mediaobject>
				</figure>
			</para>
			<para> La registrazione di una nuova erogazione o fruizione, presenta le seguenti
				differenze rispetto a quanto descritto per la modalità API Gateway: <itemizedlist>
					<listitem>
						<para>È presente il campo <emphasis>Tipo</emphasis> relativamente al
							servizio</para>
					</listitem>
					<listitem>
						<para>È presente il campo <emphasis>Versione Protocollo</emphasis> per
							selezionare la versione della specifica SPCoop adottata.</para>
					</listitem>
				</itemizedlist>
				<figure id="erogazioneSPCoop">
					<title>Creazione erogazione SPCoop</title>
					<mediaobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/ErogazioneSPCoop.png"/>
						</imageobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/ErogazioneSPCoop.pdf"/>
						</imageobject>
					</mediaobject>
				</figure>
			</para>
		</sect2>
		<sect2 id="spcoopAsincroni">
			<title>Profili Asincroni</title>
			<para/>
			<sect3>
				<title>Profilo di Collaborazione Asincrono Simmetrico</title>
				<para> La registrazione di un profilo asincrono simmetrico prevede che vengano
					correlati tra di loro due azioni di due servizi differenti presenti all'interno
					del solito accordo di servizio parte comune (API). Di seguito un esempio di tale
					configurazione. <figure id="asCorrelazione">
						<title>Correlazione Asincrona Simmetrica</title>
						<mediaobject>
							<imageobject>
								<imagedata width="60%" fileref="FIGURE_OUT/asCorrelazione.png"/>
							</imageobject>
							<imageobject>
								<imagedata width="60%" fileref="FIGURE_OUT/asCorrelazione.pdf"/>
							</imageobject>
						</mediaobject>
					</figure>
				</para>
				<sect4>
					<title>Ruolo Fruitore</title>
					<para> Per poter fruire di un servizio con il profilo asincrono simmetrico la
						registrazione dell'applicativo fruitore deve prevedere, oltre alle normali
						configurazioni, la definizione di un connettore attraverso il quale la PdD
						consegnerà la risposta asincrona. Per definire tale connettore utilizzare la
						sezione 'Risposta Asincrona' presente nell'elenco degli applicativi
						relativamente al servizio desiderato.
						<!--
						<figure id="asSA">
							<title>Elenco dei Servizi Applicativi (Risposta Asincrona)</title>
							<mediaobject>
								<imageobject>
									<imagedata width="60%" fileref="FIGURE_OUT/asSA.jpg"/>
								</imageobject>
								<imageobject>
									<imagedata width="60%" fileref="FIGURE_OUT/asSA.pdf"/>
								</imageobject>
							</mediaobject>
						</figure> 
						Di seguito un esempio di configurazione della risposta asincrona.
							<figure id="asSA2">
							<title>Definizione del connettore per la Risposta Asincrona</title>
							<mediaobject>
								<imageobject>
									<imagedata width="60%" fileref="FIGURE_OUT/asSA2.jpg"/>
								</imageobject>
								<imageobject>
									<imagedata width="60%" fileref="FIGURE_OUT/asSA2.pdf"/>
								</imageobject>
							</mediaobject>
						</figure>
						-->
					</para>
				</sect4>
				<sect4>
					<title>Ruolo Erogatore</title>
					<para> Per poter erogare un servizio con il profilo asincrono simmetrico non
						sono richieste particolari configurazioni. Dovrà essere erogato il servizio
						relativo alla richiesta e fruito il servizio su cui inviare la risposta.
					</para>
				</sect4>
			</sect3>
			<sect3>
				<title>Profilo di Collaborazione Asincrono Asimmetrico</title>
				<para> La registrazione di un profilo asincrono asimmetrico prevede che vengano
					correlati tra di loro due azioni, normalmente di uno stesso servizio, presenti
					all'interno dell'accordo di servizio parte comune (API). Di seguito un esempio
					di tale configurazione. <figure id="aaCorrelazione">
						<title>Correlazione Asincrona Asimmetrica</title>
						<mediaobject>
							<imageobject>
								<imagedata width="60%" fileref="FIGURE_OUT/aaCorrelazione.png"/>
							</imageobject>
							<imageobject>
								<imagedata width="60%" fileref="FIGURE_OUT/aaCorrelazione.pdf"/>
							</imageobject>
						</mediaobject>
					</figure>
				</para>
				<sect4>
					<title>Ruolo Fruitore</title>
					<para> Per poter fruire un servizio con il profilo asincrono asimmetrico non
						sono richieste particolari configurazioni. Dovrà essere fruito il servizio
						su cui inviare la richiesta e richiedere l'esito della risposta. </para>
				</sect4>
				<sect4>
					<title>Ruolo Erogatore</title>
					<para> Per poter erogare un servizio con il profilo asincrono asimmetrico la
						registrazione del servizio applicativo erogatore deve prevedere, oltre alle
						normali configurazioni, la definizione di un connettore attraverso il quale
						la PdD consegnerà il messaggio contenente la richiesta dello stato
						dell'operazione (seconda fase del profilo asincrono asimmetrico). Per
						definire tale connettore utilizzare la sezione 'Risposta Asincrona' presente
						nell'elenco dei servizi applicativi relativamente al servizio desiderato.
						<!--	
						<figure id="aaSA">
							<title>Elenco dei Servizi Applicativi (Risposta Asincrona)</title>
							<mediaobject>
								<imageobject>
									<imagedata width="60%" fileref="FIGURE_OUT/aaSA.jpg"/>
								</imageobject>
								<imageobject>
									<imagedata width="60%" fileref="FIGURE_OUT/aaSA.pdf"/>
								</imageobject>
							</mediaobject>
						</figure> Di seguito un esempio di configurazione della risposta asincrona.
							<figure id="aaSA2">
							<title>Definizione del connettore per la Risposta Asincrona</title>
							<mediaobject>
								<imageobject>
									<imagedata width="60%" fileref="FIGURE_OUT/aaSA2.jpg"/>
								</imageobject>
								<imageobject>
									<imagedata width="60%" fileref="FIGURE_OUT/aaSA2.pdf"/>
								</imageobject>
							</mediaobject>
						</figure>
						-->
					</para>
				</sect4>
			</sect3>
		</sect2>

		<!--		<sect2 id="import_export_AS">
			<title>Importazione ed Esportazione degli Accordi di Servizio</title>
			<para> Gli accordi di servizio presenti nel registro possono essere importati ed
				esportati. Il formato dei package di importazione/esportazione è quello definito
				dalla specifica SPCoop (package SICA). </para>
			<para> Le entità importabili ed esportabili tramite i package sono: <orderedlist>
					<listitem>
						<para>Accordi di Servizio Parte Comune</para>
					</listitem>
					<listitem>
						<para>Accordi di Servizio Parte Specifica</para>
					</listitem>
					<listitem>
						<para>Accordi di Servizio Composto</para>
					</listitem>
					<listitem>
						<para>Accordi di Cooperazione</para>
					</listitem>
				</orderedlist>Per poter procedere all'importazione automatica è necessario disporre
				del package corrispondente. Per analogia con le entità gestite, le tipologie di
				package sono: <orderedlist>
					<listitem>
						<para><emphasis role="bold">APC</emphasis> (Accordi di Servizio Parte
							Comune)</para>
					</listitem>
					<listitem>
						<para><emphasis role="bold">APS</emphasis> (Accordi di Servizio Parte
							Specifica)</para>
					</listitem>
					<listitem>
						<para><emphasis role="bold">SC</emphasis> (Accordi di Servizio
							Composto)</para>
					</listitem>
					<listitem>
						<para><emphasis role="bold">AC</emphasis> (Accordi di Cooperazione)</para>
					</listitem>
				</orderedlist> Analogamente sarà possibile procedere all'esportazione di tali
				package partendo dalla configurazione presente nel Registro Servizi. </para>
			<para> Per importare un package selezionare la voce <emphasis>Importa</emphasis> nel
				menu <emphasis>Configurazione</emphasis>. Si presenta il form riportato in <xref
					linkend="importExportAS_fig"/> dove è necessario effettuare le seguenti
				operazioni: <itemizedlist>
					<listitem>
						<para> Selezionare il protocollo "spcoop". </para>
					</listitem>
					<listitem>
						<para> Selezionare la tipologia di archivio. Scegliere "cnipa" se il package
							da importare è stato prodotto tramite il <emphasis>Client
								SICA</emphasis>, tool fornito tramite i canali ufficiali SICA.
							Scegliere "govway" se il package da importare è stato prodotto tramite
							esportazione con la govwayConsole di GovWay. </para>
					</listitem>
					<listitem>
						<para> Selezionare il tipo di entità che si vuole importare tra le 4 scelte
							(apc, aps, sc, ac) descritte sopra. </para>
					</listitem>
					<listitem>
						<para> Selezionare dal proprio filesystem il file corrispondente al package
							da importare. </para>
					</listitem>
				</itemizedlist>
				<figure id="importExportAS_fig">
					<title>Maschera di importazione di package</title>
					<mediaobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/ImportazioneAS.pdf"/>
						</imageobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/ImportazioneAS.jpg"/>
						</imageobject>
					</mediaobject>
				</figure> Durante la fase di caricamento del file e successiva importazione del
				package potrebbe accadere che le informazioni contenute nel package non siano
				sufficienti per il completamento del processo di importazione. In tal caso verranno
				mostrate all'utente alcune maschere per integrare i dati mancanti. </para>
			<para> Per esportare package partendo dalle configurazioni presenti nel proprio Registro
				Servizi sarà sufficiente selezionare le entità che si desidera esportare dalla lista
				che le elenca tramite l'apposito checkbox posto a fine riga. Dopo aver completato la
				selezione si preme il pulsante <emphasis role="bold">Esporta Selezionati</emphasis>
				per produrre l'archivio esportato. Se si seleziona più di una entità il risultato
				sarà la creazione di un archivio unico contenente tutti i package (uno per ciascuna
				entità). </para>
		</sect2>
-->
		<sect2 id="WSDL">
			<title>Interfacce WSDL (concettuale, logico ed implementativo)</title>

			<para>La specifica SPCoop prevede che nell'accordo di servizio siano specificati i
				documenti WSDL del servizio applicativo erogatore e, nel caso di profili di
				collaborazione asincroni asimmetrici, anche quelli del servizio applicativo
				correlato erogato dal soggetto fruitore.</para>

			<para>La <xref linkend="definizioneAccordo"/> riepiloga i documenti necessari alla
				descrizione formale di un accordo di servizio che possono essere associati agli
				accordi parte comune e specifica se viene utilizzata la modalità avanzata della
				console</para>

			<table id="definizioneAccordo">
				<title>Descrizione di un accordo di servizio</title>

				<tgroup align="left" cols="2" colsep="1" rowsep="1">
					<colspec colname="c1"/>

					<colspec colname="c2"/>

					<thead>
						<row>
							<entry>Nome Documento</entry>

							<entry>Accordo</entry>

						</row>
					</thead>

					<tbody>
						<row>
							<entry align="left" nameend="c2" namest="c1">
								<emphasis>Specifica delle Interfacce</emphasis>
							</entry>
						</row>

						<row>
							<entry>WSDL Definitorio</entry>

							<entry>Parte Comune</entry>
						</row>

						<row>
							<entry>WSDL Concettuale</entry>

							<entry>Parte Comune</entry>
						</row>

						<row>
							<entry>WSDL Logico Erogatore</entry>

							<entry>Parte Comune</entry>
						</row>

						<row>
							<entry>WSDL Logico Fruitore</entry>

							<entry>Parte Comune</entry>
						</row>


						<row>
							<entry align="left" nameend="c2" namest="c1">
								<emphasis>Specifica delle Implementazioni</emphasis>
							</entry>
						</row>

						<row>
							<entry>WSDL Implementativo Erogatore</entry>

							<entry>Parte Specifica</entry>
						</row>

						<row>
							<entry>WSDL Implementativo Fruitore</entry>

							<entry>Parte Specifica</entry>
						</row>
					</tbody>
				</tgroup>
			</table>
		</sect2>

		<sect2 id="profiliEgov">
			<title>Profili di gestione della busta eGov</title>

			<para>L'interfaccia <emphasis>completa</emphasis> fornisce la possibilità di
				fruire/erogare di servizi SPCoop che non seguono le Linee Guida 1.1 ma si basano sul
				documento e-Gov 1.1. Questa funzionalità è utile sia per backward compatibility in
				quei domini dove i servizi non sono ancora stati adeguati al profilo descritto nelle
				Linee Guida 1.1, sia per usufruire di servizi infrastrutturali quali
					<emphasis>consegna affidabile</emphasis>, <emphasis>consegna in
					ordine</emphasis>, <emphasis>conversazioni</emphasis> che non sono presenti nel
				profilo Linee Guida 1.1.</para>

			<formalpara>
				<title>Fruizione di un servizio</title>

				<para>Supponiamo di essere in un contesto dove vogliamo usufruire di un servizio
					erogato da un soggetto la cui PdD non è ancora stata adeguata a quanto descritto
					nelle Linee Guida 1.1. Per usufruire del servizio, il soggetto fruitore deve
					inviare buste conformi al profilo e-Gov 1.1, nonostante la propria porta di
					dominio sia già conforme alle Linee Guida 1.1. Per gestire tale contesto è
					possibile definire il soggetto erogatore con profilo
						<emphasis>eGov1.1</emphasis>. In un successivo momento, la PdD del soggetto
					erogatore può iniziare ad adeguarsi alle Linee Guida 1.1. Supponiamo che
					l'adeguamento sia incrementale, fornito per un servizio alla volta. Per
					usufruire dei servizi erogati da tale soggetto, con la giusta modalita (Linee
					Guida 1.1 o e-Gov 1.1) <emphasis>è possibile ridefinire il profilo di gestione
						all'interno del servizio</emphasis>.</para>
			</formalpara>

			<formalpara>
				<title>Erogazione di un servizio</title>

				<para>Poniamoci in un contesto in cui la Porta di Dominio eroga dei servizi che
					rispettano quanto descritto nelle Linee Guida 1.1. In questo contesto, i
					soggetti di PdD che non si sono ancora adeguate alle linee guida, non potrebbero
					usufruire dei servizi. La PdD può essere configurata, in modo da erogare i
					servizi, per questi soggetti, secondo il profilo <emphasis>eGov 1.1</emphasis>.
					Questa configurazione richiede che al soggetto fruitore venga associato un
					profilo <emphasis>eGov 1.1</emphasis>. In un successivo momento, la PdD di un
					soggetto fruitore può iniziare ad adeguarsi alle Linee Guida 1.1. Si creano
					quindi due situazioni di transizione dove devono coesistere entrambe le
					specifiche: <itemizedlist>
						<listitem>
							<para>Un soggetto fruisce per alcuni servizi erogati secondo le
								specidiche e-Gov1.1, per altri secondo le Linee Guida 1.1</para>
						</listitem>
						<listitem>
							<para>Uno o più fruitori accedono al un servizio erogato secondo le
								specidiche e-Gov1.1, altri secondo le Linee Guida 1.1</para>
						</listitem>
					</itemizedlist> In entrmabi i casi, per erogare il servizio con la giusta
					modalita (linee guida o e-gov 1.1) è <emphasis>possibile ridefinire il profilo
						di gestione impostandolo nella lista dei fruitori del
					servizio</emphasis>.</para>
			</formalpara>

			<sect3>
				<title>Profilo di gestione e-Gov 1.1</title>
				<para>Il documento delle linee guida ha deprecato alcune opzioni al fine di snellire
					la specifica. Per mantenere la conpatibilità con la vecchia versione viene
					sempre offerta la possibilità di specificare tali opzioni all'interno degli
					accordi di servizio. Tali funzionalità vengono impostate/validate all'interno
					della busta e-Gov solo se il servizio viene fruito/erogato con profilo
						<emphasis>eGov1.1</emphasis>.</para>

				<table>
					<title>Funzionalità eGov 1.1</title>
					<tgroup align="left" cols="3" colsep="1" rowsep="1">
						<colspec colname="c1"/>

						<colspec colname="c2"/>

						<colspec colname="c3"/>

						<thead>
							<row>
								<entry>Nome</entry>

								<entry>Default</entry>

								<entry>Funzionalità</entry>
							</row>
						</thead>

						<tbody>
							<row>
								<entry>Filtro duplicati</entry>

								<entry>true</entry>

								<entry>Funzionalità di filtro delle buste duplicate (Imposta
									l'attributo inoltro del profilo di trasmissione al valore
									EGOV_IT_ALPIUUNAVOLTA).</entry>
							</row>

							<row>
								<entry>Conferma Ricezione</entry>

								<entry>false</entry>

								<entry>Funzionalità di consegna affidabile delle buste spcoop
									attraverso l'utilizzo dei riscontri (Imposta l'attributo
									confermaRicezione del profilo di trasmissione al valore
									true).</entry>
							</row>

							<row>
								<entry>ID Collaborazione</entry>

								<entry>false</entry>

								<entry>Aggiunge un elemento Collaborazione alla busta (Diverse
									istanze di cooperazione possono essere correlate in un'unica
									conversazione).</entry>
							</row>

							<row>
								<entry>Consegna in ordine</entry>

								<entry>false</entry>

								<entry>Consegna in ordine delle buste (Richiede Filtro Duplicati e
									Conferma Ricezione)</entry>
							</row>

							<row>
								<entry>Scadenza</entry>

								<entry/>

								<entry>Assegna una scadenza temporale alla busta SPCoop</entry>
							</row>
						</tbody>
					</tgroup>
				</table>

				<para>Di seguito un esempio di creazione di un accordo di servizio che richiede
					consegna affidabile tramite riscontri, filtro duplicati e id di collaborazione
					per un servizio sincrono.</para>

				<figure>
					<title>Controlli avanzati sulle informazioni eGov relative all'accordo di
						servizio</title>

					<mediaobject>
						<imageobject>
							<imagedata width="60%"
								fileref="FIGURE_OUT/funzionalitaEGovDeprecate.pdf"/>
						</imageobject>

						<imageobject>
							<imagedata width="60%"
								fileref="FIGURE_OUT/funzionalitaEGovDeprecate.jpg"/>
						</imageobject>
					</mediaobject>
				</figure>
			</sect3>
		</sect2>
	</sect1>

	<!-- ###################################################################### -->

	<!-- ###################################################################### -->

	<!-- #############                                      ################### -->

	<!-- #############                                      ################### -->

	<!-- #############       FATTURAZIONE ELETTRONICA       ################### -->

	<!-- #############                                      ################### -->

	<!-- ###################################################################### -->

	<!-- ###################################################################### -->

	<sect1 id="sdi">
		<title>Il Profilo "FatturaPA"</title>
		<para> Il profilo "FatturaPA" consente di utilizzare GovWay come nodo di interconnessione al
			Sistema di Interscambio (SdI), responsabile della gestione dei flussi di fatturazione
			elettronica. </para>
		<para> GovWay supporta la connessione al SdI attraverso lo scenario di interoperabilità su
			rete Internet basato sull'accesso al servizio <emphasis>SdICoop</emphasis>. Il servizio
			SdICoop prevede un protocollo di comunicazione, basato su SOAP, che veicola messaggi
			(fatture, archivi, notifiche e metadati) secondo la codifica dettata dalle specifiche
			tecniche (Per dettagli in merito si faccia riferimento alle <ulink
				url="http://www.fatturapa.gov.it/export/fatturazione/sdi/Specifiche_tecniche_SdI_v1.6.pdf"
				>Specifiche Tecniche SdI</ulink>). </para>
		<para> Il profilo FatturaPA di GovWay consente, ai sistemi di gestione delle fatture di un
			ente, di non occuparsi della gestione del formato di scambio, previsto dal SdI,
			mantenendo un grado di interfacciamento notevolmente semplificato. Più in dettaglio: <itemizedlist>
				<listitem>
					<para> I gestionali dell'ente, registrati come applicativi su GovWay,
						inviano/ricevono le fatture e le notifiche, previste dal colloquio, nel
						formato originario XML senza ulteriori complessità. </para>
				</listitem>
				<listitem>
					<para> I metadati presenti nelle comunicazioni con il SdI vengono estratti ed
						elaborati da GovWay e trasmessi ai gestionali dell'ente tramite appositi
							<emphasis>Header di Integrazione SdI</emphasis>. </para>
				</listitem>
				<listitem>
					<para> La produzione dei metadati SdI, nel caso delle comunicazioni in uscita
						(fatturazione attiva), è a carico di GovWay che provvede anche a generare
						gli identificativi univoci da associare ai messaggi da trasmettere al SdI.
					</para>
				</listitem>
			</itemizedlist>
		</para>
		<para> Per la produzione delle configurazioni necessarie a rendere operativo GovWay sono
			stati realizzati due wizard che guidano l'utente verso il corretto inserimento dei dati
			necessari. Gli scenari di configurazione supportati sono due e riguardano i casi della
				<emphasis>Fatturazione Passiva</emphasis> e <emphasis>Fatturazione
			Attiva</emphasis>. </para>
		<sect2 id="fatturazionePassiva">
			<title>Fatturazione Passiva</title>
			<para> Nello scenario di fatturazione passiva si utilizza GovWay per la ricezione delle
				fatture in arrivo dal SdI. GovWay attua la decodifica del messaggio SdI ricevuto, al
				fine di estrarre i file fattura in esso contenuti e trasmetterli, nel formato
				FatturaPA, all'applicativo registrato come destinatario. </para>
			<para> Lo scenario complessivo, relativo alla Fatturazione Passiva, è quello illustrato
				in <xref linkend="fatturazionePassiva-fig"/>. <figure id="fatturazionePassiva-fig">
					<title>Scenario di interoperabilità relativo alla Fatturazione Passiva</title>
					<mediaobject>
						<imageobject>
							<imagedata width="80%"
								fileref="FIGURE_OUT/Govway-FatturazionePassiva.pdf"/>
						</imageobject>
						<imageobject>
							<imagedata width="80%"
								fileref="FIGURE_OUT/Govway-FatturazionePassiva.jpg"/>
						</imageobject>
					</mediaobject>
				</figure> Descriviamo per punti i passi significativi di questo scenario: <itemizedlist>
					<listitem>
						<para>
							<emphasis>Servizio Ricezione Fatture</emphasis>. Per consentire a GovWay
							di consegnare le fatture ricevute dal SdI è necessario esporre un
							servizio i cui riferimenti per l'accesso dovranno essere configurati nel
							contesto del <emphasis>Connettore RicezioneFatture</emphasis>, presente
							nella configurazione di GovWay. </para>
						<para> Le fatture vengono ricevute da GovWay formato codificato dal
							protocollo SdI, e comprendono il lotto delle fatture, con i relativi
							allegati, e un insieme di metadati che descrivono il contesto di
							invocazione. GovWay si occupa di estrarre le informazioni presenti,
							elaborando il messaggio SdI, provvedendo quindi a consegnare il lotto di
							fatture al servizio destinatario, nel formato
								<emphasis>FatturaPA</emphasis> attraverso l'invocazione di una HTTP
							POST. I metadati raccolti dal messaggio SdI vengono forniti, nel
							contesto della medesima richiesta, sotto forma di HTTP Headers (fare
							riferimento alla <xref linkend="headerRicezioneFattura"/>). </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Client Invio Notifica EC</emphasis>. I sistemi dell'ente, dopo
							aver ricevuto le fatture, inviano le <emphasis>Notifiche di Esito
								Committente</emphasis>, previste dal protocollo SdI, utilizzando un
							apposito servizio di GovWay. La URL di invocazione di tale servizio sarà
							disponibile al termine del processo di configurazione descritto più
							avanti. GovWay provvede a codificare il messaggio SdI di richiesta
							contenente il messaggio di notifica ricevuto dall'applicativo mittente.
							I metadati prodotti per il messaggio SdI, unitamente all'identificativo
							messaggio univoco generato, vengono restituiti all'applicativo mittente
							sotto forma di HTTP Headers (fare riferimento alla <xref
								linkend="headerNotificaEC"/>). </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Servizio Ricezione NDT</emphasis>. Per consentire a GovWay di
							consegnare le eventuali <emphasis>Notifiche di Decorrenza
								Termini</emphasis> è necessario esporre un servizio i cui
							riferimenti per l'accesso dovranno essere configurati nel contesto del
								<emphasis>Connettore NotificaDT</emphasis>, presente nella
							configurazione di GovWay. </para>
						<para> GovWay consegna le notifiche DT nel formato originale tramite una
							HTTP POST, includendo come HTTP Headers i metadati estratti dal
							messaggio SdI originariamente ricevuto (fare riferimento alla <xref
								linkend="headerRicezioneNotificaDT"/>). </para>
					</listitem>
				</itemizedlist>
			</para>
			<para>
				<table id="headerRicezioneFattura">
					<title>Header di Integrazione 'Ricezione Fattura</title>
					<tgroup align="left" cols="2" colsep="1" rowsep="1">
						<colspec colname="Header"/>
						<colspec colname="Descrizione"/>
						<thead>
							<row>
								<entry>Header</entry>
								<entry>Descrizione</entry>
							</row>
						</thead>
						<tbody>
							<row>
								<entry>GovWay-SDI-FormatoArchivioBase64</entry>
								<entry>Indica se il file fattura è codificato in formato
									Base64</entry>
							</row>
							<row>
								<entry>GovWay-SDI-FormatoArchivioInvioFattura</entry>
								<entry>Indica se è stata utilizzata la modalità di firma CAdES o
									XAdES (P7M o XML)</entry>
							</row>
							<row>
								<entry>GovWay-SDI-FormatoFatturaPA</entry>
								<entry>Indice di versione del formato FatturaPA adottato</entry>
							</row>
							<row>
								<entry>GovWay-SDI-IdentificativoSdI</entry>
								<entry>Identificativo assegnato dal SdI alla fattura</entry>
							</row>
							<row>
								<entry>GovWay-SDI-MessageId</entry>
								<entry>Identificativo assegnato alla fattura dall'ente
									trasmittente</entry>
							</row>
							<row>
								<entry>GovWay-SDI-NomeFile</entry>
								<entry>Nome del file fattura</entry>
							</row>
							<row>
								<entry>GovWay-SDI-NomeFileMetadati</entry>
								<entry>Nome del file di metadati</entry>
							</row>
							<row>
								<entry>GovWay-Transaction-ID</entry>
								<entry>Identificativo della transazione assegnato da GovWay</entry>
							</row>
						</tbody>
					</tgroup>
				</table>
				<table id="headerNotificaEC">
					<title>Header di Integrazione 'Invio Notifica EC'</title>
					<tgroup align="left" cols="2" colsep="1" rowsep="1">
						<colspec colname="Header"/>
						<colspec colname="Descrizione"/>
						<thead>
							<row>
								<entry>Header</entry>
								<entry>Descrizione</entry>
							</row>
						</thead>
						<tbody>
							<row>
								<entry>GovWay-Transaction-ID</entry>
								<entry>Identificativo della transazione assegnato da GovWay</entry>
							</row>
						</tbody>
					</tgroup>
				</table>
				<table id="headerRicezioneNotificaDT">
					<title>Header di Integrazione 'Ricezione Notifica DT'</title>
					<tgroup align="left" cols="2" colsep="1" rowsep="1">
						<colspec colname="Header"/>
						<colspec colname="Descrizione"/>
						<thead>
							<row>
								<entry>Header</entry>
								<entry>Descrizione</entry>
							</row>
						</thead>
						<tbody>
							<row>
								<entry>GovWay-SDI-IdentificativoSdI</entry>
								<entry>Identificativo assegnato dal SdI alla fattura</entry>
							</row>
							<row>
								<entry>GovWay-SDI-NomeFile</entry>
								<entry>Nome del file fattura</entry>
							</row>
							<row>
								<entry>GovWay-Transaction-ID</entry>
								<entry>Identificativo della transazione assegnato da GovWay</entry>
							</row>
						</tbody>
					</tgroup>
				</table>
			</para>
			<para> Per produrre le configurazioni necessarie all'utilizzo dello scenario di
				fatturazione passiva, è possibile utilizzare il wizard messo a disposizione per
				semplificare l'attività di configurazione di GovWay. I passi da eseguire sono i
				seguenti: <orderedlist>
					<listitem>
						<para> Scaricare il govlet per la fatturazione passiva al seguente
							indirizzo: <itemizedlist>
								<listitem>
									<para><ulink
											url="http://www.govway.org/govlets/fatturazione-passiva.zip"
										/></para>
								</listitem>
							</itemizedlist>
						</para>
					</listitem>
					<listitem>
						<para> Avviare il govlet posizionandosi sulla sezione
								<emphasis>Configurazione > Importa</emphasis> della GovWayConsole e
							selezionare il file appena scaricato come oggetto da importare. </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Soggetto SDI</emphasis>: al primo step del wizard viene
							richiesto di indicare, tra gli elementi presenti nella lista a discesa,
							il soggetto interno destinatario delle fatture. Si tratta di un soggetto
							appartenente al profilo "FatturaPA". </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Servizio SdIRiceviNotifica erogato dal Sistema di
								Interscambio</emphasis>: al secondo step viene richiesto di indicare
							la URL che corrisponde all'endpoint del servizio SdIRiceviNotifica,
							necessario per l'invio delle <emphasis>Notifiche di Esito
								Committente</emphasis>. <note>
								<para> il valore suggerito dalla maschera di configurazione del
									govlet fa riferimento alla url del sistema di produzione SDI. Se
									si vuole configurare un servizio di test è necessario cambiare
									tale valore ed impostare il riferimento all'ambiente di test
									SDI. I certificati, sia per l'ambiente di test che di
									produzione, devono essere stati inseriti nel truststore di
									GovWay dopo averli prelevati all'indirizzo <ulink
										url="http://www.fatturapa.gov.it/export/fatturazione/it/normativa/f-3.htm"
										>http://www.fatturapa.gov.it/export/fatturazione/it/normativa/f-3.htm</ulink>
								</para>
							</note>
						</para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Credenziali per accesso URL NotificaEsito</emphasis>: al terzo
							step viene richiesto di fornire il criterio di autenticazione utilizzato
							dall'applicativo per inviare la notifica di esito committente. </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Applicativo per consegna FatturaPA</emphasis>: al quarto step
							viene richiesto di fornire i dati di configurazione del connettore,
							utilizzato da GovWay per la consegna delle fatture. La configurazione
							del connettore comprende: endpoint, credenziali di autenticazione ed
							eventualmente i riferimenti del proxy. </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Applicativo per consegna NotificaDecorrenzaTermini</emphasis>:
							al quinto ed ultimo step viene richiesto di fornire i dati di
							configurazione del connettore, utilizzato da GovWay per la consegna
							della notifica di decorrenza termini. La configurazione del connettore
							comprende: endpoint, credenziali di autenticazione ed eventualmente i
							riferimenti del proxy. </para>
					</listitem>
				</orderedlist>
			</para>
			<sect3 id="ricezioneFatturazionePassiva">
				<title>Ricezione Fatture e Notifiche di Decorrenza Termini</title>
				<para> Allo SdI, per raggiunge il servizio di RicezioneFatture su Govway, dovrà
					essere comunicata la seguente URL:
					<screen>https://&lt;host-govway&lt;/govway/sdi/in/&lt;SoggettoSDI>/RicezioneFatture/v1</screen>
					Le fatture e le notifiche saranno consegnati all'applicativo dell'ente secondo
					le modalità specificate durante l'esecuzione del Govlet. In fase di consegna
					delle fatture e delle notifiche verranno generati rispettivamente gli header
					descritti nella tabella <xref linkend="headerRicezioneFattura"/> e nella tabella
						<xref linkend="headerRicezioneNotificaDT"/>. </para>
			</sect3>
			<sect3 id="invocazioneFatturazionePassiva">
				<title>Invio della Notifica di Esito Committente</title>
				<para> Per l'invio della Notifica di Esito Committente l'applicativo deve
					utilizzare: <itemizedlist>
						<listitem>
							<para>Una URL così composta:
								<screen>http://&lt;host-govway&gt;/govway/sdi/out/xml2soap/&lt;SoggettoSDI&gt;/CentroServiziFatturaPA/SdIRiceviNotifica/v1?NomeFile=&lt;NomeFileFattura&gt;&amp;IdentificativoSdI=&lt;identificativoSDI&gt;</screen>
								dove: <itemizedlist>
									<listitem>
										<para>
											<emphasis>host-govway</emphasis>: è l'hostname con cui è
											raggiungibile l'istanza di Govway. </para>
									</listitem>
									<listitem>
										<para>
											<emphasis>SoggettoSDI</emphasis>: il soggetto interno
											destinatario delle fatture, come configurato durante
											l'esecuzione del govlet di fatturazione passiva. </para>
									</listitem>
									<listitem>
										<para>
											<emphasis>NomeFileFattura</emphasis>: è il nome del file
											che contiene la fattura cui fa riferimento la notifica
											EC. </para>
									</listitem>
									<listitem>
										<para>
											<emphasis>identificativoSDI</emphasis>: è
											l'identificativo SDI che fa riferimento al lotto della
											fattura ricevuta. </para>
									</listitem>
								</itemizedlist>
							</para>
						</listitem>
						<listitem>
							<para>L'invocazione deve essere corredata dalle credenziali che sono
								state indicate durante la configurazione tramite il relativo govlet.
							</para>
						</listitem>
						<listitem>
							<para>Utilizzare l'header http <emphasis>Content-Type</emphasis>
								valorizzato con <emphasis>text/xml</emphasis> o
									<emphasis>application/xml</emphasis>
							</para>
						</listitem>
					</itemizedlist> Un esempio di invio di una fattura viene fornito tramite il
					seguente comando curl: <note>
						<title>Soggetto Interno al Dominio</title>
						<para>In questo esempio si suppone che il nome del soggetto (riferito
							precedentemente come <emphasis>SoggettoSDI</emphasis>) fornito durante
							la fase di installazione di GovWay sia <emphasis>Ente</emphasis>.</para>
					</note>
					<screen>curl -X POST -basic --user SdIRiceviNotifica:123456 \
--data-binary @IT01234567890_11111_EC_001.xml \
-H "Content-Type: application/xml" \
"http://127.0.0.1:8080/govway/sdi/out/xml2soap/Ente/CentroServiziFatturaPA/SdIRiceviNotifica/v1?NomeFile=IT01234567890_11111.xml&amp;IdentificativoSdI=345"</screen>
				</para>
			</sect3>
		</sect2>
		<sect2 id="fatturazioneAttiva">
			<title>Fatturazione Attiva</title>
			<para> Nello scenario di fatturazione attiva si utilizza GovWay per l'invio delle
				fatture al SdI. GovWay attua la codifica dei file ricevuti al fine di produrre un
				messaggio valido per l'invio al SdI. </para>
			<para> Lo scenario complessivo, relativo alla Fatturazione Attiva, è quello illustrato
				in <xref linkend="fatturazioneAttiva-fig"/>. <figure id="fatturazioneAttiva-fig">
					<title>Scenario di interoperabilità relativo alla Fatturazione Attiva</title>
					<mediaobject>
						<imageobject>
							<imagedata width="80%"
								fileref="FIGURE_OUT/Govway-FatturazioneAttiva.pdf"/>
						</imageobject>
						<imageobject>
							<imagedata width="80%"
								fileref="FIGURE_OUT/Govway-FatturazioneAttiva.jpg"/>
						</imageobject>
					</mediaobject>
				</figure> Descriviamo per punti i passi significativi di questo scenario: <itemizedlist>
					<listitem>
						<para>
							<emphasis>Client Trasmissione Fatture</emphasis>. I sistemi dell'ente
							possono trasmettere le fatture al SdI tramite un apposito servizio di
							ricezione di GovWay. La URL di invocazione di tale servizio sarà
							disponibile al termine del processo di configurazione dello scenario di
							fatturazione attiva descritto più avanti. Una volta ricevuta la fattura,
							nel formato previsto da FatturaPA, GovWay provvede a codificare il
							messaggio SdI di richiesta contenente la fattura da trasmettere. I
							metadati prodotti per il messaggio SdI, unitamente all'identificativo
							SdI, vengono restituiti all'applicativo mittente sotto forma di HTTP
							Headers (fare riferimento alla <xref linkend="headerInvioFattura"/>).
						</para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Servizio Ricezione Notifiche</emphasis>. I sistemi dell'ente
							devono esporre un servizio adibilito alla ricezione delle notifiche che
							il SdI invia successivamente alla trasmissione di una fattura. I
							riferimenti per l'accesso a tale servizio dovranno essere configurati
							nel contesto del <emphasis>Connettore NotificheSDI</emphasis>, presente
							nella configurazione di GovWay. </para>
						<para> GovWay consegna le notifiche, al servizio dell'ente, nel formato
							originale tramite una HTTP POST, includendo come HTTP Headers i metadati
							estratti dal messaggio SdI originariamente ricevuto (fare riferimento
							alla <xref linkend="headerRicezioneNotifiche"/>). </para>
					</listitem>
				</itemizedlist>
			</para>
			<para>
				<table id="headerInvioFattura">
					<title>Header di Integrazione 'Trasmissione Fatture'</title>
					<tgroup align="left" cols="2" colsep="1" rowsep="1">
						<colspec colname="Header"/>
						<colspec colname="Descrizione"/>
						<thead>
							<row>
								<entry>Header</entry>
								<entry>Descrizione</entry>
							</row>
						</thead>
						<tbody>
							<row>
								<entry>GovWay-SDI-IdentificativoSdI</entry>
								<entry>Identificativo assegnato dal SdI alla fattura</entry>
							</row>
							<row>
								<entry>GovWay-SDI-NomeFile</entry>
								<entry>Nome del file fattura</entry>
							</row>
							<row>
								<entry>GovWay-Transaction-ID</entry>
								<entry>Identificativo della transazione assegnato da GovWay</entry>
							</row>
						</tbody>
					</tgroup>
				</table>
				<table id="headerRicezioneNotifiche">
					<title>Header di Integrazione 'Ricezione Notifiche'</title>
					<tgroup align="left" cols="2" colsep="1" rowsep="1">
						<colspec colname="Header"/>
						<colspec colname="Descrizione"/>
						<thead>
							<row>
								<entry>Header</entry>
								<entry>Descrizione</entry>
							</row>
						</thead>
						<tbody>
							<row>
								<entry>GovWay-SDI-IdentificativoSdI</entry>
								<entry>Identificativo assegnato dal SdI alla fattura</entry>
							</row>
							<row>
								<entry>GovWay-SDI-NomeFile</entry>
								<entry>Nome del file fattura</entry>
							</row>
							<row>
								<entry>GovWay-Transaction-ID</entry>
								<entry>Identificativo della transazione assegnato da GovWay</entry>
							</row>
						</tbody>
					</tgroup>
				</table>
			</para>
			<para> Per produrre le configurazioni necessarie all'utilizzo dello scenario di
				fatturazione attiva, è possibile utilizzare il wizard messo a disposizione per
				semplificare l'attività di configurazione di GovWay. I passi da eseguire sono i
				seguenti: <orderedlist>
					<listitem>
						<para> Scaricare il govlet per la fatturazione attiva al seguente indirizzo <itemizedlist>
								<listitem>
									<para><ulink
											url="http://www.govway.org/govlets/fatturazione-attiva.zip"
										/></para>
								</listitem>
							</itemizedlist>
						</para>
					</listitem>
					<listitem>
						<para> Avviare il govlet posizionandosi sulla sezione
								<emphasis>Configurazione > Importa</emphasis> della GovWayConsole e
							selezionare il file appena scaricato come oggetto da importare. </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Soggetto SDI</emphasis>: al primo step viene richiesto di
							indicare, tra gli elementi presenti nella lista a discesa, il soggetto
							interno mittente delle fatture. Si tratta di un soggetto appartenente al
							profilo "FatturaPA". </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Servizio SdIRiceviFile erogato dal Sistema di
								Interscambio</emphasis>: al secondo step viene richiesto di indicare
							la URL che corrisponde all'endpoint del servizio SdIRiceviFile, erogato
							dal SdI per la trasmissione delle fatture. <note>
								<para> il valore suggerito dalla maschera di configurazione del
									govlet fa riferimento alla url del sistema di produzione SDI. Se
									si vuole configurare un servizio di test è necessario cambiare
									tale valore ed impostare il riferimento all'ambiente di test
									SDI. I certificati, sia per l'ambiente di test che di
									produzione, devono essere stati inseriti nel truststore di
									GovWay dopo averli prelevati all'indirizzo <ulink
										url="http://www.fatturapa.gov.it/export/fatturazione/it/normativa/f-3.htm"
										>http://www.fatturapa.gov.it/export/fatturazione/it/normativa/f-3.htm</ulink>
								</para>
							</note>
						</para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Credenziali per accesso URL RiceviFile</emphasis>: al terzo
							step viene richiesto di fornire il criterio di autenticazione utilizzato
							dall'applicativo per invocare la url del GovWay per la trasmissione
							delle fatture. </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Applicativo per consegna Notifiche</emphasis>: al quarto ed
							ultimo step viene richiesto di fornire i dati di configurazione del
							connettore, utilizzato da GovWay per la consegna delle notifiche inviate
							dal SdI, successivamente alla trasmissione di una determinata fattura.
							La configurazione del connettore comprende: endpoint, credenziali di
							autenticazione ed eventualmente i riferimenti del proxy. </para>
					</listitem>
				</orderedlist>
			</para>
			<sect3 id="invioFatturazioneAttiva">
				<title>Invio della fattura</title>
				<para> Per l'invio della fattura l'applicativo mittente deve utilizzare: <itemizedlist>
						<listitem>
							<para>Una URL così composta:
								<screen>http://&lt;host-govway&gt;/govway/sdi/out/xml2soap/&lt;SoggettoSDI&gt;/CentroServiziFatturaPA/SdIRiceviFile/v1?Versione=&lt;VersioneFatturaPA&gt;&amp;TipoFile=&lt;TipoFile&gt;&amp;IdPaese=&lt;IdPaese&gt;&amp;IdCodice=&lt;IdCodice&gt;</screen>
								dove: <itemizedlist>
									<listitem>
										<para>
											<emphasis>host-govway</emphasis>: è l'hostname con cui è
											raggiungibile l'istanza di Govway. </para>
									</listitem>
									<listitem>
										<para>
											<emphasis>SoggettoSDI</emphasis>: il soggetto interno al
											dominio come configurato durante l'esecuzione del govlet
											di fatturazione passiva. </para>
									</listitem>
									<listitem>
										<para>
											<emphasis>Versione</emphasis>: versione della fattura
											che si sta inviando: FPA12 (Fattura 1.2 per Pubbliche
											Amministrazione), FPR12 (Fattura 1.2 per Privati), SDI11
											e SDI10 (Fattura per Pubblica amministrazione versione
											1.1. e 1.0). </para>
									</listitem>
									<listitem>
										<para>
											<emphasis>TipoFile</emphasis>: tipo di fattura: XML
											(Fattura firmata XADES), P7M (Fattura firmata CADES) o
											ZIP (archivio di fatture). </para>
									</listitem>
									<listitem>
										<para>
											<emphasis>IdPaese e IdCodice</emphasis>: dati del
											trasmittente della fattura. </para>
									</listitem>
								</itemizedlist>
							</para>
						</listitem>
						<listitem>
							<para>L'invocazione deve essere corredata dalle credenziali che sono
								state indicate durante la configurazione tramite il relativo govlet.
							</para>
						</listitem>
						<listitem>
							<para>A seconda del tipo di fattura deve essere utilizzato il corretto
								header http <emphasis>Content-Type</emphasis>: <itemizedlist>
									<listitem>
										<para>XML: è possibile utilizzare
												<emphasis>text/xml</emphasis> o
												<emphasis>application/xml</emphasis></para>
									</listitem>
									<listitem>
										<para>P7M:
											<emphasis>application/pkcs7-mime</emphasis></para>
									</listitem>
									<listitem>
										<para>XML: <emphasis>application/zip</emphasis></para>
									</listitem>
								</itemizedlist>
							</para>
						</listitem>
					</itemizedlist> Un esempio di invio di una fattura viene fornito tramite il
					seguente comando curl: <note>
						<title>Soggetto Interno al Dominio</title>
						<para>In questo esempio si suppone che il nome del soggetto (riferito
							precedentemente come <emphasis>SoggettoSDI</emphasis>) fornito durante
							la fase di installazione di GovWay sia <emphasis>Ente</emphasis>.</para>
					</note>
					<screen>curl -X POST -basic --user SdIRiceviFile:123456 \
--data-binary @IT01234567890_11111.xml.p7m \
-H "Content-Type: application/pkcs7-mime" \
"http://127.0.0.1:8080/govway/sdi/out/xml2soap/Ente/CentroServiziFatturaPA/SdIRiceviFile/v1?Versione=SDI10&amp;TipoFile=P7M&amp;IdPaese=IT&amp;IdCodice=01629370097"</screen>
				</para>
			</sect3>
			<sect3 id="ricezioneFatturazioneAttiva">
				<title>Ricezione delle Notifiche dallo Sdi</title>
				<para>Allo Sdi dovrà essere comunicata la seguente url che utilizzerà per inoltrare
					le notifiche:
					<screen>https://&lt;host-govway&lt;/govway/sdi/in/&lt;SoggettoSDI>/TrasmissioneFatture/v1</screen>
					Le notifiche ricevute verranno consegnate secondo le modalità specificate
					durante l'esecuzione del Govlet. In fase di consegna verranno generati gli
					header descritti nella tabella <xref linkend="headerRicezioneNotifiche"/>
				</para>
			</sect3>
		</sect2>

	</sect1>


	<sect1 id="strumenti">
		<title>Strumenti</title>
		<para> </para>
		<sect2 id="strumenti-runtime">
			<title>Runtime</title>
			<para> Questa sezione consente di visualizzare dati in tempo reale relativi al contesto
				di esecuzione del gateway, con la possibilità di effettuare alcune modifiche di
				stato. Le informazioni presenti sono: <itemizedlist>
					<listitem>
						<para>
							<emphasis>Runtime</emphasis>: <itemizedlist>
								<listitem>
									<para>
										<emphasis>Download</emphasis>: consente di effettuare il
										download di un file di testo che contiene tutti i parametri
										visualizzati nella pagina. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis>ResetAllCaches</emphasis>: consente di effettuare
										il reset contemporaneo di tutte le cache utilizzate dal
										gateway. </para>
								</listitem>
							</itemizedlist>
						</para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Informazioni Generali</emphasis>: Informazioni sul prodotto e
							sul software di base. </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Stato Servizi</emphasis>: Consente di abilitare/disabilitare
							in tempo reale i servizi per l'elaborazione delle richieste in ingresso
							intra ed extra dominio. </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Informazioni Diagnostica</emphasis>: Riferimenti ai file di
							log attivi per il prodotto, con la possibilità di modificare in tempo
							reale il livello di verbosità degli stessi. </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Informazioni Tracciamento</emphasis>: Riferimenti ai file
							contenenti il tracciamento delle richieste in elaborazione sul gateway,
							con la possibilità di abilitare/disabilitare le specifiche fonti.
						</para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Informazioni Database</emphasis>: Informazioni relative la
							piattaforma database adottata. </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Informazioni SSL</emphasis>: Informazioni sulla configurazione
							SSL. </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Informazioni Internazionalizzazione</emphasis>: Informazioni
							sulla configurazione del servizio di internazionalizzazione. </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Informazioni Timezone</emphasis>: Timezone attivo. </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Informazioni Java Networking</emphasis>: Parametri di
							configurazione inerenti la configurazione del networking a livello Java.
						</para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Informazioni Modalità Gateway</emphasis>: Contesti configurati
							per ciascuna specifica modalità operativa. </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Cache</emphasis>: Parametri di configurazione di tutte le
							cache adottate dal gateway, con la possibilità di effettuare il reset di
							ciascuna singolarmente. </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Connessioni Attive</emphasis>: Evidenza in tempo reale delle
							connessioni attive verso altri software a supporto (database, broker
							jms, ecc.) </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Transazioni Attive</emphasis>: Riferimenti alle transazioni in
							corso di elaborazione. </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Connessioni HTTP Attive</emphasis>: Evidenza in tempo reale
							delle connessioni HTTP, aperte in uscita, per l'elaborazione delle
							richieste in corso. </para>
					</listitem>
				</itemizedlist>
			</para>
		</sect2>

		<sect2 id="strumenti-auditing">
			<title>Auditing</title>

			<para>La funzionalità di <emphasis>auditing</emphasis> consente di tracciare il
				comportamento degli utenti della govwayConsole, al fine di verificare le operazioni
				eseguite e i loro effetti.</para>

			<para>Per gli aspetti di configurazione della funzionalità di auditing si rimanda alla
					<xref linkend="config-auditing"/>.</para>

			<para> In questa sezione descriviamo le interfacce della govwayConsole dedicate alla
				consultazione delle informazioni raccolte tramite il servizio di auditing. </para>

			<para> Gli utenti della govwayConsole aventi il permesso [A] Auditing (vedi <xref
					linkend="config-utenti"/>) hanno accesso alla funzionalità di consultazione dei
				dati presenti nel repository del servizio di auditing. </para>
			<para> Per accedere al servizio di consultazione selezionare la voce <emphasis
					role="bold">Auditing</emphasis> nella sezione <emphasis role="bold"
					>Reportistica</emphasis> del menu laterale sinistro. La consultazione dei dati
				di auditing avviene tramite ricerche effettuate impostando i criteri attraverso il
				form riportato in <xref linkend="auditSearchForm"/>. </para>
			<figure id="auditSearchForm">
				<title>Maschera di ricerca dei dati di auditing</title>

				<mediaobject>
					<imageobject>
						<imagedata width="60%" fileref="FIGURE_OUT/AuditingQuerySearch.pdf"/>
					</imageobject>

					<imageobject>
						<imagedata width="60%" fileref="FIGURE_OUT/AuditingQuerySearch.jpg"/>
					</imageobject>
				</mediaobject>
			</figure>
			<para> Vediamo adesso il significato dei parametri per la ricerca dei dati di auditing: <itemizedlist>
					<listitem>
						<para>
							<emphasis>Criteri di Ricerca</emphasis>
							<itemizedlist>
								<listitem>
									<para>
										<emphasis role="bold">Inizio Intervallo</emphasis>: Data
										iniziale che serve ad impostare l'intervallo temporale su
										cui restringere la ricerca dei dati di auditing. Lasciare il
										campo vuoto equivale all'impostazione
											<emphasis>illimitato</emphasis>. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis role="bold">Fine Intervallo</emphasis>: Data
										finale che serve ad impostare l'intervallo temporale su cui
										restringere la ricerca dei dati di auditing. Lasciare il
										campo vuoto equivale all'impostazione
											<emphasis>illimitato</emphasis>. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis role="bold">Utente</emphasis>: Consente di
										restringere la ricerca alle sole operazioni effettuate da un
										determinato utente. Il campo lasciato vuoto equivale a
											<emphasis>qualasiasi utente</emphasis>. </para>
								</listitem>
							</itemizedlist>
						</para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Operazione</emphasis>
							<itemizedlist>
								<listitem>
									<para>
										<emphasis role="bold">Tipo</emphasis>: Filtro per tipo di
										operazione, distinguendo tra: <itemizedlist>
											<listitem>
												<para>
												<emphasis>ADD</emphasis>: creazione di un'entità
												</para>
											</listitem>
											<listitem>
												<para>
												<emphasis>CHANGE</emphasis>: modifica di un'entità
												</para>
											</listitem>
											<listitem>
												<para>
												<emphasis>DEL</emphasis>: cancellazione di
												un'entità </para>
											</listitem>
											<listitem>
												<para>
												<emphasis>LOGIN</emphasis>: accesso alla
												govwayConsole </para>
											</listitem>
											<listitem>
												<para>
												<emphasis>LOGOUT</emphasis>: disconnessione dalla
												govwayConsole </para>
											</listitem>
										</itemizedlist>
									</para>
								</listitem>
								<listitem>
									<para>
										<emphasis role="bold">Stato</emphasis>: Filtro in base allo
										stato dell'operazione, distinguendo tra: <itemizedlist>
											<listitem>
												<para>
												<emphasis>requesting</emphasis>: in fase di
												richiesta </para>
											</listitem>
											<listitem>
												<para>
												<emphasis>error</emphasis>: terminata con errore
												</para>
											</listitem>
											<listitem>
												<para>
												<emphasis>completed</emphasis>: terminata
												correttamente </para>
											</listitem>
										</itemizedlist>
									</para>
								</listitem>
							</itemizedlist>
						</para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Oggetto</emphasis>
							<itemizedlist>
								<listitem>
									<para>
										<emphasis role="bold">Tipo</emphasis>: campo per restringere
										la ricerca alle sole operazioni riferite ad un determinato
										tipo di entità. Il campo è costituito da una lista a discesa
										popolata con tutte le tipologie di entità gestite dalla
										govwayConsole. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis role="bold">Identificativo</emphasis>: campo
										testuale per restringere la ricerca alle sole operazioni
										effettuate su una specifica entità. La composizione
										dell'identificativo cambia in base alla tipologia
										dell'entità. Ad esempio un soggetto è identificato
										attraverso il tipo e il nome: Tipo/NomeSoggetto. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis role="bold">Id precedente alla
										modifica</emphasis>: campo testuale analogo al precedente ma
										utile in quei casi in cui l'operazione che si sta cercando
										ha modificato i dati che compongono l'identificativo.
									</para>
								</listitem>
								<listitem>
									<para>
										<emphasis role="bold">Contenuto</emphasis>: pattern per la
										ricerca sul contenuto dell'entità associata all'operazione.
										Per utilizzare questo criterio di filtro il servizio di
										auditing deve essere configurato in modo da effettuare il
										dump degli oggetti. </para>
								</listitem>
							</itemizedlist>
						</para>
					</listitem>
				</itemizedlist> Una volta effettuata la ricerca viene mostrata una pagina con la
				lista dei risultati corrispondenti (vedi <xref linkend="auditSearchResult"/>).
					<figure id="auditSearchResult">
					<title>Risultato della ricerca dei dati di auditing</title>
					<mediaobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/AuditingQueryResult.pdf"/>
						</imageobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/AuditingQueryResult.jpg"/>
						</imageobject>
					</mediaobject>
				</figure> Ciascun elemento della lista riporta i dati principali che identificano
				l'operazione. Selezionando l'identificatore dell'operazione si visualizzano i dati
				di dettaglio (vedi <xref linkend="auditSearchDetail"/>). Dal dettaglio
				dell'operazione, se è attivo il dump, si può visualizzare il dettaglio dell'entità
				coinvolta nell'operazione e gli eventuali documenti binari (ad esempio i file WSDL
				associati ad un accordo di servizio). <figure id="auditSearchDetail">
					<title>Dettaglio di una traccia di auditing</title>
					<mediaobject>
						<imageobject>
							<imagedata width="50%" fileref="FIGURE_OUT/AuditingQueryDetail.pdf"/>
						</imageobject>
						<imageobject>
							<imagedata width="50%" fileref="FIGURE_OUT/AuditingQueryDetail.jpg"/>
						</imageobject>
					</mediaobject>
				</figure>
			</para>
		</sect2>
	</sect1>


	<sect1 id="configurazione">
		<title>Configurazione</title>
		<para>Nella sezione del menu <emphasis>Configurazione</emphasis> si raggiungono le
			funzionalità per modificare i parametri di configurazione del gateway.</para>
		<sect2 id="config-generale">
			<title>Generale</title>
			<para> La sezione <emphasis>Configurazione > Generale</emphasis> consente di impostare i
				parametri generali per le funzionalità di base del gateway (<xref
					linkend="config-generale-fig"/>). In particolare è possibile: <itemizedlist>
					<listitem>
						<para> Attivare e configurare la modalità Multi-Tenant. Abilitando questa
							modalità sarà ammessa la creazione di ulteriori soggetti interni al
							dominio GovWay. </para>
					</listitem>
					<listitem>
						<para> Configurare i profili fornendo i riferimenti ai servizi di base per
							l'elaborazione dei messaggi ed al soggetto interno </para>
					</listitem>
					<listitem>
						<para> Configurare la gestione del CORS (<emphasis>cross-origin HTTP request
								(CORS)</emphasis>) a livello globale valido per tutte le APIs
						</para>
					</listitem>
					<listitem>
						<para>Configurare il Caching Risposta a livello globale valido per tutte le
							APIs</para>
					</listitem>
				</itemizedlist>
				<figure id="config-generale-fig">
					<title>Maschera per l'impostazione dei parametri di configurazione
						generale</title>
					<mediaobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/ConfigurazioneGenerale.pdf"/>
						</imageobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/ConfigurazioneGenerale.png"/>
						</imageobject>
					</mediaobject>
				</figure>
			</para>
			<sect3>
				<title>Multi-Tenant</title>
				<para> Per abilitare la modalità multi-tenant è sufficiente selezionare il valore
					"abilitato" sull'elemento Stato. </para>
				<para> Dopo aver abilitato l'opzione multi-tenant è possibile creare nuovi soggetti
					interni al dominio, dalla <xref linkend="gw-erogazione-soggetti"/>. In questo
					contesto, i soggetti avranno come elemento distintivo il dominio, che può essere
						<emphasis>Interno</emphasis> o <emphasis>Esterno</emphasis>. </para>
				<para> I dettagli sulla configurazione dell'opzione multi-tenant sono riportati
					nella <xref linkend="multi-tenant"/>. </para>
			</sect3>
			<sect3>
				<title>Profili</title>
				<para> Per ciascuna delle modalità operative, attive sul gateway, è possibile
					specificare i seguenti parametri: <itemizedlist>
						<listitem>
							<para>
								<emphasis>Base URL Erogazione</emphasis>: Endpoint del servizio di
								ricezione delle richieste di erogazione supportate dal gateway.
							</para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Base URL Fruizione</emphasis>: Endpoint del servizio di
								ricezione delle richieste di fruizione supportate dal gateway.
							</para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Soggetto</emphasis>: Indicazione del soggetto interno che
								eroga/fruisce i servizi che fanno riferimento agli endpoint di cui
								sopra. Subito sotto il soggetto è presente un collegamento che porta
								al form di editing del soggetto visualizzato. </para>
						</listitem>
					</itemizedlist>
				</para>
			</sect3>
			<sect3 id="configurazione-cors">
				<title>Gestione CORS</title>
				<para>In GovWay è possibile abilitare la gestione del CORS (<emphasis>cross-origin
						HTTP request (CORS)</emphasis>) globalmente in modo che sia valido per tutte
					le APIs. </para>
				<para> La configurazione permette di specificare i seguenti parametri: <itemizedlist>
						<listitem>
							<para>
								<emphasis>Stato</emphasis>: Indicazione se la gestione del CORS è
								abilitata o meno globalmente su GovWay. </para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Tipo</emphasis>: Se la gestione del CORS è abilitata,
								questa può essere attuata da GovWay, tramite la configurazione di
								seguito descritta, o può essere demandata all'applicativo. </para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Access Control</emphasis>: tutti i parametri seguenti
								permettono di configurare il CORS. Per il dettaglio su cosa
								significa ogni singola voce si rimanda alla specifica CORS
									<emphasis>https://www.w3.org/TR/cors/</emphasis>. <itemizedlist>
									<listitem>
										<para><emphasis>All Allow Origins</emphasis>: se abilitato
											viene impostato nell'header http
											'Access-Control-Allow-Origin' il valore '*'</para>
									</listitem>
									<listitem>
										<para><emphasis>Allow Origins</emphasis>: nel caso non viene
											abilitato il parametro precedente, in questo campo è
											possibile indicare una lista di origin che vengono
											impostate nell'header http
											'Access-Control-Allow-Origin'</para>
									</listitem>
									<listitem>
										<para><emphasis>Allow Headers</emphasis>: nomi di header
											inseriti nell'header http
											'Access-Control-Allow-Headers'</para>
									</listitem>
									<listitem>
										<para><emphasis>Allow Methods</emphasis>: metodi inseriti
											nell'header http 'Access-Control-Allow-Methods'</para>
									</listitem>
									<listitem>
										<para><emphasis>Allow Credentials</emphasis>: se abilitato o
											disabilitato viene impostato relativemente il valore
											true o false nell'header
											'Access-Control-Allow-Credentials'</para>
									</listitem>
								</itemizedlist>
							</para>
						</listitem>
					</itemizedlist>
				</para>
				<figure id="config-generale-cors">
					<title>Maschera di configurazione generale del CORS</title>
					<mediaobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/ConfigurazioneCORS.pdf"/>
						</imageobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/ConfigurazioneCORS.png"/>
						</imageobject>
					</mediaobject>
				</figure>
			</sect3>
			<sect3 id="configurazione-response-caching">
				<title>Caching Risposta</title>
				<para>In GovWay è possibile abilitare il salvataggio delle risposte in una cache
					globalmente in modo che sia attivo per tutte le APIs. Questa funzionalità
					permette ad un backend server di non dover riprocessare le stesse richieste più
					volte. </para>
				<para> La configurazione permette di specificare i seguenti parametri: <itemizedlist>
						<listitem>
							<para>
								<emphasis>Stato</emphasis>: Indicazione se il salvataggio delle
								risposte in cache è abilitata o meno globalmente su GovWay. </para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Cache Timeout (secondi)</emphasis>: intervallo di tempo,
								definito in secondi, per il quale la risposta salvata in cache viene
								utilizzata come risposte a successive richieste di un client.
							</para>
						</listitem>
						<listitem>
							<para><emphasis>Dimensione Max Risposta</emphasis>: se abilitato deve
								essere definita la dimensione massima (in kb) che una risposta può
								avere per essere salvata in cache.</para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Generazione Hash</emphasis>: ad ogni risposta salvata in
								cache viene associato un valore hash calcolato rispetto ai dati
								della richiesta quali url di invocazione, header di trasporto e
								payload (se disponibile). E' possibile configurare quali parametri
								della richiesta utilizzare per generare il valore hash; per default
								vengono utilizzati tutti. </para>
						</listitem>
					</itemizedlist>
				</para>
				<figure id="config-generale-response-caching">
					<title>Maschera di configurazione per il Caching della Risposta</title>
					<mediaobject>
						<imageobject>
							<imagedata width="60%"
								fileref="FIGURE_OUT/ConfigurazioneCachingRisposta.pdf"/>
						</imageobject>
						<imageobject>
							<imagedata width="60%"
								fileref="FIGURE_OUT/ConfigurazioneCachingRisposta.png"/>
						</imageobject>
					</mediaobject>
				</figure>
			</sect3>
		</sect2>
		<sect2 id="config-tracciamento">
			<title>Tracciamento</title>
			<para> Accedendo la sezione <emphasis>Configurazione > Tracciamento</emphasis> si
				possono configurare i dettagli per la registrazione delle informazioni inerenti gli
				scambi sui servizi gestiti dal gateway. In particolare il gateway è in grado di
				memorizzare le seguenti tipologie di informazioni: <itemizedlist>
					<listitem>
						<para>
							<emphasis>Transazioni</emphasis>: tutte le proprietà inerenti il
							contesto di invocazione dei servizi (dati di indirizzamento, esito,
							tempi di elaborazione,...) </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Messaggi Diagnostici</emphasis>: tutte le informazioni
							necessarie per comprendere la fase di elaborazione delle richieste e
							indagare sulle anomalie occorse </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Messaggi Applicativi</emphasis>: salvataggio dei messaggi in
							transito sulle singole comunicazioni </para>
					</listitem>
				</itemizedlist>
			</para>
			<para> In <xref linkend="tracciamento-fig"/> è mostrata la pagina di configurazione del
				servizio di tracciamento. <figure id="tracciamento-fig">
					<title>Configurazione del servizio di tracciamento</title>
					<mediaobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/Tracciamento.pdf"/>
						</imageobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/Tracciamento.png"/>
						</imageobject>
					</mediaobject>
				</figure> Vediamo il significato delle sezioni di questa pagina: <itemizedlist>
					<listitem>
						<para>
							<emphasis>Transazioni Registrate</emphasis>: questa sezione consente di
							specificare quali transazioni memorizzare nell'archivio di monitoraggio
							in base all'esito rilevato in fase di elaborazione. Gli esiti sono
							suddivisi nei seguenti gruppi: Completate con successo, Fault
							applicativo, Fallite e Superamento Limite Richieste. Per ciascun esito è
							possibile abilitare o disabilitare la registrazione. È possibile
							inoltre, scegliendo l'opzione <emphasis>Personalizzato</emphasis>
							specificare puntualmente quali esiti di dettaglio includere. </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Messaggi Diagnostici</emphasis>: questa sezione consente di
							specificare il livello di verbosità dei messaggi diagnostici da
							generare. Si può distinguere il livello di verbosità per il salvataggio
							su <emphasis>Database</emphasis> e su <emphasis>File</emphasis>. </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Registrazione Messaggi</emphasis>: questa sezione consente di
							abilitare e configurare la registrazione dei messaggi in transito sul
							gateway durante l'elaborazione delle richieste e relative risposte. Una
							volta abilitata l'opzione si possono configurare i dettagli della
							funzionalità tramite il link <emphasis>Configurazione</emphasis>. </para>
						<para> Dalla sottosezione di configurazione si può distinguere il criterio
							di registrazione dei messaggi tra la Richiesta e la Risposta,
							abilitando/disabilitando solo la comunicazione desiderata. Sia per la
							Richiesta che per la Risposta, dopo aver optato per l'abilitazione della
							registrazione, si distingue tra: <itemizedlist>
								<listitem>
									<para>
										<emphasis>Ingresso</emphasis>: il messaggio di richiesta o
										risposta nel momento in cui giunge sul gateway e quindi
										prima che venga sottoposto al processo di elaborazione
										previsto. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis>Uscita</emphasis>: il messaggio di richiesta o
										risposta nel momento in cui esce dal gateway, per
										raggiungere il nodo successivo del flusso, e quindi dopo che
										è stato sottoposto al processo di elaborazione previsto.
									</para>
								</listitem>
							</itemizedlist>
						</para>
						<para> Per ciascuno dei messaggi, su cui è stata abilitata la registrazione,
							è possibile scegliere quale elemento viene registrato: <itemizedlist>
								<listitem>
									<para>
										<emphasis>Headers</emphasis>: vengono salvati gli header di
										trasporto (HTTP HEADERS) associati al messaggio. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis>Body</emphasis>: viene salvato il corpo del
										messaggio. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis>Attachments</emphasis>: vengono salvati gli
										eventuali attachments presenti nel messaggio. </para>
								</listitem>
							</itemizedlist>
						</para>
					</listitem>
				</itemizedlist>
				<note>
					<para> Le configurazioni effettuate in questa sezione della console hanno
						valenza globale e quindi rappresentano il comportamento di default adottato
						dal gateway nella gestione dei diversi flussi di comunicazione. Tale
						comportamento può essere ridefinito puntualmente su ogni singola
						erogazione/fruizione agendo sulla voce di configurazione
							<emphasis>Tracciamento</emphasis> in quel contesto.</para>
				</note>
			</para>
		</sect2>
		<sect2 id="config-controllotraffico">
			<title>Controllo del Traffico</title>
			<para> Accedendo la sezione <emphasis>Configurazione > Controllo del Traffico</emphasis>
				si possono impostare i parametri di configurazione relativamente alla fuzionalità
				che consente di stabilire le politiche di accesso alle risorse del gateway,
				nell'ottica di amministrare le risorse applicative a disposizione, ottimizzando le
				prestazioni e gestendo le situazioni di picco. <figure
					id="config-controllotraffico-fig">
					<title>Maschera per l'impostazione dei parametri di controllo del
						traffico</title>
					<mediaobject>
						<imageobject>
							<imagedata width="40%" fileref="FIGURE_OUT/ControlloTraffico.pdf"/>
						</imageobject>
						<imageobject>
							<imagedata width="40%" fileref="FIGURE_OUT/ControlloTraffico.png"/>
						</imageobject>
					</mediaobject>
				</figure> La configurazione della funzionalità di controllo del traffico (<xref
					linkend="config-controllotraffico-fig"/>) si compone dei seguenti gruppi di
				configurazioni: <itemizedlist>
					<listitem>
						<para>
							<emphasis>Limitazione Numero di Richieste Complessive</emphasis>:
							consente di fissare un numero limite, riguardo le richieste gestibili
							simultaneamente dal gateway, bloccando le richieste in eccesso. </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Controllo della Congestione</emphasis>: consente di attivare
							il rilevamento dello stato di congestionamento del gateway, in seguito
							al superamento di una determinata soglia relativamente alle richieste
							simultanee. </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Rate Limiting</emphasis>: sezione per l'impostazione di policy
							al fine di attivare strategie di controllo del traffico con criteri di
							selezione specifici della singola richiesta. </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Tempi Risposta</emphasis>: sezione per l'impostazione dei
							valori limite relativi ai tempi di risposta dei servizi, sia nei casi di
							erogazione che di fruizione. </para>
					</listitem>
				</itemizedlist> Le sezioni seguenti dettagliano questi elementi di configurazione. </para>
			<sect3 id="config-controllotraffico-maxlimit">
				<title>Limitazione Numero di Richieste Complessive</title>
				<para> Il primo livello di configurazione, presente nella pagina di accesso,
					consente di impostare i seguenti parametri: <itemizedlist>
						<listitem>
							<para>
								<emphasis>Stato</emphasis> (abilitato | disabilitato | warningOnly):
								Attiva il controllo sul numero di richieste simultanee in
								elaborazione. Selezionando l'opzione <emphasis>abilitato</emphasis>
								le richieste simultanee ricevute, che eccedono la soglia indicata
								(parametro <emphasis>MaxRichiesteSimultanee</emphasis>) verranno
								rifiutate restituendo al chiamante un errore. La tipologia di errore
								restituita è configurabile tramite l’elemento <emphasis>Tipologia
									Errore</emphasis> che appare solamente in caso di controllo
								abilitato. </para>
							<para> Il controllo sul numero di richieste simultanee in elaborazione
								può anche essere attivato in modalità
									<emphasis>WarningOnly</emphasis> dove, in caso il superamento
								della soglia, genera solamente un messaggio diagnostico di livello
									<emphasis>error</emphasis> e un evento che segnala l’accaduto.
							</para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Max Richieste Simultanee</emphasis>: Corrisponde al numero
								massimo di richieste simultanee accettate. In genere è possibile
								fornire un valore accurato dopo aver valutato la portata massima del
								prodotto installato, in base alle risorse hardware disponibili e ai
								parametri di dimensionamento delle risorse applicative (ad esempio:
								numero connessioni al database, dimensioni della memoria java, ecc). </para>
							<para> Al superamento di tale valore non verranno accettate ulteriori
								richieste concorrenti, che verranno quindi rifiutate. Al verificarsi
								di questa situazione il gateway emette un evento specifico. Queste
								transazioni vengono marcate con esito <emphasis>Superamento Limite
									Richieste</emphasis> e saranno registrate solamente se previsto
								dalla configurazione (per default non vengono registrate). Per i
								dettagli sulla configurazione delle transazioni da registrare in
								base all'esito consultare <xref linkend="config-tracciamento"/>.
							</para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Tipo Errore per API SOAP</emphasis> e <emphasis>Includi
									Descrizione Errore</emphasis> (Opzioni presenti solo con console
								in modalità avanzata): Imposta il tipo di errore restituito al
								chiamante nel caso di rifiuto dell'elaborazione per superamento
								della soglia del numero massimo di richieste simultanee. Le opzioni
								possibili sono le seguenti: <itemizedlist>
									<listitem>
										<para>
											<emphasis>Fault</emphasis>: viene generato un messaggio
											di Fault contenente un codice ed una descrizione
											dell’errore rilevato nel caso l’elemento
												<emphasis>Includi Descrizione Errore</emphasis> sia
											abilitato, o un codice di errore generico altrimenti.
										</para>
									</listitem>
									<listitem>
										<para>
											<emphasis>Http 429 (Too Many Requests)</emphasis>
										</para>
										<para>
											<emphasis>Http 503 (Service Unavailable)</emphasis>
										</para>
										<para>
											<emphasis>Http 500 (Internal Server Error)</emphasis>
										</para>
										<para> Viene generata una risposta HTTP con il codice
											selezionato, contenente una pagina html di errore, se
											l’elemento <emphasis>Includi Descrizione
												Errore</emphasis> è abilitato, o una risposta http
											vuota altrimenti. </para>
									</listitem>
								</itemizedlist>
							</para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Visualizza Informazioni Runtime</emphasis>: Selezionando
								questo collegamento si apre una pagina (<xref
									linkend="config-controllotraffico-runtime-fig"/>) che mostra in
								real-time le seguenti informazioni: <itemizedlist>
									<listitem>
										<para>
											<emphasis>Richieste Attive</emphasis>: il numero di
											richieste simultanee attualmente in corso di
											elaborazione. </para>
									</listitem>
									<listitem>
										<para>
											<emphasis>Stato Gateway</emphasis>: indica se il gateway
											ha raggiunto o meno lo stato di congestionamento, e
											quindi superata la soglia sul numero massimo di
											richieste simultanee. <note>
												<para>L'indicatore è attivo solo nel caso in cui lo
												stato della successiva opzione <emphasis>Controllo
												della Congestione</emphasis> sia abilitato.</para>
											</note>
										</para>
									</listitem>
									<listitem>
										<para>
											<emphasis>Refresh</emphasis>: collegamento che consente
											di aggiornare le informazioni presentate nello schermo.
										</para>
									</listitem>
								</itemizedlist>
								<figure id="config-controllotraffico-runtime-fig">
									<title>Dati di congestionamento in tempo reale</title>
									<mediaobject>
										<imageobject>
											<imagedata width="50%"
												fileref="FIGURE_OUT/ControlloTraffico-Runtime.pdf"/>
										</imageobject>
										<imageobject>
											<imagedata width="50%"
												fileref="FIGURE_OUT/ControlloTraffico-Runtime.png"/>
										</imageobject>
									</mediaobject>
								</figure>
							</para>
						</listitem>
					</itemizedlist>
				</para>
			</sect3>
			<sect3 id="config-controllotraffico-congestione">
				<title>Controllo della Congestione</title>
				<para> Questa sezione consente di impostare i parametri relativi al controllo della
					congestione. Sono disponibili le seguenti opzioni: <itemizedlist>
						<listitem>
							<para>
								<emphasis>Stato</emphasis> (abilitato | disabilitato): Attiva il
								controllo sul numero di richieste simultanee al fine di individuare
								lo stato di congestionamento. </para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Soglia di Attivazione (%)</emphasis>: Selezionando
								l'opzione <emphasis>abilitato</emphasis>, al passo precedente,
								questo elemento consente di indicare la soglia dello stato di
								congestionamento. La soglia da indicare è in percentuale rispetto al
								Numero Massimo Richieste Simultanee. Al superamento di tale soglia
								si entra nello stato di congestionamento conseguente emissione di un
								evento e un messaggio diagnostico al riguardo. </para>
						</listitem>
					</itemizedlist>
					<note>
						<para> Sulla base della percentuale indicata come soglia, una dicitura
							riporta nella pagina il valore di congestionamento calcolato in base al
							numero massimo di richieste simultanee. </para>
					</note>
					<figure id="config-controllotraffico-congestione-fig">
						<title>Configurazione della soglia di congestionamento</title>
						<mediaobject>
							<imageobject>
								<imagedata width="60%"
									fileref="FIGURE_OUT/ControlloTraffico-Congestione.pdf"/>
							</imageobject>
							<imageobject>
								<imagedata width="60%"
									fileref="FIGURE_OUT/ControlloTraffico-Congestione.png"/>
							</imageobject>
						</mediaobject>
					</figure>
				</para>
			</sect3>
			<sect3 id="config-controllotraffico-ratelimiting">
				<title>Rate Limiting</title>
				<para> Questa sezione consente di creare e attivare le policy di controllo del
					traffico. Gli elementi di configurazione presenti sono: <itemizedlist>
						<listitem>
							<para>
								<emphasis>Tipo Errore per API SOAP</emphasis> e <emphasis>Includi
									Descrizione Errore</emphasis> (Opzioni presenti solo con console
								in modalità avanzata): Imposta il tipo di errore restituito al
								chiamante nel caso venga rilevata una violazione delle policy
								configurate: <itemizedlist>
									<listitem>
										<para>
											<emphasis>Fault</emphasis>: viene generato un messaggio
											di Fault contenente un codice ed una descrizione
											dell’errore rilevato nel caso l’elemento
												<emphasis>Includi Descrizione Errore</emphasis> sia
											abilitato, o un codice di errore generico altrimenti.
										</para>
									</listitem>
									<listitem>
										<para>
											<emphasis>Http 429 (Too Many Requests)</emphasis>
										</para>
										<para>
											<emphasis>Http 503 (Service Unavailable)</emphasis>
										</para>
										<para>
											<emphasis>Http 500 (Internal Server Error)</emphasis>
										</para>
										<para> viene generata una risposta HTTP con il codice
											selezionato contenente una pagina html di errore se
											l’elemento <emphasis>Includi Descrizione
												Errore</emphasis> è abilitato, od una risposta http
											vuota altrimenti. </para>
									</listitem>
								</itemizedlist>
							</para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Registro Policy</emphasis>: Consente di accedere al
								Registro delle Policy per visualizzare, modificare e creare le
								policy di controllo istanziabili per la configurazione del rate
								limiting. Tra parentesi viene visualizzato il numero di policy
								attualmente presenti nel registro. Questa funzionalità è descritta
								nella <xref linkend="config-controllotraffico-registro-policy"/>.
							</para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Policy Globali</emphasis>: Consente di accedere al
								Registro delle Policy Attivate in ambito globale, cioè operative sul
								traffico complessivo che transita sul gateway. A queste policy si
								aggiungono quelle eventualmente definite localmente nella
								configurazione specifica di ciascuna erogazione/fruizione. </para>
							<para> Tra parentesi viene visualizzato il numero di policy attualmente
								attivate. Questa funzionalità è descritta nella <xref
									linkend="config-controllotraffico-policy"/>. </para>
						</listitem>
					</itemizedlist>
				</para>
				<sect4 id="config-controllotraffico-registro-policy">
					<title>Registro Policy</title>
					<para> Il Registro delle Policy è il repository dove si possono creare le policy
						di rate limiting che potranno essere successivamente istanziate. L'accesso
						alla sezione è possibile grazie all'omonimo collegamento presente nella
						sezione <emphasis>Rate Limiting</emphasis> della pagina principale del
						controllo del traffico. </para>
					<para> La pagina indice del Registro delle Policy mostra l'elenco delle policy
						già presenti (<xref linkend="config-controllotraffico-registropolicy-fig"
						/>). <figure id="config-controllotraffico-registropolicy-fig">
							<title>Elenco delle Policy di Rate Limiting presenti nel
								registro</title>
							<mediaobject>
								<imageobject>
									<imagedata width="60%"
										fileref="FIGURE_OUT/ControlloTraffico-RegistroPolicy-list.pdf"
									/>
								</imageobject>
								<imageobject>
									<imagedata width="60%"
										fileref="FIGURE_OUT/ControlloTraffico-RegistroPolicy-list.png"
									/>
								</imageobject>
							</mediaobject>
						</figure> Tramite il pulsante “Aggiungi” è possibile aprire la pagina di
						creazione di una policy di Rate Limiting (<xref
							linkend="config-controllotraffico-registropolicynew-fig"/>). <figure
							id="config-controllotraffico-registropolicynew-fig">
							<title>Maschera per la creazione di una policy di Rate Limiting</title>
							<mediaobject>
								<imageobject>
									<imagedata width="60%"
										fileref="FIGURE_OUT/ControlloTraffico-RegistroPolicy-new.pdf"
									/>
								</imageobject>
								<imageobject>
									<imagedata width="60%"
										fileref="FIGURE_OUT/ControlloTraffico-RegistroPolicy-new.png"
									/>
								</imageobject>
							</mediaobject>
						</figure> Descriviamo nel seguito i dati che è necessario inserire per la
						creazione di una policy. Si tenga presente che il sistema propone valori di
						default per alcuni campi; tali valori cambiano in base alle scelte operate
						sugli altri campi e possono essere considerati come “consigliati” in base
						alla combinazione di scelte attuate. <itemizedlist>
							<listitem>
								<para>
									<emphasis>Policy</emphasis>: In questa sezione sono presente i
									dati che identificano la policy. <itemizedlist>
										<listitem>
											<para>
												<emphasis>Nome</emphasis>: Nome assegnato alla
												policy. Finché il campo non viene modificato
												dall'utente, viene proposto automaticamente un nome
												espressivo sulla base delle scelte operate sui
												rimanenti elementi del form. </para>
										</listitem>
										<listitem>
											<para>
												<emphasis>Descrizione</emphasis>: Un testo di
												descrizione riferito alla policy. Finché il campo
												non viene modificato dall'utente, viene proposto un
												testo automatico di descrizione sulla base delle
												scelte operate sui rimanenti elementi del form.
											</para>
										</listitem>
										<listitem>
											<para>
												<emphasis>Risorsa</emphasis>: Si seleziona la
												risorsa che la policy deve monitorare al fine di
												attuare le eventuali restrizioni. Sono disponibili
												le seguenti risorse: <itemizedlist>
												<listitem>
												<para>
												<emphasis>NumeroRichieste</emphasis>: La policy
												effettua il controllo sul numero di richieste
												gestite. Selezionando questa risorsa si
												attiveranno i seguenti elementi per la
												configurazione dei valori di soglia: <itemizedlist>
												<listitem>
												<para>
												<emphasis>Simultanee</emphasis>
												</para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Modalità di Controllo</emphasis>
												</para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Numero Massimo di Richieste</emphasis>
												</para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Frequenza Intervallo
												Osservazione</emphasis>
												</para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Intervallo Osservazione</emphasis>
												</para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Finestra Osservazione</emphasis>
												</para>
												</listitem>
												<listitem>
												<para> Se si attiva l'opzione “Simultanee” l'unico
												campo visibile sarà: <emphasis>Numero Massimo di
												Richieste</emphasis>
												</para>
												</listitem>
												</itemizedlist>
												</para>
												</listitem>
												<listitem>
												<para>
												<emphasis>OccupazioneBanda</emphasis>: La policy
												effettua il controllo sulla banda occupata da e
												verso le comunicazioni con il gateway.
												Selezionando questa risorsa si attiveranno i
												seguenti elementi per la configurazione dei valori
												di soglia: <itemizedlist>
												<listitem>
												<para>
												<emphasis>Modalità di Controllo</emphasis>
												</para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Tipo Banda</emphasis>
												</para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Occupazione Massima di Banda
												(kb)</emphasis>
												</para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Frequenza Intervallo
												Osservazione</emphasis>
												</para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Intervallo Osservazione</emphasis>
												</para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Finestra Osservazione</emphasis>
												</para>
												</listitem>
												</itemizedlist>
												</para>
												</listitem>
												<listitem>
												<para>
												<emphasis>TempoComplessivioRisposta</emphasis>: La
												policy controlla la quantità di tempo
												complessivamente impiegata dal gateway per la
												ricezione delle risposte dai servizi invocati.
												Selezionando questa risorsa si attiveranno i
												seguenti elementi per la configurazione dei valori
												di soglia: <itemizedlist>
												<listitem>
												<para>
												<emphasis>Modalità di Controllo su Realtime (non
												modificabile)</emphasis>
												</para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Tipo Latenza</emphasis>
												</para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Occupazione Massima di Tempo
												(secondi)</emphasis>
												</para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Frequenza Intervallo
												Osservazione</emphasis>
												</para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Intervallo Osservazione</emphasis>
												</para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Finestra Osservazione</emphasis>
												</para>
												</listitem>
												</itemizedlist>
												</para>
												</listitem>
												<listitem>
												<para>
												<emphasis>TempoMedioRisposta</emphasis>: La policy
												controlla il tempo medio impiegato dal gateway per
												la ricezione delle risposte dai servizi invocati.
												Selezionando questa risorsa si attiveranno i
												seguenti elementi per la configurazione dei valori
												di soglia: <itemizedlist>
												<listitem>
												<para>
												<emphasis>Modalità di Controllo</emphasis>
												</para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Tipo Latenza</emphasis>
												</para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Tempo Medio Risposta (ms)</emphasis>
												</para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Frequenza Intervallo
												Osservazione</emphasis>
												</para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Intervallo Osservazione</emphasis>
												</para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Finestra Osservazione</emphasis>
												</para>
												</listitem>
												</itemizedlist>
												</para>
												</listitem>
												<listitem>
												<para>
												<emphasis>NumeroRichiesteCompletateConSuccesso</emphasis>
												</para>
												<para>
												<emphasis>NumeroRichiesteFallite</emphasis>
												</para>
												<para>
												<emphasis>NumeroFaultApplicativi</emphasis>
												</para>
												<para> La policy effettua il controllo sul numero
												di richieste gestite dal gateway e terminate con
												un esito che rientra nella casistica associata
												alla risorsa selezionata (completate con successo,
												fallite o fault applicativi). Selezionando questa
												risorsa si attiveranno i seguenti elementi per la
												configurazione dei valori di soglia: <itemizedlist>
												<listitem>
												<para>
												<emphasis>Modalità di Controllo</emphasis>
												</para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Numero Massimo di Richieste</emphasis>
												</para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Frequenza Intervallo
												Osservazione</emphasis>
												</para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Intervallo Osservazione</emphasis>
												</para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Finestra Osservazione</emphasis>
												</para>
												</listitem>
												</itemizedlist>
												</para>
												</listitem>
												</itemizedlist>
											</para>
										</listitem>
									</itemizedlist>
								</para>
							</listitem>
							<listitem>
								<para>
									<emphasis>Valori di Soglia</emphasis>: In questa sezione si
									specificano i valori di soglia (già anticipati al punto
									precedente), superati i quali, la policy risulta violata. Alcuni
									campi presenti in questa sezione cambiano in base alla risorsa
									monitorata. <itemizedlist>
										<listitem>
											<para>
												<emphasis>Simultanee</emphasis>: Questa opzione è
												presente solo per la risorsa “NumeroRichieste”.
												Attivandola si specifica che il criterio restrittivo
												entra in funzione al superamento di una soglia sul
												numero di richieste simultaneamente in gestione.
											</para>
										</listitem>
										<listitem>
											<para>
												<emphasis>Modalità di Controllo</emphasis>:
												Rappresenta la modalità di raccolta dei dati di
												traffico che saranno usati per la valutazione della
												policy. Si può scegliere tra le seguenti opzioni: <itemizedlist>
												<listitem>
												<para>
												<emphasis>Realtime</emphasis>: L'indicatore
												utilizzato per valutare la policy viene calcolato
												sulla base di dati raccolti in tempo reale durante
												l'elaborazione. Questa modalità assicura la
												massima accuratezza ma occorre tenere presenti le
												seguenti restrizioni nell'uso: <orderedlist>
												<listitem>
												<para> I dati “realtime” vengono raccolti in
												maniera separata sui singoli nodi del cluster.
												Quindi il controllo effettuato dalla policy
												riguarderà il traffico sul singolo nodo. </para>
												</listitem>
												<listitem>
												<para> Si possono impostare criteri di controllo
												su grana temporale piccola: secondi, minuti,
												orario, giornaliero. </para>
												</listitem>
												</orderedlist>
												</para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Statistica</emphasis>: L'indicatore
												utilizzato per valutare la policy viene calcolato
												sulla base delle informazioni statistiche presenti
												nel database di monitoraggio. L'accuratezza dei
												dati utilizzati per la valutazione è subordinata
												alla frequenza di aggiornamento dei dati
												statistici sul database. Inoltre tale modalità
												richiede il tracciamento delle transazioni sulle
												quali viene poi calcolata la statisticha (vedi
												<xref linkend="config-tracciamento"/>). In questa
												modalità: <orderedlist>
												<listitem>
												<para> L'indicatore utilizzato per il confronto
												con la soglia della policy è sempre complessivo
												rispetto a tutti i nodi del cluster. </para>
												</listitem>
												<listitem>
												<para> Si possono impostare criteri di controllo
												con grana temporale ampia: orario, giornaliero,
												settimanale, mensile. </para>
												</listitem>
												<listitem>
												<para> Si può utilizzare la tipologia “finestra
												scorrevole” come valore per la “Finestra
												Osservazione”, che descriveremo poco più avanti.
												</para>
												</listitem>
												</orderedlist>
												</para>
												</listitem>
												</itemizedlist>
											</para>
										</listitem>
										<listitem>
											<para>
												<emphasis>Numero Massimo di Richieste</emphasis>:
												Campo visibile solo per la risorsa monitorata
												“NumeroRichieste”. Consente di specificare la soglia
												per la policy. Quando il numero delle richieste,
												conteggiate secondo la logica specificata nella
												policy, supera questo valore, la policy risulta
												violata. </para>
										</listitem>
										<listitem>
											<para>
												<emphasis>Tipo Banda</emphasis>: Campo visibile solo
												per la risorsa monitorata “OccupazioneBanda”.
												Consente di specificare la modalità di calcolo della
												banda occupata per il confronto con la soglia
												impostata nella policy. Sono disponibili le seguenti
												opzioni: <itemizedlist>
												<listitem>
												<para>
												<emphasis>Banda Interna</emphasis>: Ai fini del
												conteggio dell'occupazione di banda (in KB) verrà
												considerato il solo traffico relativo alle
												comunicazioni con gli applicativi interni al
												dominio. </para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Banda Esterna</emphasis>: Ai fini del
												conteggio dell'occupazione di banda (in KB) verrà
												considerato il solo traffico relativo alle
												comunicazioni con i servizi esterni al dominio.
												</para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Banda Complessiva</emphasis>: Ai fini
												del conteggio dell'occupazione di banda (in KB)
												verrà considerato tutto il traffico in entrata ed
												uscita sul gateway. </para>
												</listitem>
												</itemizedlist>
											</para>
										</listitem>
										<listitem>
											<para>
												<emphasis>Occupazione Massima di Banda
												(kb)</emphasis>: Campo visibile solo per la
												risorsa monitorata “OccupazioneBanda”. Consente di
												specificare la soglia per la policy. Quando la
												banda, calcolata secondo la logica specificata nella
												policy, supera questo valore, la policy risulta
												violata. </para>
										</listitem>
										<listitem>
											<para>
												<emphasis>Tipo Latenza</emphasis>: Campo visibile
												solo per le risorse monitorate
												“TempoComplessivoRisposta” e “TempoMedioRisposta”.
												Consente di specificare la logica di calcolo del
												tempo di risposta sulla base delle due seguenti
												opzioni: <itemizedlist>
												<listitem>
												<para>
												<emphasis>Latenza Servizio</emphasis>: Per il
												calcolo del tempo di risposta si considera
												unicamente il tempo di attesa del gateway
												dall'invio della richiesta alla ricezione della
												risposta. </para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Latenza Totale</emphasis>: Per il
												calcolo del tempo di risposta si considera, oltre
												alla latenza del servizio, anche il tempo di
												elaborazione del gateway dal momento dell'ingresso
												della richiesta fino all'uscita della risposta.
												</para>
												</listitem>
												</itemizedlist>
											</para>
										</listitem>
										<listitem>
											<para>
												<emphasis>Occupazione Massima di Tempo
												(secondi)</emphasis>: Campo visibile solo per la
												risorsa monitorata “TempoComplessivoRisposta”.
												Consente di specificare la soglia per la policy.
												Quando la latenza complessiva, calcolata secondo la
												logica specificata nella policy, supera questo
												valore, la policy risulta violata. </para>
										</listitem>
										<listitem>
											<para>
												<emphasis>Tempo Medio Risposta (ms)</emphasis>:
												Campo visibile solo per la risorsa monitorata
												“TempoMedioRisposta”. Consente di specificare la
												soglia per la policy. Quando la latenza media,
												calcolata secondo la logica specificata nella
												policy, supera questo valore, la policy risulta
												violata. </para>
										</listitem>
										<listitem>
											<para>
												<emphasis>Frequenza Intervallo
												Osservazione</emphasis>
											</para>
											<para>
												<emphasis>Intervallo Osservazione</emphasis>
											</para>
											<para>
												<emphasis>Finestra Osservazione</emphasis>
											</para>
											<para> La composizione di questi 3 campi specifica in
												quale intervallo temporale devono essere selezionati
												i dati da utilizzare per calcolare l'indicatore che
												deve essere confrontato con la soglia della policy. </para>
											<para> I valori di “Frequenza Intervallo Osservazione” e
												“Intervallo Osservazione” specificano la frequenza
												di campionamento dei dati utilizzati per la
												valutazione delle soglie. In particolare il valore
												da specificare come Intervallo Osservazione è sempre
												un numero intero (ad esempio inserendo 8 si
												campioneranno i dati su finestre di 8 secondi, 8
												minuti, ecc, in base all'unità di misura indicata
												per la frequenza). Il valore selezionato come
												“Finestra Osservazione” individua l'esatto
												intervallo utilizzato nella catena temporale ogni
												volta che si valuta la policy per una specifica
												richiesta di servizio. </para>
											<para> Per comprendere la logica con cui viene calcolata
												la finestra di osservazione è necessario introdurre
												il concetto di Data Attivazione Policy. Si tratta
												della data in cui la policy è stata applicata ad una
												richiesta in transito sul gateway. A partire da
												questa data vengono calcolate le finestre di
												osservazione in base alla frequenza di campionamento
												selezionata. </para>
											<para> In Figura 8 è mostrato un confronto tra le
												diverse finestre di osservazione su un campionamento
												di 2 ore. La determinazione della finestra può
												essere analogamente trasposta su altre frequenze di
												campionamento. </para>
											<para> Riepilogando: <itemizedlist>
												<listitem>
												<para>
												<emphasis>Corrente</emphasis>: Indica che per il
												calcolo dell'indicatore saranno utilizzati i dati
												che rientrano nella finestra temporale in cui
												ricade la richiesta in esame. </para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Precedente</emphasis>: Indica che per il
												calcolo dell'indicatore saranno utilizzati i dati
												che rientrano nella finestra temporale precedente
												a quella in cui ricade la richiesta in esame.
												</para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Scorrevole (disponibile solo nella
												Modalità Controllo “Statistica”)</emphasis>:
												Indica che per il calcolo dell'indicatore saranno
												utilizzati i dati che rientrano in una finestra
												dinamica che ha come estremo superiore l'ora piena
												subito precedente all'istante della richiesta in
												fase di valutazione. </para>
												</listitem>
												</itemizedlist>
												<figure id="config-controllotraffico-finestre-fig">
												<title>Finestre di osservazione su un
												campionamento di 2 ore</title>
												<mediaobject>
												<imageobject>
												<imagedata width="60%"
												fileref="FIGURE_OUT/ControlloTraffico-Finestre.pdf"
												/>
												</imageobject>
												<imageobject>
												<imagedata width="60%"
												fileref="FIGURE_OUT/ControlloTraffico-Finestre.png"
												/>
												</imageobject>
												</mediaobject>
												</figure>
											</para>
										</listitem>
									</itemizedlist>
								</para>
							</listitem>
							<listitem>
								<para>
									<emphasis>Applicabilità</emphasis>: Questa sezione della policy
									consente di restringere l'applicabilità della policy sulla base
									di alcuni criteri (<xref
										linkend="config-controllotraffico-applicabilita-fig"/>).
									Sono presenti i seguenti campi: <itemizedlist>
										<listitem>
											<para>
												<emphasis>Condizionale</emphasis>: Se questa opzione
												non è attiva, la policy si applica in maniera
												incondizionata. Attivando l'opzione, la policy
												risulterà applicabile sulla base dei criteri
												specificati nei campi successivi. </para>
										</listitem>
										<listitem>
											<para>
												<emphasis>In presenza di Congestione del
												Traffico</emphasis>: Attivando questa opzione la
												policy risulta applicabile solo quando sussiste lo
												stato di congestionamento. Affinché questo evento
												venga rilevato è necessario che sia abilitato il
												“Controllo della Congestione”, descritto in
												precedenza, e che risulti superata la soglia
												impostata sul numero di richieste simultanee.
											</para>
										</listitem>
										<listitem>
											<para>
												<emphasis>In presenza di Degrado
												Prestazionale</emphasis>: Attivando questa
												opzione, la policy risulta applicabile solo in caso
												si rilevi un degrado prestazionale sullo specifico
												servizio corrispondente alla richiesta in gestione
												sul gateway. Per la rilevazione del degrado
												prestazionale si utilizzano le soglie “Tempo Medio
												di Risposta” impostate sia per le fruizioni che per
												le erogazioni. Come descritto in precedenza, tali
												soglie vengono definite per default nella sezione
												“Configurazione > Controllo del Traffico”, ma
												possono essere ridefinite al livello del singolo
												connettore. Per il calcolo del tempo medio di
												risposta del servizio, da confrontare con la soglia
												impostata, si utilizza il criterio definito con i
												campi seguenti: <itemizedlist>
												<listitem>
												<para>
												<emphasis>Modalità di Controllo</emphasis>
												</para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Tempo Medio Risposta</emphasis>
												</para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Frequenza Intervallo
												Osservazione</emphasis>
												</para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Intervallo Osservazione</emphasis>
												</para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Finestra Osservazione</emphasis>
												</para>
												</listitem>
												</itemizedlist> Per tutti questi campi valgono le
												medesime descrizioni già riportate nella sezione
												precedente “Valori di Soglia”. </para>
										</listitem>
									</itemizedlist>
									<figure id="config-controllotraffico-applicabilita-fig">
										<title>Opzioni per l'applicabilità di una policy di rate
											limiting</title>
										<mediaobject>
											<imageobject>
												<imagedata width="60%"
												fileref="FIGURE_OUT/ControlloTraffico-Applicabilita.pdf"
												/>
											</imageobject>
											<imageobject>
												<imagedata width="60%"
												fileref="FIGURE_OUT/ControlloTraffico-Applicabilita.png"
												/>
											</imageobject>
										</mediaobject>
									</figure>
									<note>
										<para> Se si selezionano più opzioni di applicabilità queste
											si considerano connesse secondo l'operatore logico AND.
										</para>
									</note>
								</para>
							</listitem>
						</itemizedlist>
					</para>
				</sect4>
				<sect4 id="config-controllotraffico-policy">
					<title>Policy</title>
					<para> Le policy di rate limiting vengono definite ed inserite nel Registro
						delle Policy secondo le modalità descritte nella sezione precedente. Le
						policy presenti nel Registro delle Policy non sono attive fino a quando non
						vengono istanziate. </para>
					<para> Dalla pagina <emphasis>Configurazione > Controllo del Traffico</emphasis>
						selezionare il collegamento <emphasis>Policy</emphasis>, nella sezione
							<emphasis>Rate Limiting</emphasis>, per accedere alle policy istanziate
							(<xref linkend="config-controllotraffico-policylist-fig"/>). <figure
							id="config-controllotraffico-policylist-fig">
							<title>Elenco delle policy di Rate Limiting attivate</title>
							<mediaobject>
								<imageobject>
									<imagedata width="60%"
										fileref="FIGURE_OUT/ControlloTraffico-Policy-list.pdf"/>
								</imageobject>
								<imageobject>
									<imagedata width="60%"
										fileref="FIGURE_OUT/ControlloTraffico-Policy-list.png"/>
								</imageobject>
							</mediaobject>
						</figure> La pagina indice delle Policy Istanziate mostra l'elenco delle
						istanze già presenti e i pulsanti per le operazioni CRUD. </para>
					<para> Tramite il pulsante <emphasis>Aggiungi</emphasis> è possibile aprire la
						pagina che contiene il form di creazione di una nuova istanza di policy
							(<xref linkend="config-controllotraffico-policynew-fig"/>). <figure
							id="config-controllotraffico-policynew-fig">
							<title>Creazione di una istanza relativa ad una policy di Rate
								Limiting</title>
							<mediaobject>
								<imageobject>
									<imagedata width="60%"
										fileref="FIGURE_OUT/ControlloTraffico-Policy-new.pdf"/>
								</imageobject>
								<imageobject>
									<imagedata width="60%"
										fileref="FIGURE_OUT/ControlloTraffico-Policy-new.png"/>
								</imageobject>
							</mediaobject>
						</figure>
					</para>
					<para> Dalla pagina di creazione dell'istanza di policy il primo passo è quello
						di selezionare la policy di origine tra quelle disponibili nel Registro
						delle Policy. Una volta selezionata la policy è visibile come il sistema
						assegni automaticamente un identificativo univoco per l'istanza e mostri
						quindi i rimanenti campi per completare la configurazione. Di seguito si
						descrivono in dettaglio tali sezione di configurazione. <itemizedlist>
							<listitem>
								<para>
									<emphasis>Policy</emphasis>: la policy da attivare. Si compone
									di: <itemizedlist>
										<listitem>
											<para>
												<emphasis>Identificativo</emphasis>: Identificativo
												univoco assegnato automaticamente all'istanza di
												policy. </para>
										</listitem>
										<listitem>
											<para>
												<emphasis>Policy</emphasis>: La policy su cui è
												basata l'istanza in fase di creazione. </para>
										</listitem>
										<listitem>
											<para>
												<emphasis>Nome</emphasis>: Opzionale. Permette di
												identificare l’istanza della policy tramite un nome
												alternativo all’identificativo assegnato
												automaticamente dal sistema. </para>
										</listitem>
										<listitem>
											<para>
												<emphasis>Descrizione</emphasis>: Il testo di
												descrizione della policy. </para>
										</listitem>
										<listitem>
											<para>
												<emphasis>Stato</emphasis>: Lo stato dell'istanza di
												policy una volta creata. Sono disponibili le
												seguenti opzioni: <itemizedlist>
												<listitem>
												<para>
												<emphasis>Abilitato</emphasis>: L'istanza di
												policy è abilitata. Questo significa che le
												violazioni rilevate saranno gestite in maniera
												restrittiva (negazione del servizio). </para>
												</listitem>
												<listitem>
												<para>
												<emphasis>WarningOnly</emphasis>: L'istanza di
												policy è abilitata in modalità WarningOnly. Questo
												significa che le violazioni rilevate saranno solo
												segnalate tramite messaggi diagnostici ma non ci
												saranno ripercussioni sull'elaborazione della
												richiesta. </para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Disabilitato</emphasis>: L'istanza di
												policy è disabilitata. </para>
												</listitem>
												</itemizedlist>
											</para>
										</listitem>
										<listitem>
											<para>
												<emphasis>Ridefinisci Valori di Soglia</emphasis>:
												Attivando questa opzione sarà possibile utilizzare
												una soglia per l'istanza di policy differente
												rispetto a quella prevista dalla policy d'origine.
											</para>
										</listitem>
									</itemizedlist>
								</para>
							</listitem>
							<listitem>
								<para>
									<emphasis>Filtro</emphasis>: Abilitando questa sezione
									dell'istanza di policy è possibile indicare i criteri per
									stabilire quali richieste, in entrata sul gateway, sono soggette
									alla policy che si sta istanziando. In assenza di filtro,
									l'istanza della policy sarà valutata su tutte le richieste in
									ingresso. </para>
								<para> Per la creazione del filtro sono disponibili i seguenti campi
										(<xref linkend="config-controllotraffico-filtro-fig"/>): <itemizedlist>
										<listitem>
											<para>
												<emphasis>Stato</emphasis>: Opzione per
												abilitare/disabilitare il filtro. </para>
										</listitem>
										<listitem>
											<para>
												<emphasis>Ruolo Gateway</emphasis>: Opzione per
												filtrare le richieste di servizio in base al ruolo
												ricoperto dal gateway nella specifica richiesta:
												Fruitore o Erogatore. </para>
										</listitem>
										<listitem>
											<para>
												<emphasis>Modalità</emphasis>: Opzione per filtrare
												le richieste di servizio in base alla modalità
												operativa. Nel caso si sia selezionata una singola
												modalità (o se il gateway supporta una sola
												modalità) viene visualizzato il valore attuale in
												modo non modificabile. </para>
										</listitem>
										<listitem>
											<para>
												<emphasis>Ruolo Erogatore</emphasis>: Opzione per
												filtrare le richieste di servizio in base al ruolo
												posseduto dal soggetto erogatore. Tramite la lista è
												possibile selezionare uno tra i ruoli censiti nel
												registro. La selezione di un ruolo esclude la
												possibilità di selezionare un soggetto erogatore.
											</para>
										</listitem>
										<listitem>
											<para>
												<emphasis>Soggetto Erogatore</emphasis>: Opzione per
												filtrare le richieste di servizio in base al
												soggetto erogatore. Tramite la lista è possibile
												selezionare uno tra i soggetti censiti nel registro.
												La selezione di un soggetto esclude la possibilità
												di selezionare un ruolo erogatore. </para>
										</listitem>
										<listitem>
											<para>
												<emphasis>Servizio</emphasis>: Opzione per filtrare
												le richieste di servizio in base al servizio
												invocato. Tramite la lista è possibile selezionare
												uno tra i servizi censiti nel registro. Se è stato
												selezionato un soggetto erogatore, saranno elencati
												solo i servizi da esso erogati. Analogamente, se è
												stata selezionata una modalità, saranno elencati
												solo i servizi appartenenti a quella modalità.
											</para>
										</listitem>
										<listitem>
											<para>
												<emphasis>Azione</emphasis>: Opzione per filtrare le
												richieste di servizio in base all'azione invocata.
												Tramite la lista è possibile selezionare una tra le
												azioni censite nel registro. Se è stato selezionato
												un servizio, saranno elencati solo le azioni ad esso
												appartenenti. </para>
										</listitem>
										<listitem>
											<para>
												<emphasis>Applicativo Erogatore</emphasis>: Opzione
												per filtrare le richieste di servizio in base
												all'applicativo erogatore (opzione non disponibile
												nel caso di una fruizione). Tramite la lista è
												possibile selezionare uno tra gli applicativi
												censiti nel registro. Se sono stati selezionati
												servizi e/o soggetti, la lista presentata sarà
												filtrata di conseguenza. </para>
										</listitem>
										<listitem>
											<para>
												<emphasis>Ruolo Fruitore</emphasis>: Opzione per
												filtrare le richieste di servizio in base al ruolo
												posseduto dal soggetto fruitore. Tramite la lista è
												possibile selezionare uno tra i ruoli censiti nel
												registro. La selezione di un ruolo esclude la
												possibilità di selezionare un soggetto fruitore.
											</para>
										</listitem>
										<listitem>
											<para>
												<emphasis>Soggetto Fruitore</emphasis>: Opzione per
												filtrare le richieste di servizio in base al
												soggetto fruitore. Tramite la lista è possibile
												selezionare uno tra i soggetti censiti nel registro.
												Se è stato selezionato un servizio, saranno elencati
												solo i soggetti fruitori del medesimo. La selezione
												di un soggetto esclude la possibilità di selezionare
												un ruolo fruitore. </para>
										</listitem>
										<listitem>
											<para>
												<emphasis>Applicativo Fruitore</emphasis>: Opzione
												per filtrare le richieste di servizio in base
												all'applicativo fruitore (opzione non disponibile
												nel caso di una erogazione). Tramite la lista è
												possibile selezionare uno tra i servizi applicativi
												censiti nel registro. Se sono stati selezionati
												servizi e/o soggetti, la lista presentata sarà
												filtrata di conseguenza. </para>
										</listitem>
										<listitem>
											<para>
												<emphasis>Filtro per Chiave</emphasis>: Si tratta di
												un'opzione avanzata che consente di filtrare le
												richieste in ingresso sul gateway base ad una chiave
												che può essere specificata in maniera personalizzata
												effettuando una delle seguenti scelte per il campo
												<emphasis>Tipologia</emphasis>: <itemizedlist>
												<listitem>
												<para>
												<emphasis>HeaderBased</emphasis>: Occorre fornire
												i dati “Nome” e “Valore”. La policy si applicherà
												soltanto alle richieste che hanno, nell'header di
												trasporto, una proprietà che corrisponde. </para>
												</listitem>
												<listitem>
												<para>
												<emphasis>URLBased</emphasis>: Occorre fornire i
												dati “Espressione Regolare” e “Valore”. La policy
												si applicherà soltanto alle richieste ove,
												applicando l'espressione regolare alla URL di
												invocazione, si ottiene un valore identico a
												quello fornito. </para>
												</listitem>
												<listitem>
												<para>
												<emphasis>FormBased</emphasis>: Occorre fornire i
												dati “Nome” e “Valore”. La policy si applicherà
												soltanto alle richieste che contengono nella query
												string un parametro corrispondente ai dati
												forniti. </para>
												</listitem>
												<listitem>
												<para>
												<emphasis>SOAPActionBased</emphasis>: Occorre
												fornire il dato “Valore”. + La policy si
												applicherà soltanto alle richieste che si
												presentano con una SOAPAction avente il valore
												fornito. </para>
												</listitem>
												<listitem>
												<para>
												<emphasis>ContentBased</emphasis>: Occorre fornire
												i dati “Espressione XPath” e “Valore”. La policy
												si applicherà soltanto alle richieste dove,
												applicando l'espressione XPath al messaggio di
												richiesta, si ottiene un valore identico a quello
												fornito. </para>
												</listitem>
												<listitem>
												<para>
												<emphasis>PluginBased</emphasis>: Occorre fonire i
												dati “Tipo Personalizzato” e “Valore”. Il
												parametro “Tipo Personalizzato” è una chiave,
												registrata nella configurazione, cui corrisponde
												una classe java che restituisce un valore da
												confrontare con quello fornito. Per realizzare un
												plugin con una logica di filtro personalizzata è
												necessario fornire un'implementazione della
												seguente interfaccia:
												<screen>
package org.openspcoop2.pdd.core.controllo_traffico.plugins; 
public interface IRateLimiting {
	public String estraiValoreFiltro(Logger log,Dati datiRichiesta) throws PluginsException;
	public String estraiValoreCollezionamentoDati(Logger log,Dati datiRichiesta) throws PluginsException;
}
</screen>
												La classe realizzata viene successivamente
												registrata tramite una entry nel file
												<emphasis>className.properties</emphasis> di
												GovWay:
												<screen>
org.openspcoop2.pdd.controlloTraffico.rateLimiting.test=&lt;fully qualified class name&gt;
</screen>
												La stringa &lt;nome&gt;, fornita in
												configurazione, diventa utilizzabile come “Tipo
												Personalizzato”. </para>
												</listitem>
												</itemizedlist>
												<note>
												<para> È possibile specificare più di un criterio
												di filtro; la logica applicata sarà quella
												dell'operatore AND. </para>
												</note>
											</para>
										</listitem>
									</itemizedlist>
									<figure id="config-controllotraffico-filtro-fig">
										<title>Definizione del filtro per l'istanza della policy di
											rate limiting</title>
										<mediaobject>
											<imageobject>
												<imagedata width="60%"
												fileref="FIGURE_OUT/ControlloTraffico-Filtro.pdf"
												/>
											</imageobject>
											<imageobject>
												<imagedata width="60%"
												fileref="FIGURE_OUT/ControlloTraffico-Filtro.png"
												/>
											</imageobject>
										</mediaobject>
									</figure>
								</para>
							</listitem>
							<listitem>
								<para>
									<emphasis>Criterio di Collezionamento dei Dati</emphasis>: In
									questa sezione è possibile attivare opzionalmente alcuni criteri
									per il raggruppamento dei dati utilizzati come indicatori di
									confronto per l'applicabilità della policy. Ad esempio se si è
									attivata una policy che limita a 20 il numero di richieste su
									una finestra di 5 minuti, significa che al raggiungimento della
									ventunesima richiesta, nella stessa finestra temporale, si
									otterrà una violazione della policy. </para>
								<para> Aggiungendo un criterio di collezionamento per Soggetto
									Erogatore, saranno conteggiate separatamente le richieste
									destinate ad ogni singolo soggetto erogatore. In questo caso la
									policy risulterà violata solo al raggiungimento della
									ventunesima richiesta, nella stessa finestra temporale,
									destinata al medesimo soggetto erogatore. </para>
								<para> È ammesso anche il raggruppamento su criteri multipli. La
									logica è del tutto analoga a quella dell'operatore GROUP BY del
									linguaggio SQL. </para>
								<para> I criteri di raggruppamento selezionabili sono (<xref
										linkend="config-controllotraffico-collezionamento-fig"/>): <itemizedlist>
										<listitem>
											<para>
												<emphasis>Ruolo (Fruitore/Erogatore)</emphasis>
											</para>
										</listitem>
										<listitem>
											<para>
												<emphasis>Soggetto Erogatore</emphasis>
											</para>
										</listitem>
										<listitem>
											<para>
												<emphasis>Servizio</emphasis>
											</para>
										</listitem>
										<listitem>
											<para>
												<emphasis>Azione</emphasis>
											</para>
										</listitem>
										<listitem>
											<para>
												<emphasis>Applicativo Erogatore</emphasis>
											</para>
										</listitem>
										<listitem>
											<para>
												<emphasis>Soggetto Fruitore</emphasis>
											</para>
										</listitem>
										<listitem>
											<para>
												<emphasis>Applicativo Fruitore</emphasis>
											</para>
										</listitem>
										<listitem>
											<para>
												<emphasis>Raggruppamento per Chiave</emphasis>: le
												richieste saranno raggruppate in base al valore di
												una chiave personalizzata il cui valore viene
												fornito secondo uno dei metodi selezionati tra i
												seguenti: <itemizedlist>
												<listitem>
												<para>
												<emphasis>HeaderBased</emphasis>: La chiave è
												presente nell'header di trasporto indicato nella
												proprietà "Nome". </para>
												</listitem>
												<listitem>
												<para>
												<emphasis>URLBased</emphasis>: La chiave è
												presente nella URL ricavandola tramite
												l'espressione regolare fornita nell'elemento
												seguente. </para>
												</listitem>
												<listitem>
												<para>
												<emphasis>FormBased</emphasis>: La chiave viene
												fornita in modalità Form Encoded con il parametro
												indicato nell'elemento "Nome". </para>
												</listitem>
												<listitem>
												<para>
												<emphasis>SOAPActionBased</emphasis>: La chiave
												corrisponde al valore della SoapAction. </para>
												</listitem>
												<listitem>
												<para>
												<emphasis>ContentBased</emphasis>: La chiave è
												presente nel body del messaggio e viene ricavata
												tramite il valore Xpath fornito nell'elemento
												seguente. </para>
												</listitem>
												<listitem>
												<para>
												<emphasis>PluginBased</emphasis>: La chiave viene
												restituita tramite l'esecuzione di una classe il
												cui nome viene fornito con il campo "Tipo
												Personalizzato" </para>
												</listitem>
												</itemizedlist>
											</para>
										</listitem>
									</itemizedlist>
									<figure id="config-controllotraffico-collezionamento-fig">
										<title>Definizione del filtro per l'istanza della policy di
											rate limiting</title>
										<mediaobject>
											<imageobject>
												<imagedata width="60%"
												fileref="FIGURE_OUT/ControlloTraffico-Collezionamento.pdf"
												/>
											</imageobject>
											<imageobject>
												<imagedata width="60%"
												fileref="FIGURE_OUT/ControlloTraffico-Collezionamento.png"
												/>
											</imageobject>
										</mediaobject>
									</figure>
								</para>
							</listitem>
						</itemizedlist>
					</para>
				</sect4>
				<sect4 id="config-controllotraffico-policy-stats">
					<title>Visualizzazione Statistiche Policy</title>
					<para> Quando una policy è attivata si ha la possibilità di accedere ad una
						finestra che fornisce una sintesi dei dati statistici legati
						all'applicazione della policy in fase di controllo del traffico. </para>
					<para> Per visualizzare questa finestra è sufficiente accedere all'elenco delle
						policy attivate ed utilizzare il collegamento “Visualizza” nella colonna
						“Runtime” (<xref linkend="config-controllotraffico-statistiche-fig"/>).
							<figure id="config-controllotraffico-statistiche-fig">
							<title>Dati statistici relativi ad una policy di rate limiting</title>
							<mediaobject>
								<imageobject>
									<imagedata width="60%"
										fileref="FIGURE_OUT/ControlloTraffico-StatistichePolicy.pdf"
									/>
								</imageobject>
								<imageobject>
									<imagedata width="60%"
										fileref="FIGURE_OUT/ControlloTraffico-StatistichePolicy.png"
									/>
								</imageobject>
							</mediaobject>
						</figure> Si noti che saranno visualizzati dei dati solo dopo la data di
						attivazione della policy e cioè dopo che è transitata la prima richiesta cui
						viene applicata la policy. </para>
					<para> I dati statistici riportati sono i seguenti: <itemizedlist>
							<listitem>
								<para>
									<emphasis>Criterio di Collezionamento dei dati</emphasis>: I
									criteri di raggruppamento utilizzati dalla policy. </para>
							</listitem>
							<listitem>
								<para>
									<emphasis>Dati Generali</emphasis>: <itemizedlist>
										<listitem>
											<para>
												<emphasis>Il numero istantaneo delle richieste
												attive</emphasis>
											</para>
										</listitem>
										<listitem>
											<para>
												<emphasis>la data di attivazione della policy (che
												corrisponde alla data di primo utilizzo della
												medesima)</emphasis>
											</para>
										</listitem>
									</itemizedlist>
								</para>
							</listitem>
							<listitem>
								<para>
									<emphasis>Dati collezionati per la risorsa
										&lt;nomeRisorsa&gt;</emphasis>: dati di sintesi sulle
									transazioni cui è stata applicata la policy. </para>
							</listitem>
						</itemizedlist>
					</para>
					<para> Sono inoltre disponibili i seguenti collegamenti: <itemizedlist>
							<listitem>
								<para>
									<emphasis>Refresh</emphasis>: per aggiornare i dati
									visualizzati. </para>
							</listitem>
							<listitem>
								<para>
									<emphasis>Reset Contatori</emphasis>: per azzerare i valori
									visualizzati (solo nella modalità di controllo realtime).
								</para>
							</listitem>
						</itemizedlist>
					</para>
				</sect4>
			</sect3>
			<sect3 id="config-controllotraffico-tempirisposta">
				<title>Tempi Risposta</title>
				<para> In questa sezione vengono indicati i valori limite di default riguardo i
					tempi di risposta dei servizi con cui il gateway interagisce durante
					l'elaborazione delle richieste. Nel caso delle erogazioni, si tratta dei tempi
					di risposta dei servizi interni, successivamente ad una richiesta di erogazione
					dall'esterno. Nel caso delle fruizioni, si tratta dei tempi di risposta dei
					servizi esterni, successivamente ad una richiesta di fruizione da parte di un
					client interno al dominio. I tempi configurabili sono: <itemizedlist>
						<listitem>
							<para>
								<emphasis>Connection Timeout (ms)</emphasis>: Intervallo di tempo
								atteso, sulle comunicazioni in uscita, prima di sollevare l'errore
								Connection Timeout (scadenza del tempo di attesa per stabilire una
								connessione). </para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Read Timeout (ms)</emphasis>: Intervallo di tempo atteso,
								dopo aver stabilito una connessione in uscita, prima di sollevare
								l'errore di Read Timeout (scadenza del tempo di attesa per ricevere
								il payload dall'interlocutore). </para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Tempo Medio di Risposta (ms)</emphasis>: Valore di soglia
								del tempo medio di risposta al fine di valutare la situazione di
									<emphasis>Degrado Prestazionale</emphasis>, condizione per
								l'applicabilità di eventuali politiche restrittive come documentate
								più avanti. </para>
						</listitem>
					</itemizedlist>
				</para>
			</sect3>
		</sect2>
		<sect2 id="TokenPolicy">
			<title>Token Policy</title>
			<para> Per poter definire politiche di controllo degli accessi basate sui Bearer Token è
				necessario creare delle Token Policy da riferire nelle configurazioni degli
				specifici servizi. La gestione delle Token Policy si effettua andando alla sezione
					<emphasis>Configurazione > Token Policy</emphasis> della govwayConsole. Per
				creare una nuova policy si utilizza il pulsante <emphasis>Aggiungi</emphasis>. Il
				form di creazione appare inizialmente come quello illustrato in <xref
					linkend="tokenpolicy-generale-fig"/>
				<figure id="tokenpolicy-generale-fig">
					<title>Informazioni generali di una Token Policy</title>
					<mediaobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/TokenPolicy-generale.pdf"/>
						</imageobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/TokenPolicy-generale.png"/>
						</imageobject>
					</mediaobject>
				</figure> Inizialmente si inseriscono i dati identificativi: <itemizedlist>
					<listitem>
						<para>
							<emphasis>Nome</emphasis>: nome univoco da assegnare alla policy </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Descrizione</emphasis>: testo di descrizione generale della
							policy </para>
					</listitem>
				</itemizedlist> Al passo successivo si inseriscono le Informazioni Generali. Nella
				sezione <emphasis>Token</emphasis> si specifica il tipo di token accettato e il
				metodo di passaggio: <itemizedlist>
					<listitem>
						<para>
							<emphasis>Posizione</emphasis>: indica la modalità di passaggio del
							token da parte dell'applicativo richiedente. I valori possibili sono: <itemizedlist>
								<listitem>
									<para>
										<emphasis>RFC 6750 - Bearer Token Usage</emphasis>: la
										modalità di passaggio del token è una qualsiasi delle tre
										previste dallo standard RFC 6750 (le tre opzioni successive
										a questa). </para>
								</listitem>
								<listitem>
									<para>
										<emphasis>RFC 6750 - Bearer Token Usage (Authorization
											Request Header Field)</emphasis>: la modalità di
										passaggio del token è quella che prevede l'inserimento
										nell'header "Authorization" del messaggio di richiesta. Ad
										esempio:
										<screen>
GET /resource HTTP/1.1
Host: server.example.com
Authorization: Bearer mF_9.B5f-4.1JqM
</screen>
									</para>
								</listitem>
								<listitem>
									<para>
										<emphasis>RFC 6750 - Bearer Token Usage (Form-Encoded Body
											Parameter)</emphasis>: la modalità di passaggio del
										token è quella di inserirlo nel body della richiesta,
										eseguita con una POST, utilizzando il parametro
											<emphasis>access_token</emphasis>, come ad esempio:
										<screen>
POST /resource HTTP/1.1
Host: server.example.com
Content-Type: application/x-www-form-urlencoded

access_token=mF_9.B5f-4.1JqM
</screen>
									</para>
								</listitem>
								<listitem>
									<para>
										<emphasis>RFC 6750 - Bearer Token Usage (URI Query
											Parameter)</emphasis>: la modalità di passaggio del
										token è quella di utilizzare il parametro
											<emphasis>access_token</emphasis> della Query String,
										come ad esempio:
										<screen>
GET /resource?access_token=mF_9.B5f-4.1JqM HTTP/1.1
Host: server.example.com
</screen>
									</para>
								</listitem>
								<listitem>
									<para>
										<emphasis>Header HTTP</emphasis>: la modalità di passaggio
										del token è quella di inserirlo in un header http custom, il
										cui nome deve essere fornito nel campo <emphasis>Nome Header
											Http</emphasis>, che appare di seguito. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis>Parametro URL</emphasis>: la modalità di passaggio
										del token è quella di inserirlo in un parametro custom della
										query string. Il nome del parametro deve essere fornito nel
										campo <emphasis>Nome Parametro URL</emphasis>, che appare di
										seguito. </para>
								</listitem>
							</itemizedlist>
						</para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Tipo</emphasis>: specifica il tipo di token che il gateway
							attende di ricevere. I valori possibili sono: <itemizedlist>
								<listitem>
									<para>
										<emphasis>JWS</emphasis>: un JSON Web Token di tipo
										"Signed". </para>
								</listitem>
								<listitem>
									<para>
										<emphasis>JWE</emphasis>: un JSON Web Token di tipo
										"Encrypt". </para>
								</listitem>
								<listitem>
									<para>
										<emphasis>Opaco</emphasis>: un generico token di tipo non
										specificato. </para>
								</listitem>
							</itemizedlist>
						</para>
					</listitem>
				</itemizedlist> Nella sezione <emphasis>Elaborazione Token</emphasis> si specificano
				le azioni che si possono compiere durante la fase di elaborazione del token
				ricevuto. Le opzioni disponibili sono: <itemizedlist>
					<listitem>
						<para>Validazione JWT</para>
					</listitem>
					<listitem>
						<para>Token Introspection</para>
					</listitem>
					<listitem>
						<para>OIDC - UserInfo</para>
					</listitem>
					<listitem>
						<para>Token Forward</para>
					</listitem>
				</itemizedlist> Le sezioni successive dettagliano questi elementi. </para>
			<sect3 id="validazioneJWT">
				<title>Validazione JWT</title>
				<para> Nel caso in cui il token sia di tipo JWT (quindi JWE o JWS), questa opzione
					attiva la validazione basata su tale standard (<xref
						linkend="validazionejwt-fig"/>). <figure id="validazionejwt-fig">
						<title>Dati di configurazione della validazione JWT</title>
						<mediaobject>
							<imageobject>
								<imagedata width="50%" fileref="FIGURE_OUT/ValidazioneJWT.pdf"/>
							</imageobject>
							<imageobject>
								<imagedata width="50%" fileref="FIGURE_OUT/ValidazioneJWT.png"/>
							</imageobject>
						</mediaobject>
					</figure> I dati da inserire sono: <itemizedlist>
						<listitem>
							<para>
								<emphasis>Claims Parser</emphasis>: indica il tipo di parser che
								deve essere utilizzato per la validazione del token JWT. I valori
								possibili sono: <itemizedlist>
									<listitem>
										<para>
											<emphasis>RFC 7519 - JSON Web Token</emphasis>
										</para>
									</listitem>
									<listitem>
										<para>
											<emphasis>OpenID Connect - ID Token</emphasis>
										</para>
									</listitem>
									<listitem>
										<para>
											<emphasis>Google - ID Token</emphasis>
										</para>
									</listitem>
									<listitem>
										<para>
											<emphasis>Personalizzato</emphasis>: nel caso del parser
											personalizzato occorre fornire il relativo ClassName
											della classe con la logica di parsing. </para>
									</listitem>
								</itemizedlist>
							</para>
						</listitem>
						<listitem>
							<para>
								<emphasis>KeyStore</emphasis>: I parametri di configurazione del
								keystore da utilizzare per il servizio di validazione. </para>
						</listitem>
					</itemizedlist>
				</para>
			</sect3>
			<sect3 id="tokenIntrospection">
				<title>Token Introspection</title>
				<para> Questa sezione consente di attivare la validazione del token ricevuto
					attraverso un servizio di Token Introspection i cui dati di accesso devono
					essere forniti in questo contesto (<xref linkend="tokenintrospection-fig"/>).
						<figure id="tokenintrospection-fig">
						<title>Dati di puntamento al servizio di Token Instrospection</title>
						<mediaobject>
							<imageobject>
								<imagedata width="50%" fileref="FIGURE_OUT/TokenIntrospection.pdf"/>
							</imageobject>
							<imageobject>
								<imagedata width="50%" fileref="FIGURE_OUT/TokenIntrospection.png"/>
							</imageobject>
						</mediaobject>
					</figure> Per il corretto puntamento al servizio di Token Introspection devono
					essere forniti in prima istanza i parametri generali legati all'endpoint
					riferito: <itemizedlist>
						<listitem>
							<para>
								<emphasis>Connection Timeout</emphasis>: Tempo massimo in
								millisecondi di attesa per stabilire una connessione con il server
								di validazione token. </para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Read Timeout</emphasis>: Tempo massimo in millisecondi di
								attesa per la ricezione di una risposta dal server di validazione
								token. </para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Https</emphasis>: Parametri di configurazione nel caso in
								cui il server di validazione token richieda un accesso Https.
							</para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Proxy</emphasis>: Parametri di configurazione nel caso in
								cui il server di validazione token richieda l'uso di un proxy per
								l'accesso. </para>
						</listitem>
					</itemizedlist> Successivamente devono essere forniti i dati di configurazione
					specifici del servizio di Token Introspection: <itemizedlist>
						<listitem>
							<para>
								<emphasis>Tipo</emphasis>: tipologia del servizio. A scelta tra i
								seguenti valori: <itemizedlist>
									<listitem>
										<para>
											<emphasis>RFC 7662 - Introspection</emphasis>: Servizio
											di introspection conforme allo standard RFC 7662.
											Richiede che vengano forniti i seguenti dati: <itemizedlist>
												<listitem>
												<para>
												<emphasis>URL</emphasis>: endpoint del servizio di
												introspection. </para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Autenticazione Http Basic</emphasis>:
												flag da attivare nel caso in cui il servizio di
												introspection richieda autenticazione di tipo
												HTTP-BASIC. In questo caso dovranno essere forniti
												Username e Password nei campi successivi. </para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Autenticazione Bearer</emphasis>: flag
												da attivare nel caso in cui il servizio di
												introspection richieda autenticazione tramite un
												token. Quest'ultimo dovrà essere indicato nel
												campo seguente. </para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Autenticazione Https</emphasis>: flag da
												attivare nel caso in cui il servizio di
												introspection richieda autenticazione di tipo
												Https. In questo caso dovranno essere forniti
												tutti i dati di configurazione nei campi seguenti.
												</para>
												</listitem>
											</itemizedlist>
										</para>
									</listitem>
									<listitem>
										<para>
											<emphasis>Google - TokenInfo</emphasis>: Riferimento al
											servizio di token introspection di Google. L'unico campo
											da fornire in questo caso è la URL del servizio. Il
											sistema precompila questo campo con il valore di default
												<emphasis>https://www.googleapis.com/oauth2/v3/tokeninfo</emphasis>.
										</para>
									</listitem>
									<listitem>
										<para>
											<emphasis>Personalizzato</emphasis>: Questa opzione
											consente di configurare un servizio di Token
											Introspection personalizzato (<xref
												linkend="tokenintrospectioncustom-fig"/>). <figure
												id="tokenintrospectioncustom-fig">
												<title>Configurazione personalizzata del servizio di
												Token Instrospection</title>
												<mediaobject>
												<imageobject>
												<imagedata width="50%"
												fileref="FIGURE_OUT/TokenIntrospectionCustom.pdf"
												/>
												</imageobject>
												<imageobject>
												<imagedata width="50%"
												fileref="FIGURE_OUT/TokenIntrospectionCustom.png"
												/>
												</imageobject>
												</mediaobject>
											</figure> I dati da fornire sono: <itemizedlist>
												<listitem>
												<para>
												<emphasis>URL</emphasis>: la URL del servizio di
												introspection. </para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Http Method</emphasis>: Il metodo HTTP
												che deve essere utilizzato per la chiamata al
												servizio di introspection. </para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Posizione Token</emphasis>: Il metodo di
												passaggio del token al servizio di introspection.
												Sono supportati i classici metodi: HTTP
												Authorization Bearer, Header HTTP, Parametro URL e
												Parametro Form-Encoded Body. Negli ultimi tre casi
												sarà necessario fornire il nome dell'header o del
												parametro. </para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Claims Parser</emphasis>: Il metodo di
												parsing dei claims che vengono restituiti dal
												servizio di introspection. I valori possibili
												sono: RFC 7662 - Introspection, Google - TokenInfo
												e Personalizzato. In quest'ultimo caso si dovrà
												fornire il ClassName della classe contenente la
												logica di parsing. </para>
												</listitem>
												<listitem>
												<para>
												<emphasis>Autenticazione</emphasis>: Analogamente
												a quanto visto in precedenza è necessario indicare
												con il flag opportuno il tipo di autenticazione
												richiesta dal servizio di introspection
												personalizzato. </para>
												</listitem>
											</itemizedlist>
										</para>
									</listitem>
								</itemizedlist>
							</para>
						</listitem>
					</itemizedlist>
				</para>
			</sect3>
			<sect3 id="OIDCUserInfo">
				<title>OIDC - UserInfo</title>
				<para> Sezione per attivare la richiesta al servizio di UserInfo per ottenere i dati
					inerenti l'utente possessore del token ricevuto (<xref linkend="userinfo-fig"
					/>). <figure id="userinfo-fig">
						<title>Dati di puntamento al servizio di UserInfo</title>
						<mediaobject>
							<imageobject>
								<imagedata width="50%" fileref="FIGURE_OUT/OIDCUserInfo.pdf"/>
							</imageobject>
							<imageobject>
								<imagedata width="50%" fileref="FIGURE_OUT/OIDCUserInfo.png"/>
							</imageobject>
						</mediaobject>
					</figure> Per il corretto puntamento al servizio di UserInfo devono essere
					forniti in prima istanza i parametri generali legati all'endpoint riferito, che
					sono in comune con quelli del servizio di Token Introspection, e quindi già
					descritti in precedenza. </para>
				<para> Successivamente si dovranno fornire i dati di configurazione specifici per il
					servizio UserInfo, che sono: <itemizedlist>
						<listitem>
							<para>
								<emphasis>Tipo</emphasis>: Si seleziona il tipo di servizio UserInfo
								riferito. I valori possibili sono: <itemizedlist>
									<listitem>
										<para>
											<emphasis>OpenID Connect - UserInfo</emphasis>: servizio
											di UserInfo standard OpenID Connect. </para>
									</listitem>
									<listitem>
										<para>
											<emphasis>Google - UserInfo</emphasis>: servizio
											UserInfo di Google. La URL di default del servizio viene
											inserita automaticamente. </para>
									</listitem>
									<listitem>
										<para>
											<emphasis>Personalizzato</emphasis>: si consente di
											fornire i dati di configurazione di un servizio
											personalizzato di UserInfo. I dati di configurazione
											sono gli stessi già descritti nel caso della
											configurazione del servizio di Token Introspection
											personalizzato. </para>
									</listitem>
								</itemizedlist>
							</para>
						</listitem>
						<listitem>
							<para>
								<emphasis>URL</emphasis>: La URL del servizio di UserInfo. </para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Autenticazione</emphasis>: La configurazione del metodo di
								autenticazione, quando applicabile. </para>
						</listitem>
					</itemizedlist>
				</para>
			</sect3>
			<sect3 id="tokenForward">
				<title>Token Forward</title>
				<para> Azione di elaborazione che consiste nell'inoltro del token ricevuto al
					destinatario. Una volta attivata questa opzione, devono essere indicate le
					seguenti informazioni: <itemizedlist>
						<listitem>
							<para>
								<emphasis>Originale</emphasis>: opzione che consente di inoltrare il
								token originale al destinatario. Attivando questo flag è necessario
								specificare la modalità di inoltro a scelta tra le seguenti opzioni: <itemizedlist>
									<listitem>
										<para>
											<emphasis>Come è stato ricevuto</emphasis>: Il token
											viene inoltrato al destinatario utilizzando lo stesso
											metodo con cui è stato ricevuto dal gateway. </para>
									</listitem>
									<listitem>
										<para>
											<emphasis>RFC 6750 - Bearer Token Usage (Authorization
												Request Header Field)</emphasis>: Il token viene
											inoltrato al destinatario utilizzando l'header
											Authorization presente nella richiesta HTTP. </para>
									</listitem>
									<listitem>
										<para>
											<emphasis>RFC 6750 - Bearer Token Usage (URI Query
												Parameter)</emphasis>: Il token viene inoltrato al
											destinatario tramite parametro access_token della Query
											String. </para>
									</listitem>
									<listitem>
										<para>
											<emphasis>Header HTTP</emphasis>: Il token viene
											inoltrato al destinatario utilizzando un header HTTP il
											cui nome deve essere specificato nel campo seguente.
										</para>
									</listitem>
									<listitem>
										<para>
											<emphasis>Parametro URL</emphasis>: Il token viene
											inoltrato al destinatario utilizzando un parametro della
											Query String il cui nome deve essere specificato nel
											campo seguente. </para>
									</listitem>
								</itemizedlist>
							</para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Informazioni Raccolte</emphasis>: opzione disponibile
								quando è stata abilitata una delle azioni di validazione del token
								(introspection, user info o validazione JWT), consente di veicolare
								i dati ottenuti dal servizio di validazione, al destinatario. Una
								volta attivato il flag è necessario specificare la modalità di
								inoltro dei dati selezionando una tra le opzioni seguenti: <itemizedlist>
									<listitem>
										<para>
											<emphasis>GovWay Headers</emphasis>: I dati raccolti dal
											token vengono inseriti nei seguenti header HTTP:
											<screen>
GovWay-Token-Issuer
GovWay-Token-Subject
GovWay-Token-Username
GovWay-Token-Audience
GovWay-Token-ClientId
GovWay-Token-IssuedAt
GovWay-Token-Expire
GovWay-Token-NotToBeUsedBefore
GovWay-Token-Scopes
GovWay-Token-FullName
GovWay-Token-FirstName
GovWay-Token-MiddleName
GovWay-Token-FamilyName
GovWay-Token-EMail
</screen>
										</para>
									</listitem>
									<listitem>
										<para>
											<emphasis>GovWay JSON</emphasis>: I dati raccolti dal
											token vengono inseriti in un oggetto JSON, il cui
											JsonSchema è il seguente:
											<screen>
{
    "required" : [ "id" ],
    "properties": {
        "id": {"type": "string"},
        "issuer": {"type": "string"},
	"subject": {"type": "string"},
	"username": {"type": "string"},
	"audience": {"type": "string"},
	"clientId": {"type": "string"},
	"iat": {
            "type": "string",
            "format": "date-time"
        },
	"expire": {
            "type": "string",
            "format": "date-time"
        },
	"expire": {
            "type": "string",
            "format": "date-time"
        },
        "roles": {
            "type": "array",
            "items": {"type": "string"}
        },
        "scope": {
            "type": "array",
            "items": {"type": "string"}
        },
	"userInfo": {
		"type": "object",
		"properties": {
			"fullName": {"type": "string"},
			"firstName": {"type": "string"},
			"middleName": {"type": "string"},
			"familyName": {"type": "string"},
			"email": {"type": "string"},
		},
		"additionalProperties": false
	}
    },
    "additionalProperties": false
}
</screen>
											Il JSON risultante viene inserito nell'Header HTTP
												<emphasis>GovWay-Token</emphasis>. </para>
									</listitem>
									<listitem>
										<para>
											<emphasis>GovWay JWS</emphasis>: I dati raccolti dal
											token vengono inseriti in un oggetto JSON, come
											descritto al punto precedente. In questo caso il token
											JSON viene inserito successivamente in un JWT e quindi
											firmato. Il JWS risultante viene inserito nell'Header
											HTTP <emphasis>GovWay-JWT</emphasis>. </para>
									</listitem>
									<listitem>
										<para>
											<emphasis>JSON</emphasis>: Le informazioni ottenute dai
											servizi di introspection, userinfo o il json estratto
											dal token jwt dopo la validazione, vengono inseriti
											negli header http o proprietà delle url indicati. <note>
												<para>Le informazioni sono esattamente quelle
												recuperate dai servizi originali (o presenti nel
												token originale nel caso di validazione
												jwt).</para>
											</note>
										</para>
									</listitem>
									<listitem>
										<para>
											<emphasis>JWS/JWE</emphasis>: Uguale alla modalità JSON
											con la differenza che negli header http, o nelle
											proprietà delle url, vengono inseriti dei JWT firmati
											(caso JWS) o cifrati (caso JWE) contenenti al loro
											interno il JSON. </para>
									</listitem>
								</itemizedlist>
							</para>
						</listitem>
					</itemizedlist>
				</para>
			</sect3>
		</sect2>
		<sect2 id="config-utenti">
			<title>Utenti</title>
			<para> La sezione <emphasis>Configurazione > Utenti</emphasis> è dedicata alla gestione
				degli utenti dei cruscotti grafici govwayConsole e govwayMonitor. </para>
			<para> Prima di descrivere le funzionalità relative alla gestione utenti è necessario
				fare una premessa sull'organizzazione dei permessi che sono assegnabili ad un
				utente. </para>
			<para> Le funzionalità delle console grafiche sono partizionate in gruppi cui
				corrispondono puntuali permessi che possono essere concessi agli utenti per
				limitarne l'operatività. Vediamo quali sono i gruppi funzionali, e conseguentemente
				i permessi associabili a ciascun utente: <itemizedlist>
					<listitem>
						<para>
							<emphasis>Registro</emphasis>
							<itemizedlist>
								<listitem>
									<para><emphasis>Gestione API [S]</emphasis> - Gestione delle
										entità di configurazione dei servizi, quali: API,
										Erogazioni, Fruizioni, ecc. </para>
								</listitem>
							</itemizedlist>
						</para>
					</listitem>
					<listitem>
						<para>
							<emphasis>GovWay Monitor</emphasis>
							<itemizedlist>
								<listitem>
									<para><emphasis>Monitoraggio [D]</emphasis> - Accesso alle
										funzionalità di monitoraggio della console
										govwayMonitor.</para>
								</listitem>
								<listitem>
									<para><emphasis>Reportistica [R]</emphasis> - Accesso alle
										funzionalità di reportistica della console
										govwayMonitor.</para>
								</listitem>
							</itemizedlist>
						</para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Strumenti</emphasis>
							<itemizedlist>
								<listitem>
									<para><emphasis>Auditing [A]</emphasis> - Accesso alle
										funzionalità di consultazione delle tracce del servizio di
										Auditing.</para>
								</listitem>
							</itemizedlist>
						</para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Configurazione</emphasis>
							<itemizedlist>
								<listitem>
									<para><emphasis>[C]</emphasis> - Accesso alle funzionalità di
										configurazione. Queste funzionalità sono quelle presenti nel
										menu di navigazione nel gruppo
											<emphasis>Configurazione</emphasis> e riguardano:
										tracciamento, controllo del traffico, import-export,
										ecc.</para>
								</listitem>
								<listitem>
									<para><emphasis>[U]</emphasis> - Possibilità di gestire gli
										utenti delle console. Gli utenti con questo permesso, sono
										di fatto dei superutenti in quanto possono assumere
										l'identità di un qualunque utente del sistema.</para>
								</listitem>
							</itemizedlist>
						</para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Altri Permessi (visibili solo configurazione specifica del
								prodotto)</emphasis>
							<itemizedlist>
								<listitem>
									<para><emphasis>[P]</emphasis> - Gestione delle entità di
										configurazione degli Accordi di Cooperazione e Servizi
										Composti.</para>
								</listitem>
								<listitem>
									<para><emphasis>[M]</emphasis> - Accesso alle code messaggi sul
										gateway. Questa autorizzazione consente ad esempio di
										consultare i messaggi presenti nelle Message Box
										dell'Integration Manager ed eventualmente effettuare delle
										rimozioni.</para>
								</listitem>
							</itemizedlist>
						</para>
					</listitem>
				</itemizedlist>
			</para>
			<para>L'applicazione, al termine dell'installazione, contiene una utenza (credenziali
				indicate durante l'esecuzione dell'installer) che permette di effettuare tutte le
				principali operazioni di gestione.</para>
			<para> Gli utenti in possesso del permesso [U] possono creare dei nuovi utenti. La
				maschera di creazione di un nuovo utente è quella mostrata in <xref
					linkend="addUser"/>. <figure id="addUser">
					<title>Creazione nuovo utente</title>
					<mediaobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/AggiungiUtente.pdf"/>
						</imageobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/AggiungiUtente.png"/>
						</imageobject>
					</mediaobject>
				</figure> Le informazioni da inserire sono: <itemizedlist>
					<listitem>
						<para>
							<emphasis>Informazioni Utente</emphasis>
							<itemizedlist>
								<listitem>
									<para>
										<emphasis>Nome</emphasis>
									</para>
								</listitem>
							</itemizedlist>
						</para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Permessi di Gestione</emphasis>: sezione che consente di
							assegnare i permessi all'utente e quindi decidere quali funzionalità
							rendergli accessibili. </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Profilo di Interoperabilità</emphasis>: sezione che consente
							di decidere quali, tra i profili disponibili, rendere accessibili
							all'utente. </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Visibilità dati tramite govwayMonitor</emphasis>: questa
							sezione è visibile solo se è stato abilitato uno dei permessi "GovWay
							Monitor". In questo contesto è possibile stabilire la visibilità
							dell'utente sulla console GovWay Monitor riguardo i seguenti: <itemizedlist>
								<listitem>
									<para>
										<emphasis>Soggetti</emphasis>: opzione visibile solo se
										attiva la modalità multi-tenant, consente di limitare la
										visibilità delle entità di monitoraggio ai soli soggetti
										interni indicati in una whitelist. Per configurare la
										whitelist è necessario salvare l'utente da creare e
										successivamente accedere in editing. In alternativa è
										possibile attivare il flag "Tutti" per non assegnare
										limitazioni. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis>API</emphasis>: consente di limitare la visibilità
										delle entità di monitoraggio alle sole API indicate in una
										whitelist. Per configurare la whitelist è necessario salvare
										l'utente da creare e successivamente accedere in editing. In
										alternativa è possibile attivare il flag "Tutti" per non
										assegnare limitazioni. </para>
								</listitem>
							</itemizedlist>
						</para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Modalità Interfaccia</emphasis>: opzione per decidere quale
							modalità, tra standard e avanzata, è quella di default per l'utente.
						</para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Password</emphasis>: sezione per l'impostazione della password
							dell'utente. </para>
					</listitem>
				</itemizedlist>
			</para>
			<para> La pagina indice della sezione Utenti visualizza gli utenti già presenti nel
				sistema con i relativi permessi e i link per modificarli o assumerne l'identità
					(<xref linkend="listUsers"/>) <figure id="listUsers">
					<title>Lista degli utenti</title>
					<mediaobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/ElencoUtenti.pdf"/>
						</imageobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/ElencoUtenti.png"/>
						</imageobject>
					</mediaobject>
				</figure>
			</para>
		</sect2>

		<sect2 id="config-importa">
			<title>Importa</title>
			<para> L'importazione di entità nel registro può essere effettuata tramite la sezione
				accessibile con la voce di menu <emphasis>Importa</emphasis> presente nella sezione
					<emphasis>Configurazione</emphasis>. </para>
			<para> Il form che compare per l'importazione è quello riportato in <xref
					linkend="importazione_fig"/>. I passi da eseguire sono i seguenti: <itemizedlist>
					<listitem>
						<para> Selezionare la modalità cui fanno riferimento le entità contenute
							nell'archivio da importare. </para>
					</listitem>
					<listitem>
						<para>In base alla modalità selezionata potrebbero essere richieste
							ulteriori informazioni. Ad esempio, per il protocollo SPCoop, verrà
							richiesto quale tipo di archivio si vuole importare, a scelta tra: <itemizedlist>
								<listitem>
									<para>
										<emphasis>spcoop</emphasis>: il formato standard basato
										sulle specifiche SPCoop </para>
								</listitem>
								<listitem>
									<para>
										<emphasis>govlet</emphasis>: il formato di govway. Gli
										archivi con tale formato sono ottenibili o attraverso
										un'esportazione effettuabile tramite govwayConsole o
										scaricando le govlets disponibili sul sito del progetto che
										permettono di pre-configurare GovWay per uno specifico
										servizio</para>
								</listitem>
							</itemizedlist>
						</para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Validazione Documenti</emphasis> (disponibile solamente con
							interfaccia in modalità avanzata, per default è abilitato): Se attivato,
							questo flag indica che i documenti presenti nell'archivio vengono
							validati prima di essere importati (es. wsdl, xsd ...). </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Aggiornamento</emphasis>: Se attivato, questo flag indica che
							l'archivio da importare costituisce un aggiornamento del registro
							attuale. </para>
					</listitem>
					<listitem>
						<para> Selezionare dal filesystem il file che corrisponde all'archivio che
							deve essere importato. </para>
					</listitem>
				</itemizedlist>
				<figure id="importazione_fig">
					<title>Importazione di entità nel registro</title>
					<mediaobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/Importazione.png"/>
						</imageobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/Importazione.pdf"/>
						</imageobject>
					</mediaobject>
				</figure>
			</para>

		</sect2>
		<sect2 id="config-Esporta">
			<title>Esporta</title>
			<para> L'esportazione dei dati di configurazione dalla govwayConsole è possibile nei
				modi seguenti: <itemizedlist>
					<listitem>
						<para> Selezionando singolarmente le entità di configurazione da esportare,
							come ad esempio "Erogazioni" o "API", e premendo il pulsante
								<emphasis>Esporta</emphasis> (<xref linkend="esportazione_fig"/>). </para>
						<figure id="esportazione_fig">
							<title>Esportazione di singole entità del registro</title>
							<mediaobject>
								<imageobject>
									<imagedata width="60%" fileref="FIGURE_OUT/Esportazione.png"/>
								</imageobject>
								<imageobject>
									<imagedata width="60%" fileref="FIGURE_OUT/Esportazione.pdf"/>
								</imageobject>
							</mediaobject>
						</figure>
						<para> Dopo aver selezionato il pulsante "Esporta", una seconda maschera
								(<xref linkend="esportazione2_fig"/>) riporta le seguenti
							informazioni: <itemizedlist>
								<listitem>
									<para><emphasis>Profilo Interoperabilità</emphasis>: indicazione
										del profilo cui fa riferimento l'esportazione.</para>
								</listitem>
								<listitem>
									<para><emphasis>Tipologia archivio</emphasis>: se previsto, fa
										selezionare la tipologia di archivio da produrre. Il default
										è il formato <emphasis>Govlet</emphasis> standard di
										esportazione di Govway.</para>
								</listitem>
								<listitem>
									<para><emphasis>Includi elementi riferiti</emphasis>: include
										nell'archivio di esportazione anche gli elementi di
										configurazione riferiti da quelli selezionati.</para>
								</listitem>
							</itemizedlist>
						</para>
						<figure id="esportazione2_fig">
							<title>Esportazione di entità nel registro</title>
							<mediaobject>
								<imageobject>
									<imagedata width="60%" fileref="FIGURE_OUT/Esportazione2.png"/>
								</imageobject>
								<imageobject>
									<imagedata width="60%" fileref="FIGURE_OUT/Esportazione2.pdf"/>
								</imageobject>
							</mediaobject>
						</figure>
					</listitem>
					<listitem>
						<para> Tramite la voce di menu <emphasis>Configurazione > Esporta</emphasis>
							che presenta le opzioni mostrate in <xref linkend="esportazione3_fig"/>. </para>
						<figure id="esportazione3_fig">
							<title>Esportazione di entità nel registro</title>
							<mediaobject>
								<imageobject>
									<imagedata width="60%" fileref="FIGURE_OUT/Esportazione3.png"/>
								</imageobject>
								<imageobject>
									<imagedata width="60%" fileref="FIGURE_OUT/Esportazione3.pdf"/>
								</imageobject>
							</mediaobject>
						</figure>
						<para> Le opzioni presenti sono: <itemizedlist>
								<listitem>
									<para><emphasis>Profilo Interoperabilità</emphasis>: indica
										quale profilo riguarda l'esportazione che si sta
										effettuando</para>
								</listitem>
								<listitem>
									<para><emphasis>Tipologia Archivio</emphasis>: nei casi che lo
										prevedono, consente di specificare il formato dell'archivio
										di esportazione da produrre.</para>
								</listitem>
								<listitem>
									<para><emphasis>Modalità</emphasis>: consente di specificare
										cosa esportare tra le seguenti possibilità: <itemizedlist>
											<listitem>
												<para><emphasis>Esportazione completa</emphasis>:
												esportazione dell'intero repository di
												configurazione (limitatamente al profilo di
												interoperabilità selezionato, se diverso da
												"Tutti").</para>
											</listitem>
											<listitem>
												<para><emphasis>Registro</emphasis>: esporta solo le
												entità del registro (erogazioni, fruizioni, api,
												ecc)</para>
											</listitem>
											<listitem>
												<para><emphasis>Configurazione</emphasis>: esporta
												solo le entità della sezione Configurazione (token
												policy, tracciamento, ecc).</para>
											</listitem>
										</itemizedlist>
									</para>
								</listitem>
							</itemizedlist>
						</para>
					</listitem>
				</itemizedlist>
			</para>

			<para> Il formato dell'archivio prodotto come risultato dell'esportazione dipende dalla
				modalità cui fanno riferimento le entità selezionate. </para>

		</sect2>
		<sect2 id="config-auditing">
			<title>Auditing</title>
			<para> In questa sezione descriviamo le modalità di configurazione del servizio di
				auditing, al fine di definire quali informazioni devono essere tracciate, con che
				formato e con che livello di dettaglio. </para>
			<para> Gli utenti con permesso [C] Configurazione (vedi <xref linkend="config-utenti"/>)
				hanno la possibilità di configurare il servizio di auditing, al fine di stabilire
				cosa tracciare, con che formato e con che livello di dettaglio.</para>
			<para>L'accesso alla funzionalità di configurazione del servizio di auditing avviene
				tramite la voce <emphasis>Auditing</emphasis> nella sezione
					<emphasis>Configurazione</emphasis> del menu laterale sinistro.</para>
			<para>Se la maschera si presenta come in <xref linkend="auditDisable"/> il servizio di
				auditing è disabilitato e quindi nessun dato verrà tracciato.</para>
			<figure id="auditDisable">
				<title>Servizio di auditing disabilitato</title>

				<mediaobject>
					<imageobject>
						<imagedata width="60%" fileref="FIGURE_OUT/AuditingSetupDisabled.pdf"/>
					</imageobject>

					<imageobject>
						<imagedata width="60%" fileref="FIGURE_OUT/AuditingSetupDisabled.jpg"/>
					</imageobject>
				</mediaobject>
			</figure>
			<para>Modificando lo <emphasis>Stato</emphasis> del servizio di auditing in <emphasis
					role="bold">Abilitato</emphasis> appariranno ulteriori campi nel form (vedi
					<xref linkend="auditEnable"/>) per effettuare le impostazioni.</para>

			<figure id="auditEnable">
				<title>Servizio di auditing abilitato</title>

				<mediaobject>
					<imageobject>
						<imagedata width="60%" fileref="FIGURE_OUT/AuditingSetupEnabled.pdf"/>
					</imageobject>

					<imageobject>
						<imagedata width="60%" fileref="FIGURE_OUT/AuditingSetupEnabled.jpg"/>
					</imageobject>
				</mediaobject>
			</figure>

			<para> La configurazione del servizio di auditing avviene tramite la creazione di una
				lista di <emphasis role="bold">Filtri</emphasis>, ciascuno dei quali stabilisce un
				criterio per stabilire se una data informazione deve o non deve essere tracciata.
				Alle informazioni cui non si applica nessuno dei filtri definiti, viene applicato il
				comportamento di default, i cui parametri sono presenti nella schermata principale
				del servizio. Facendo riferimento alla <xref linkend="auditEnable"/> vediamo quali
				sono i parametri per specificare il comportamento di default: <itemizedlist>
					<listitem>
						<para>
							<emphasis role="bold">Audit</emphasis> (abilitato/disabilitato): Se
							abilitato, tutte le informazioni, cui non risulta applicabile nessuno
							dei filtri impostati, verranno tracciate dal servizio di auditing.
						</para>
					</listitem>
					<listitem>
						<para>
							<emphasis role="bold">Dump</emphasis> (abilitato/disabilitato): Questo
							campo viene preso in considerazione quando <emphasis>Audit =
								abilitato</emphasis>. Stabilisce, nei casi in cui non si applica
							nessun filtro, se oltre a tracciare i campi che descrivono l'operazione,
							devono essere tracciate anche le strutture dati coinvolte. </para>
					</listitem>
					<listitem>
						<para>
							<emphasis role="bold">Formato Dump</emphasis> (JSON/XML): Stabilisce il
							formato in cui vengono memorizzate le strutture dati di cui si è scelto
							di effettuare il dump. Le opzioni possibili sono tra il formato standard
							JSON (<ulink url="http://www.json.org/">http://www.json.org</ulink>) e
							la sua rappresentazione in formato XML. </para>
					</listitem>
					<listitem>
						<para>
							<emphasis role="bold">Log4J Auditing</emphasis>
							(abilitato/disabilitato): Questa opzione consente di
							abilitare/disabilitare l'appender log4j relativo ai dati tracciati dal
							servizio di auditing. </para>
					</listitem>
				</itemizedlist>
			</para>
			<para> Una volta stabilito il comportamento di default si potranno definire i filtri
				specifici. Per passare alla sezione di gestione dei filtri si seleziona
					<emphasis>Visualizza</emphasis> nella sezione Filtri. Nell'area di gestione
				filtri viene mostrata la lista dei filtri esistenti con la possibilità di
				modificare/cancellare gli esistenti o inserirne di nuovi. Si può aggiungere un nuovo
				filtro premendo il pulsante <emphasis>Aggiungi</emphasis>. In <xref
					linkend="auditFilter"/> è mostrata la maschera per la creazione di un nuovo
				filtro di auditing. </para>
			<figure id="auditFilter">
				<title>Creazione di un filtro per il servizio di auditing</title>

				<mediaobject>
					<imageobject>
						<imagedata width="60%" fileref="FIGURE_OUT/AuditingSetupFilter.pdf"/>
					</imageobject>

					<imageobject>
						<imagedata width="60%" fileref="FIGURE_OUT/AuditingSetupFilter.jpg"/>
					</imageobject>
				</mediaobject>
			</figure>
			<para> Facendo riferimento alla <xref linkend="auditFilter"/> vediamo in dettaglio il
				significato dei campi di un filtro: <itemizedlist>
					<listitem>
						<para>
							<emphasis>Filtro Generico</emphasis>
							<itemizedlist>
								<listitem>
									<para>
										<emphasis role="bold">Utente</emphasis>: è possibile
										specificare in questo campo uno username relativo ad un
										utente della govwayConsole del quale si vogliono tracciare
										le operazioni effettuate. Lasciare il campo di testo vuoto
										equivale a <emphasis>Qualsiasi Utente</emphasis>
									</para>
								</listitem>
								<listitem>
									<para>
										<emphasis role="bold">Tipo Operazione</emphasis>
										(ADD/CHANGE/DEL): Specifica il tipo di operazione che si
										vuole tracciare distinguendo tra operazioni di creazione,
										modifica e cancellazione. Lasciare il campo vuoto equivale a
											<emphasis>Qualsiasi Tipo</emphasis>. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis role="bold">Tipo Oggetto</emphasis>: Questo campo
										è costituito da una lista contenente tutte le entità
										gestibili tramite l'interfaccia govwayConsole (ad esempio:
										Accordo di Servizio, Porta Delegata, ecc). Consente di
										restringere il tracciamento alle sole operazioni riguardanti
										una determinata entità. Lasciare il campo vuoto equivale a
											<emphasis>Qualsiasi Tipo Oggetto</emphasis>. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis role="bold">Stato Operazione</emphasis>
										(requesting/error/completed): Consente di restringere le
										operazioni da tracciare in base al loro stato: <itemizedlist>
											<listitem>
												<para>
												<emphasis>requesting</emphasis>: indica
												un'operazione in fase di richiesta e non ancora
												completata </para>
											</listitem>
											<listitem>
												<para>
												<emphasis>error</emphasis>: Indica un'operazione
												completata che ha restituito un errore </para>
											</listitem>
											<listitem>
												<para>
												<emphasis>completed</emphasis>: Indica
												un'operazione che è terminata correttamente
												</para>
											</listitem>
										</itemizedlist> Lasciare il campo vuoto equivale a
											<emphasis>Qualsiasi Stato Operazione</emphasis>. </para>
								</listitem>
							</itemizedlist>
						</para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Filtro per contenuto</emphasis>
							<itemizedlist>
								<listitem>
									<para>
										<emphasis role="bold">Stato</emphasis>
										(abilitato/disabilitato): Opzione che consente di abilitare
										il filtro basato sul contenuto degli oggetti coinvolti
										nell'operazione. Se l'opzione viene abilitata compariranno i
										2 campi descritti ai passi successivi. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis role="bold">Tipo</emphasis>
										(normale/espressioneRegolare): Descrive se la stringa
										riportata nel campo Dump deve essere interpretata come
										pattern o come espressione regolare. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis role="bold">Dump</emphasis>: Campo di testo per
										inserire il pattern (o espressione regolare) sulla base del
										quale verranno filtrate le operazioni. Il sistema di
										auditing traccerà soltanto le operazioni che coinvolgeranno
										entità il cui contenuto corrisponde alla stringa
										specificata. </para>
								</listitem>
							</itemizedlist>
						</para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Azione</emphasis>: indica quale azione deve essere effettuata
							al verificarsi delle condizioni del filtro <itemizedlist>
								<listitem>
									<para>
										<emphasis role="bold">Stato</emphasis>
										(abilitato/disabilitato): Se abilitato, al verificarsi delle
										condizioni impostate nel filtro, i dati dell'operazione
										verranno tracciati. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis role="bold">Dump</emphasis>
										(abilitato/disabilitato): Se <emphasis>Stato =
											abilitato</emphasis> è possibile specificare se si deve
										effettuare anche il dump delle entità coinvolte
										nell'operazione. Ad esempio, se viene tracciata
										un'operazione di modifica di un Accordo di Servizio, si
										decide se si vuole effettuare anche il dump dell'Accordo di
										Servizio oggetto della modifica. </para>
								</listitem>
							</itemizedlist>
						</para>
					</listitem>
				</itemizedlist>
			</para>
		</sect2>
	</sect1>

	<sect1 id="avanzate">
		<title>Funzionalità Avanzate</title>
		<para> </para>
		<sect2 id="api-interfacce">
			<title>Configurazione manuale delle interfacce</title>
			<para> Nel caso non si disponga del descrittore della API, è possibile in alternativa
				fornire manualmente la specifica delle interfacce. Dopo aver salvato la nuova API,
				senza aver fornito il descrittore delle interfacce, si procede individuando il nuovo
				elemento nella lista delle API presenti e cliccando sul collegamento presente nella
				colonna <emphasis>Servizi</emphasis>, nel caso SOAP, o <emphasis>Risorse</emphasis>
				nel caso REST. </para>
			<para> Nel caso SOAP, si procede aggiungendo il nuovo servizio tramite il pulsante
					<emphasis>Aggiungi</emphasis>. Il form da compilare è quello mostrato nella
				figura seguente. <figure id="AggiungiPortType-fig">
					<title>Aggiunta di un servizio alla API SOAP</title>
					<mediaobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/AggiungiPortType.pdf"/>
						</imageobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/AggiungiPortType.png"/>
						</imageobject>
					</mediaobject>
				</figure> I dati da fornire sono i seguenti: <itemizedlist>
					<listitem>
						<para><emphasis>Nome</emphasis> del servizio</para>
					</listitem>
					<listitem>
						<para><emphasis>Descrizione</emphasis> del servizio</para>
					</listitem>
					<listitem>
						<para><emphasis>Profilo di collaborazione</emphasis> del servizio, a scelta
							tra oneway e sincrono</para>
					</listitem>
					<listitem>
						<para><emphasis>ID Collaborazione</emphasis>. Flag per consentire di
							specificare nelle richieste un valore che identifica una
							conversazione.</para>
					</listitem>
					<listitem>
						<para><emphasis>Riferimento ID Richiesta</emphasis>. Flag per consentire di
							specificare nelle richieste un identificativo relativo ad un messaggio
							precedente.</para>
					</listitem>
				</itemizedlist> Al passo successivo, utilizzando il collegamento nella colonna
					<emphasis>Azioni</emphasis>, relativamente al servizio appena creato, si procede
				con l'aggiunta delle azioni. Il form da compilare è quello mostrato nella figura
				seguente. <figure id="AggiungiAzione-fig">
					<title>Aggiunta di un'azione alla API SOAP</title>
					<mediaobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/AggiungiAzione.pdf"/>
						</imageobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/AggiungiAzione.png"/>
						</imageobject>
					</mediaobject>
				</figure> I dati da fornire sono i seguenti: <itemizedlist>
					<listitem>
						<para><emphasis>Nome</emphasis> dell'azione</para>
					</listitem>
					<listitem>
						<para><emphasis>Profilo</emphasis>. Si può scegliere se utilizzare le
							impostazioni già fornite a livello del servizio, oppure ridefinirle
							indicando nuovamente Profilo di collaborazione, ID Collaborazione e
							Riferimento ID Richiesta.</para>
					</listitem>
				</itemizedlist>
			</para>
			<para> Nel caso REST, si procede aggiungendo la nuova risorsa tramite il pulsante
					<emphasis>Aggiungi</emphasis>. Il form da compilare è quello mostrato nella
				figura seguente. <figure id="AggiungiRisorsa-fig">
					<title>Aggiunta di una risorsa alla API REST</title>
					<mediaobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/AggiungiRisorsaREST.pdf"/>
						</imageobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/AggiungiRisorsaREST.png"/>
						</imageobject>
					</mediaobject>
				</figure> I dati da fornire sono i seguenti: <itemizedlist>
					<listitem>
						<para><emphasis>HTTP Method</emphasis> relativo alla risorsa (GET, POST,
							DELETE, ecc.)</para>
					</listitem>
					<listitem>
						<para><emphasis>Path</emphasis> della risorsa</para>
					</listitem>
					<listitem>
						<para><emphasis>Nome</emphasis> della risorsa</para>
					</listitem>
					<listitem>
						<para><emphasis>Descrizione</emphasis> della risorsa</para>
					</listitem>
					<listitem>
						<para><emphasis>ID Collaborazione</emphasis>. Flag per consentire di
							specificare nelle richieste un valore che identifica una
							conversazione.</para>
					</listitem>
					<listitem>
						<para><emphasis>Riferimento ID Richiesta</emphasis>. Flag per consentire di
							specificare nelle richieste un identificativo relativo ad un messaggio
							precedente.</para>
					</listitem>
				</itemizedlist>
			</para>
		</sect2>

		<sect2 id="identificazione-azione">
			<title>Modalità di identificazione dell'azione</title>
			<para> Nel contesto dei servizi Soap, sia erogazioni che fruizioni, si ha la possibilità
				di selezionare una tra diverse opzioni che riguardano la modalità di identificazione
				dell'azione. Dopo aver acceduto la sezione <emphasis>URL di Invocazione</emphasis>,
				relativamente alla fruizione o erogazione, si può selezionare una tra le seguenti
				opzioni: <itemizedlist>
					<listitem>
						<para>
							<emphasis>content-based</emphasis> (Soap e Rest): il dato viene ricavato
							dal messaggio di richiesta utilizzando come criterio l'espressione XPath
							indicata nel campo <emphasis>Pattern</emphasis> sottostante. </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>header-based</emphasis> (Soap e Rest): il dato viene ricavato
							da un valore passato come Http Header. Il campo sottostante consente di
							specificare il nome di tale header. </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>input-based</emphasis> (Soap e Rest): il dato viene ricavato
							dall'header di integrazione fornito con il messaggio di richiesta. Per
							conoscere come gli applicativi client forniscono tale informazione
							vedere la sezione <xref linkend="header-integrazione-client"/></para>

					</listitem>
					<listitem>
						<para>
							<emphasis>interface-based</emphasis> (Soap e Rest): il dato viene
							ricavato in automatico sulla base delle informazioni fornite con la
							richiesta (messaggio e parametri) confrontandole con la descrizione
							dell'interfaccia del servizio. </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>url-based</emphasis> (Soap): il dato viene ricavato
							dinamicamente dalla url di invocazione utilizzando come criterio
							l'espressione regolare inserita nel campo <emphasis>Pattern</emphasis>
							sottostante. </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>soap-action-based</emphasis> (Soap): Questa opzione consente
							di ricavare il dato dal campo <emphasis>SoapAction</emphasis> presente
							nell'header di trasporto delle comunicazioni SOAP. </para>
					</listitem>
				</itemizedlist>
			</para>
			<para> Attivando il flag <emphasis>Force interface</emphasis>, in caso di fallimento
				dell'identificazione dell'azione nella modalità prevista al passo precedente, si
				tenterà di utilizzare la modalità "interface-based" come seconda opzione. </para>
			<para> Il campo <emphasis>Azioni</emphasis> illustra l'elenco delle azioni presenti per
				semplice comodità. </para>
		</sect2>

		<sect2 id="interfaccia-avanzata">
			<title>Modalità Avanzata</title>
			<para> L'interfaccia della govwayConsole, fin qui descritta, fa riferimento
				all'operatività nella <emphasis>modalità standard</emphasis>. La modalità standard
				prevede varie semplificazioni, sulle opzioni visualizzate nelle schermate, mirate al
				compimento delle operazioni di uso comune. </para>
			<para> Nel caso si avesse la necessità di ricorrere a configurazioni più specifiche, non
				contemplate nella modalità standard, è possibile passare alla visualizzazione
				dell'interfaccia nella <emphasis>Modalità Avanzata</emphasis> utilizzando la voce
				omonima del menu a discesa che compare selezionando l'icona in alto a destra (nella
				testata della govwayConsole). </para>
			<para> Operando in modalità avanzata, in ciascuno dei contesti di configurazione già
				descritti in questo manuale, compariranno opzioni aggiuntive per le quali sono
				previsti valori di default nel caso della modalità standard. </para>
			<para> Nella modalità avanzata sarà disponibile la funzionalità aggiuntiva
					<emphasis>Elimina</emphasis>, presente nel menu di Configurazione, che consente
				di utilizzare package di esportazione per l'eliminazione selettiva di entità dal
				registro. </para>
			<note>
				<para>Non tutte le funzionalità disponibili in modalità avanzata sono descritte nel
					presente manuale. </para>
			</note>
		</sect2>
		<sect2 id="multi-tenant">
			<title>Multi-Tenant</title>
			<para> I processi di configurazione, descritti in questo manuale, sono ottimizzati
				nell'ottica di mantenere sempre sottinteso il soggetto interno al dominio. In tal
				senso, le fruizioni e le erogazioni si intendono sempre in soggettiva riguardo un
				singolo soggetto interno amministrato dall'utente in sessione. </para>
			<para>
				<emphasis>Multi-tenant</emphasis> è un'opzione che consente di estendere l'ambito
				delle configurazioni prodotte dalla govwayConsole a più di un soggetto interno al
				dominio. Tale opzione si attiva nella configurazione generale (<xref
					linkend="config-generale"/>). </para>
			<para> Per gestire la compresenza di più soggetti interni al dominio, per la
				configurazione di erogazioni e fruizioni, è possibile scegliere quali soggetti
				interni rendere ammissibili (<xref linkend="multi-tenant-config"/>): <itemizedlist>
					<listitem>
						<para>
							<emphasis>Fruizioni (Soggetto Erogatore)</emphasis>
							<itemizedlist>
								<listitem>
									<para>
										<emphasis>Tutti</emphasis>: indica che tutti i soggetti
										interni, censiti nel registro di GovWay, sono selezionabili
										come soggetto erogatore, in una fruizione. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis>Escludi Soggetto Fruitore</emphasis>: indica che
										tutti i soggetti interni, tranne il soggetto fruitore, sono
										selezionabili come soggetto erogatore, in una fruizione.
									</para>
								</listitem>
								<listitem>
									<para>
										<emphasis>Solo Soggetti Esterni</emphasis>: indica che il
										soggetto erogatore di una fruizione deve essere un soggetto
										esterno. </para>
								</listitem>
							</itemizedlist>
						</para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Erogazioni (Soggetti Fruitori)</emphasis>
							<itemizedlist>
								<listitem>
									<para>
										<emphasis>Tutti</emphasis>: indica che tutti i soggetti
										interni, censiti nel registro di GovWay, sono selezionabili
										come soggetti fruitori, in una erogazione. </para>
								</listitem>
								<listitem>
									<para>
										<emphasis>Escludi Soggetto Erogatore</emphasis>: indica che
										tutti i soggetti interni, tranne il soggetto erogatore, sono
										selezionabili come soggetti fruitori, in una erogazione.
									</para>
								</listitem>
								<listitem>
									<para>
										<emphasis>Solo Soggetti Esterni</emphasis>: indica che i
										soggetti fruitori di una erogazione devono essere soggetti
										esterni. </para>
								</listitem>
							</itemizedlist>
						</para>
					</listitem>
				</itemizedlist>
			</para>
			<figure id="multi-tenant-config">
				<title>Elementi di configurazione della modalità multi-tenant</title>
				<mediaobject>
					<imageobject>
						<imagedata width="60%" fileref="FIGURE_OUT/Multi-Tenant-Config.pdf"/>
					</imageobject>
					<imageobject>
						<imagedata width="60%" fileref="FIGURE_OUT/Multi-Tenant-Config.png"/>
					</imageobject>
				</mediaobject>
			</figure>

			<para> L'utente che ha l'opzione multi-tenant attiva, visualizza sulla testata un menu a
				discesa che consente di selezionare l'utente interno al dominio sul quale vuole
				operare (<xref linkend="multi-tenant-fig"/>). Se viene selezionato un soggetto dalla
				lista, l'operatività sulla console risulterà identica alla situazione con un unico
				soggetto interno. Selezionando l'opzione "Tutti" sarà richiesto nei singoli contesti
				di specificare il soggetto interno. </para>
			<figure id="multi-tenant-fig">
				<title>Selezione del soggetto operativo in modalità multi-tenant</title>
				<mediaobject>
					<imageobject>
						<imagedata width="60%" fileref="FIGURE_OUT/Multi-Tenant.pdf"/>
					</imageobject>
					<imageobject>
						<imagedata width="60%" fileref="FIGURE_OUT/Multi-Tenant.png"/>
					</imageobject>
				</mediaobject>
			</figure>
		</sect2>
		<sect2 id="header-integrazione">
			<title>Header di Integrazione</title>
			<para> In base alle configurazioni prodotte per i servizi, è previsto in diverse
				situazioni che gli applicativi scambino dei dati con il gateway. </para>
			<para> Nel caso degli applicativi server lo scopo è quello di ricevere dal gateway i
				metadati che riguardano la richiesta gestita. </para>
			<para> Per gli applicativi client tale scambio si rende necessario al fine di fornire al
				gateway specifici parametri necessari a elaborare la richiesta. </para>
			<para> Per consentire lo scambio di tali informazioni, funzionali all'integrazione tra
				applicativi e gateway, sono previste alcune strutture dati, che indichiamo di
				seguito con il termine <emphasis>Header di Integrazione</emphasis>, che possono
				essere trasmesse in differenti modalità: <itemizedlist>
					<listitem>
						<para><emphasis>Trasporto</emphasis>: le informazioni sono contenute
							nell'header di trasporto</para>
					</listitem>
					<listitem>
						<para><emphasis>Url Based</emphasis>: le informazioni sono incapsulate nella
							url</para>
					</listitem>
					<listitem>
						<para><emphasis>SOAP</emphasis>: le informazioni sono incluse in uno
							specifico header SOAP proprietario di GovWay</para>
					</listitem>
					<listitem>
						<para><emphasis>WS-Addressing</emphasis>: le informazioni sono incluse in un
							header SOAP secondo il formato standard WS-Addressing</para>
					</listitem>
				</itemizedlist>
			</para>
			<para> Nel seguito descriviamo le strutture degli header di integrazione attive per
				default con l'installazione del prodotto. Tali strutture variano in funzione del
				ruolo dell'applicativo. Per l'applicativo client è possibile fornire informazioni al
				gateway tramite le modalità <emphasis>Trasporto</emphasis> e <emphasis>Url
					Based</emphasis>. L'applicativo server, invece, riceve le informazioni dal
				gateway solamente tramite la modalità <emphasis>Trasporto</emphasis>. </para>

			<sect3 id="header-integrazione-server">
				<title>Scambio di informazioni nella richiesta inoltrata dal gateway al
					server</title>
				<para> Le informazioni fornite dal gateway all'applicativo erogatore, sia per quanto
					concerne fruizioni che per erogazioni, sono riassunte nella tabella <xref
						linkend="scambioInfoGatewayServerComuni"/>.</para>
				<table id="scambioInfoGatewayServerComuni">
					<title>Scambio di informazioni nella richiesta inoltrata dal gateway al
						server</title>
					<tgroup align="left" cols="2" colsep="1" rowsep="1">
						<colspec colname="NomeHeaderTrasporto"/>
						<colspec colname="Descrizione"/>
						<thead>
							<row>
								<entry>Nome Header Trasporto</entry>
								<entry>Descrizione</entry>
							</row>
						</thead>
						<tbody>
							<row>
								<entry>GovWay-Message-ID</entry>
								<entry>Identificativo del messaggio assegnato da GovWay</entry>
							</row>
							<row>
								<entry>GovWay-Relates-To</entry>
								<entry>Identificativo del messaggio riferito</entry>
							</row>
							<row>
								<entry>GovWay-Conversation-ID</entry>
								<entry>Identificativo della conversazione</entry>
							</row>
							<row>
								<entry>GovWay-Transaction-ID</entry>
								<entry>Identificativo della transazione assegnato da GovWay</entry>
							</row>
						</tbody>
					</tgroup>
				</table>
				<para>Inoltre, solamente per quanto concerne le erogazioni, all'applicativo interno
					al dominio vengono inoltrate ulteriori meta-informazioni riguardanti la
					transazione gestita sul gateway descritte nella tabella <xref
						linkend="scambioInfoGatewayServerErogazione"/>. <table
						id="scambioInfoGatewayServerErogazione">
						<title>Scambio di informazioni nella richiesta inoltrata dal gateway al
							server per una Erogazione</title>
						<tgroup align="left" cols="2" colsep="1" rowsep="1">
							<colspec colname="Header"/>
							<colspec colname="Descrizione"/>
							<thead>
								<row>
									<entry>Header</entry>
									<entry>Descrizione</entry>
								</row>
							</thead>
							<tbody>
								<row>
									<entry>GovWay-Sender-Type</entry>
									<entry>Codice che identifica il tipo del mittente</entry>
								</row>
								<row>
									<entry>GovWay-Sender</entry>
									<entry>Identificativo del mittente</entry>
								</row>
								<row>
									<entry>GovWay-Provider-Type</entry>
									<entry>Codice che identifica il tipo del destinatario</entry>
								</row>
								<row>
									<entry>GovWay-Provider</entry>
									<entry>Identificativo del destinatario</entry>
								</row>
								<row>
									<entry>GovWay-Service-Type</entry>
									<entry>Codice che identifica il tipo del servizio</entry>
								</row>
								<row>
									<entry>GovWay-Service</entry>
									<entry>Identificativo del servizio</entry>
								</row>
								<row>
									<entry>GovWay-Service-Version</entry>
									<entry>Progressivo di versione del servizio</entry>
								</row>
								<row>
									<entry>GovWay-Action</entry>
									<entry>Identificativo dell'azione</entry>
								</row>
								<row>
									<entry>GovWay-Application-Message-ID</entry>
									<entry>Identificativo del messaggio assegnato
										dall'applicativo</entry>
								</row>
								<row>
									<entry>GovWay-Application</entry>
									<entry>Identificativo dell'applicativo</entry>
								</row>
							</tbody>
						</tgroup>
					</table>
				</para>
			</sect3>

			<sect3 id="header-integrazione-risposta-client">
				<title>Scambio di informazioni tra gateway e la risposta ritornata al client</title>
				<para> Le informazioni fornite dal gateway all'applicativo fruitore, sia per quanto
					concerne fruizioni che per erogazioni, sono riassunte nella tabella <xref
						linkend="scambioInfoGatewayClientComuni"/>. <table
						id="scambioInfoGatewayClientComuni">
						<title>Scambio di informazioni tra gateway e la risposta ritornata al
							client</title>
						<tgroup align="left" cols="2" colsep="1" rowsep="1">
							<colspec colname="NomeHeaderTrasporto"/>
							<colspec colname="Descrizione"/>
							<thead>
								<row>
									<entry>Nome Header Trasporto</entry>
									<entry>Descrizione</entry>
								</row>
							</thead>
							<tbody>
								<row>
									<entry>GovWay-Message-ID</entry>
									<entry>Identificativo del messaggio assegnato da GovWay</entry>
								</row>
								<row>
									<entry>GovWay-Relates-To</entry>
									<entry>Identificativo del messaggio riferito</entry>
								</row>
								<row>
									<entry>GovWay-Conversation-ID</entry>
									<entry>Identificativo della conversazione</entry>
								</row>
								<row>
									<entry>GovWay-Application-Message-ID</entry>
									<entry>Identificativo del messaggio assegnato dall'applicativo
										(solo nel caso di Fruizione)</entry>
								</row>
								<row>
									<entry>GovWay-Transaction-ID</entry>
									<entry>Identificativo della transazione assegnato da
										GovWay</entry>
								</row>
							</tbody>
						</tgroup>
					</table></para>
				<para>All'applicativo client vengono inoltre forniti ulteriori header http generati
					se l'applicativo erogatore non è disponibile o se sono stati attivati meccanismi
					di Rate Limiting (<xref linkend="gw-erogazione-ratelimiting"/>). <informaltable
						id="scambioInfoGatewayClientRateLimiting">
						<tgroup align="left" cols="3" colsep="1" rowsep="1">
							<colspec colname="NomeHeaderTrasporto"/>
							<colspec colname="Descrizione"/>
							<colspec colname="Funzionalita"/>
							<thead>
								<row>
									<entry>Nome Header Trasporto</entry>
									<entry>Descrizione</entry>
									<entry>Motivazione</entry>
								</row>
							</thead>
							<tbody>
								<row>
									<entry>Retry-After</entry>
									<entry>Indica al client il numero di secondi dopo i quali
										ripresentarsi poichè il servizio contattato non è al momento
										disponibile. </entry>
									<entry>Le principali cause della generazione di tale header sono
										imputabili alla non raggiungibilità un applicativo
										erogatore, alla violazione di politiche di RateLimiting o a
										quando un servizio è temporaneamente disabilitato</entry>
								</row>
								<row>
									<entry>X-RateLimit-Limit</entry>
									<entry>Indica il numero massimo di richieste
										effettuabili</entry>
									<entry>Rate-Limiting attivato con policy di tipo
										'NumeroRichieste-ControlloRealtime*' (<xref
											linkend="gw-erogazione-ratelimiting"/>)</entry>
								</row>
								<row>
									<entry>X-RateLimit-Remaining</entry>
									<entry>Numero di richieste rimanenti prima del prossimo
										reset</entry>
									<entry>Rate-Limiting attivato con policy di tipo
										'NumeroRichieste-ControlloRealtime*' (<xref
											linkend="gw-erogazione-ratelimiting"/>)</entry>
								</row>
								<row>
									<entry>X-RateLimit-Reset</entry>
									<entry>Numero di secondi mancante al prossimo reset</entry>
									<entry>Rate-Limiting attivato con policy di tipo
										'NumeroRichieste-ControlloRealtime*' (<xref
											linkend="gw-erogazione-ratelimiting"/>)</entry>
								</row>
								<row>
									<entry>GovWay-RateLimit-ConcurrentRequest-Limit</entry>
									<entry>Indica il numero massimo di richieste concorrenti
										inviabili</entry>
									<entry>Rate-Limiting attivato con policy di tipo
										'NumeroRichieste-RichiesteSimultanee' (<xref
											linkend="gw-erogazione-ratelimiting"/>)</entry>
								</row>
								<row>
									<entry>GovWay-RateLimit-ConcurrentRequest-Remaining</entry>
									<entry>Indica il numero massimo di richieste concorrenti ancora
										inviabili</entry>
									<entry>Rate-Limiting attivato con policy di tipo
										'NumeroRichieste-RichiesteSimultanee' (<xref
											linkend="gw-erogazione-ratelimiting"/>)</entry>
								</row>
								<row>
									<entry>GovWay-RateLimit-BandwithQuota-Limit</entry>
									<entry>Indica la massima banda occupabile</entry>
									<entry>Rate-Limiting attivato con policy di tipo
										'OccupazioneBanda-*' (<xref
											linkend="gw-erogazione-ratelimiting"/>)</entry>
								</row>
								<row>
									<entry>GovWay-RateLimit-BandwithQuota-Remaining</entry>
									<entry>Indica la banda ancora occupabile prima del prossimo
										reset</entry>
									<entry>Rate-Limiting attivato con policy di tipo
										'OccupazioneBanda-*' (<xref
											linkend="gw-erogazione-ratelimiting"/>)</entry>
								</row>
								<row>
									<entry>GovWay-RateLimit-BandwithQuota-Reset</entry>
									<entry>Numero di secondi mancante al prossimo reset</entry>
									<entry>Rate-Limiting attivato con policy di tipo
										'OccupazioneBanda-*' (<xref
											linkend="gw-erogazione-ratelimiting"/>)</entry>
								</row>
								<row>
									<entry>GovWay-RateLimit-AvgTimeResponse-Limit</entry>
									<entry>Tempo medio di risposta atteso</entry>
									<entry>Rate-Limiting attivato con policy di tipo
										'TempoMedioRisposta-*' (<xref
											linkend="gw-erogazione-ratelimiting"/>)</entry>
								</row>
								<row>
									<entry>GovWay-RateLimit-AvgTimeResponse-Reset</entry>
									<entry>Numero di secondi mancante al prossimo reset</entry>
									<entry>Rate-Limiting attivato con policy di tipo
										'TempoMedioRisposta-*' (<xref
											linkend="gw-erogazione-ratelimiting"/>)</entry>
								</row>
								<row>
									<entry>GovWay-RateLimit-TimeResponseQuota-Limit</entry>
									<entry>Tempo complessivo di risposta occupabile</entry>
									<entry>Policy creata con risorsa di tipo
										'TempoComplessivioRisposta' (<xref
											linkend="config-controllotraffico-registro-policy"
										/>)</entry>
								</row>
								<row>
									<entry>GovWay-RateLimit-TimeResponseQuota-Remaining</entry>
									<entry>Tempo di risposta ancora occupabile prima del prossimo
										reset</entry>
									<entry>Policy creata con risorsa di tipo
										'TempoComplessivioRisposta' (<xref
											linkend="config-controllotraffico-registro-policy"
										/>)</entry>
								</row>
								<row>
									<entry>GovWay-RateLimit-TimeResponseQuota-Reset</entry>
									<entry>Numero di secondi mancante al prossimo reset</entry>
									<entry>Policy creata con risorsa di tipo
										'TempoComplessivioRisposta' (<xref
											linkend="config-controllotraffico-registro-policy"
										/>)</entry>
								</row>
								<row>
									<entry>GovWay-RateLimit-RequestSuccessful-Limit,
										GovWay-RateLimit-RequestFailed-Limit,
										GovWay-RateLimit-Fault-Limit</entry>
									<entry>Indica il numero massimo di richieste
										effettuabili</entry>
									<entry>Policy creata rispettivamente con risorsa di tipo
										'NumeroRichiesteCompletateConSuccesso',
										'NumeroRichiesteFallite' e 'NumeroFaultApplicativi' (<xref
											linkend="config-controllotraffico-registro-policy"
										/>)</entry>
								</row>
								<row>
									<entry>GovWay-RateLimit-RequestSuccessful-Remaining,
										GovWay-RateLimit-RequestFailed-Remaining,
										GovWay-RateLimit-Fault-Remaining</entry>
									<entry>Numero di richieste rimanenti prima del prossimo
										reset</entry>
									<entry>Policy creata rispettivamente con risorsa di tipo
										'NumeroRichiesteCompletateConSuccesso',
										'NumeroRichiesteFallite' e 'NumeroFaultApplicativi' (<xref
											linkend="config-controllotraffico-registro-policy"
										/>)</entry>
								</row>
								<row>
									<entry>GovWay-RateLimit-RequestSuccessful-Reset,
										GovWay-RateLimit-RequestFailed-Reset,
										GovWay-RateLimit-Fault-Reset</entry>
									<entry>Numero di secondi mancante al prossimo reset</entry>
									<entry>Policy creata rispettivamente con risorsa di tipo
										'NumeroRichiesteCompletateConSuccesso',
										'NumeroRichiesteFallite' e 'NumeroFaultApplicativi' (<xref
											linkend="config-controllotraffico-registro-policy"
										/>)</entry>
								</row>
							</tbody>
						</tgroup>
					</informaltable>
				</para>
			</sect3>

			<sect3 id="header-integrazione-client">
				<title>Scambio di informazioni nella richiesta del client verso il gateway</title>
				<para> Le informazioni che possono essere fornite dal client al gateway sono
					riassunte nella tabella <xref linkend="scambioInfoClientGateway"/> e riguardano
					le modalità <emphasis>Trasporto</emphasis> e <emphasis>Url Based</emphasis>
					attive di default. <table id="scambioInfoClientGateway">
						<title>Scambio di informazioni nella richiesta del client verso il
							gateway</title>
						<tgroup align="left" cols="3" colsep="1" rowsep="1">
							<colspec colname="NomeHeaderTrasporto"/>
							<colspec colname="NomeUrlProperty"/>
							<colspec colname="Descrizione"/>
							<thead>
								<row>
									<entry>Nome Header Trasporto</entry>
									<entry>Nome Url Property</entry>
									<entry>Descrizione</entry>
								</row>
							</thead>
							<tbody>
								<row>
									<entry>GovWay-Action</entry>
									<entry>govway_action</entry>
									<entry>Identificativo dell'azione invocata. Tale informazione
										deve essere fornita dal client se il servizio è stato
										configurato in modalità di identificazione dell'azione
											<emphasis>input-based</emphasis>. (<xref
											linkend="identificazione-azione"/>)</entry>
								</row>
								<row>
									<entry>GovWay-Relates-To</entry>
									<entry>govway_relates_to</entry>
									<entry>Identificativo di un precedente messaggio a cui la
										richiesta in essere si riferisce. (<xref
											linkend="correlazioneTraMessaggi"/>)</entry>
								</row>
								<row>
									<entry>GovWay-Conversation-ID</entry>
									<entry>govway_conversation_id</entry>
									<entry>Identificativo di una conversazione a cui la richiesta in
										essere si riferisce (<xref linkend="correlazioneTraMessaggi"
										/>)</entry>
								</row>
							</tbody>
						</tgroup>
					</table>
				</para>
			</sect3>

			<sect3 id="header-integrazione-non-default">
				<title>Altri header di Integrazione</title>
				<para> Per attivare differenti header di integrazione è richiesto l'accesso alla
					govwayConsole in modalità <emphasis>avanzata</emphasis> (<xref
						linkend="interfaccia-avanzata"/>). </para>
				<note>
					<para>Gli header di trasporto relativi alle funzionalità di Rate-Limiting e
						Service-Unavailable, descritti nella sezione <xref
							linkend="header-integrazione-risposta-client"/>, vengono generati
						solamente nella modalità <emphasis>Header HTTP</emphasis>.</para>
				</note>
				<para> A partire dall'erogazione o fruizione già creata in precedenza accedendo
					tramite il link Gestione Configurazione presente nel dettaglio
					dell'erogazione/fruizione è possibile accedere a configurazioni specifiche come
					descritto in <xref linkend="config-specifica"/>. Accedendo in modalità avanzata
					compare una sezione precedentemente non documentata denominata <emphasis>Opzioni
						Avanzate</emphasis>. All'interno di tale sezione è possibile agire sulla
					configurazione della voce <emphasis>Metadati</emphasis> nella sezione
						<emphasis>Integrazione</emphasis>. In tale campo, per default non impostato,
					è possibile attivare gli header di integrazione desiderati utilizzando le
					seguenti keyword separate da virgola: <note>
						<para>Per ogni tipo di header di integrazione descritto di seguito, esiste
							una modalità normale ed una estesa (suffisso 'Ext'). Le due modalità si
							differenziano poichè nella modalità non estesa non vengono generati gli
							header nella richiesta inoltrata al server in una fruizione e quelli
							generati nella risposta ritornata al client in una erogazione. </para>
					</note>
					<itemizedlist>
						<listitem>
							<para><emphasis>trasporto</emphasis> o
								<emphasis>trasportoExt</emphasis>: header di trasporto descritti
								nelle precedenti sezioni.</para>
						</listitem>
						<listitem>
							<para><emphasis>urlBased</emphasis> o <emphasis>urlBasedExt</emphasis>:
								le informazioni precedentemente descritte vengono aggiunte alla url
								tramite i parametri descritti nella tabella <xref
									linkend="scambioInfoGatewayServerComuniUrlBased"/>
								<table id="scambioInfoGatewayServerComuniUrlBased">
									<title>Informazioni generate dal gateway nella url della
										richiesta inoltrata al server</title>
									<tgroup align="left" cols="2" colsep="1" rowsep="1">
										<colspec colname="NomeHeaderTrasporto"/>
										<colspec colname="Descrizione"/>
										<thead>
											<row>
												<entry>Nome Query URL Parameter</entry>
												<entry>Descrizione</entry>
											</row>
										</thead>
										<tbody>
											<row>
												<entry>govway_message_id</entry>
												<entry>Identificativo del messaggio assegnato da
												GovWay</entry>
											</row>
											<row>
												<entry>govway_relates_to</entry>
												<entry>Identificativo del messaggio riferito</entry>
											</row>
											<row>
												<entry>govway_conversation_id</entry>
												<entry>Identificativo della conversazione</entry>
											</row>
											<row>
												<entry>govway_transaction_id</entry>
												<entry>Identificativo della transazione assegnato da
												GovWay</entry>
											</row>
											<row>
												<entry>govway_sender_type</entry>
												<entry>Codice che identifica il tipo del
												mittente</entry>
											</row>
											<row>
												<entry>govway_sender</entry>
												<entry>Identificativo del mittente</entry>
											</row>
											<row>
												<entry>govway_provider_type</entry>
												<entry>Codice che identifica il tipo del
												destinatario</entry>
											</row>
											<row>
												<entry>govway_provider</entry>
												<entry>Identificativo del destinatario</entry>
											</row>
											<row>
												<entry>govway_service_type</entry>
												<entry>Codice che identifica il tipo del
												servizio</entry>
											</row>
											<row>
												<entry>govway_service</entry>
												<entry>Identificativo del servizio</entry>
											</row>
											<row>
												<entry>govway_service_version</entry>
												<entry>Progressivo di versione del servizio</entry>
											</row>
											<row>
												<entry>govway_action</entry>
												<entry>Identificativo dell'azione</entry>
											</row>
											<row>
												<entry>govway_application_message_id</entry>
												<entry>Identificativo del messaggio assegnato
												dall'applicativo</entry>
											</row>
											<row>
												<entry>govway_application</entry>
												<entry>Identificativo dell'applicativo</entry>
											</row>
										</tbody>
									</tgroup>
								</table>
							</para>
							<note>
								<para>Esiste una terza versione
										<emphasis>urlBasedOnlyRead</emphasis> che permette di
									attivare la lettura delle informazioni impostate
									dall'applicativo client ma non genera header verso l'applicativo
									server.</para>
							</note>

						</listitem>
						<listitem>
							<para><emphasis>soap</emphasis> o <emphasis>soapExt</emphasis>: le
								informazioni precedentemente descritte vengono incluse come
								attributi in uno specifico header SOAP proprietario di GovWay che
								possiede il nome <emphasis>integration</emphasis> associato al
								namespace <emphasis>http://govway.org/integration</emphasis>. Di
								seguito un esempio di tale header:
								<screen>&lt;gw:integration 
		...
		transactionId="a2c6fd66-ec0b-407c-8a21-25b4920e7c73"
		SOAP_ENV:actor="http://govway.org/integration" 
		SOAP_ENV:mustUnderstand="0" 
		xmlns:SOAP_ENV="http://schemas.xmlsoap.org/soap/envelope/"
		xmlns:gw="http://govway.org/integration"/></screen>
								Nella tabella <xref linkend="scambioInfoGatewayServerComuniSoap"/>
								vengono descritti i nome degli attributi. <table
									id="scambioInfoGatewayServerComuniSoap">
									<title>Informazioni generate dal gateway nell'header soap
										proprietario di GovWay</title>
									<tgroup align="left" cols="2" colsep="1" rowsep="1">
										<colspec colname="NomeHeaderTrasporto"/>
										<colspec colname="Descrizione"/>
										<thead>
											<row>
												<entry>Nome Attributo</entry>
												<entry>Descrizione</entry>
											</row>
										</thead>
										<tbody>
											<row>
												<entry>messageId</entry>
												<entry>Identificativo del messaggio assegnato da
												GovWay</entry>
											</row>
											<row>
												<entry>relatesTo</entry>
												<entry>Identificativo del messaggio riferito</entry>
											</row>
											<row>
												<entry>conversationId</entry>
												<entry>Identificativo della conversazione</entry>
											</row>
											<row>
												<entry>transactionId</entry>
												<entry>Identificativo della transazione assegnato da
												GovWay</entry>
											</row>
											<row>
												<entry>senderType</entry>
												<entry>Codice che identifica il tipo del
												mittente</entry>
											</row>
											<row>
												<entry>sender</entry>
												<entry>Identificativo del mittente</entry>
											</row>
											<row>
												<entry>providerType</entry>
												<entry>Codice che identifica il tipo del
												destinatario</entry>
											</row>
											<row>
												<entry>provider</entry>
												<entry>Identificativo del destinatario</entry>
											</row>
											<row>
												<entry>serviceType</entry>
												<entry>Codice che identifica il tipo del
												servizio</entry>
											</row>
											<row>
												<entry>service</entry>
												<entry>Identificativo del servizio</entry>
											</row>
											<row>
												<entry>serviceVersion</entry>
												<entry>Progressivo di versione del servizio</entry>
											</row>
											<row>
												<entry>action</entry>
												<entry>Identificativo dell'azione</entry>
											</row>
											<row>
												<entry>applicationMessageId</entry>
												<entry>Identificativo del messaggio assegnato
												dall'applicativo</entry>
											</row>
											<row>
												<entry>application</entry>
												<entry>Identificativo dell'applicativo</entry>
											</row>
										</tbody>
									</tgroup>
								</table>
								<note>
									<para>Utilizzabile solamente con API di tipologia SOAP</para>
								</note>
							</para>
						</listitem>
						<listitem>
							<para><emphasis>wsa</emphasis> o <emphasis>wsaExt</emphasis>:
								all'interno del messaggio Soap vengono generati gli header
									<emphasis>To</emphasis>, <emphasis>From</emphasis>,
									<emphasis>Action</emphasis>, <emphasis>MessageID</emphasis> e
									<emphasis>RelatesTo</emphasis> associati al namespace
									<emphasis>http://www.w3.org/2005/08/addressing</emphasis>. I
								valori utilizzati per i vari header sono i seguenti: <itemizedlist>
									<listitem>
										<para><emphasis>To</emphasis>,
											http://&lt;providerType>_&lt;provider>.govway.org/services/&lt;serviceType>_&lt;service>/&lt;serviceVersion></para>
									</listitem>
									<listitem>
										<para><emphasis>From</emphasis>,
											http://[&lt;application>.]&lt;senderType>_&lt;sender>.govway.org</para>
									</listitem>
									<listitem>
										<para><emphasis>Action</emphasis>,
											http://&lt;providerType>_&lt;provider>.govway.org/services/&lt;serviceType>_&lt;service>/&lt;serviceVersion>/&lt;action></para>
									</listitem>
									<listitem>
										<para><emphasis>MessageID</emphasis>, uuid:&lt;messageId> in
											caso di Messaggio di Protocollo (restituzione di una
											risposto lato PD o in caso di consegna tramite PA),
											uuid:&lt;applicationMessageId> in caso di Messaggio di
											Integrazione (invocazione lato PD o lettura risposta
											lato PA, es. per correlazione applicativa) </para>
									</listitem>
									<listitem>
										<para><emphasis>RelatesTo</emphasis>,
											uuid:&lt;relatesTo></para>
									</listitem>
								</itemizedlist>
								<note>
									<para>Utilizzabile solamente con API di tipologia SOAP</para>
								</note>
							</para>
						</listitem>
					</itemizedlist>
				</para>
			</sect3>
		</sect2>

		<sect2 id="gateway-problem">
			<title>Errori Generati dal Gateway</title>
			<para> La gestione dei casi di errore nelle comunicazioni mediate da un Gateway devono
				tenere conto di ulteriori situazioni che possono presentarsi rispetto alla
				situazione di dialogo diretto tra gli applicativi. Oltre agli errori conosciuti
				dagli applicativi, e quindi previsti nei descrittori del servizio, gli applicativi
				client possono ricevere ulteriori errori generati dal gateway. </para>
			<para>Govway genera differenti errori a seconda se l'erogazione o la fruizione riguarda
				una API di tipologia SOAP (sezione <xref linkend="gateway-problem-soap"/>) o REST
				(sezione <xref linkend="gateway-problem-rest"/>). </para>
			<para>Per entrambe le tipologie, all'interno dell'errore generato, viene ritornato al
				client un codice di errore che rappresenta una classificazione interna a GovWay
				dell'errore avvenuto. Nella sezione <xref linkend="gateway-problem-code"/> vengono
				riportate due tabelle che descrivono cosa rappresentano tali codici.</para>

			<sect3 id="gateway-problem-rest">
				<title>REST Problem Details (RFC 7807)</title>
				<para>Quando il Gateway non può completare con successo la gestione della
					transazione in corso genera un oggetto <emphasis>Problem Details</emphasis> come
					definito nella specifica <emphasis>RFC 7807</emphasis> (<ulink
						url="https://tools.ietf.org/html/rfc7807"
						>https://tools.ietf.org/html/rfc7807</ulink>). </para>
				<para>Di seguito viene riportato un esempio di tale oggetto:
					<screen>{
  "type": "https://httpstatuses.com/401",
  "title": "Unauthorized",
  "status": 401,
  "detail": "Token non valido",
  "govway_status": "integration:GOVWAY-444"
}</screen>
				</para>
				<para> L'elemento <emphasis>type</emphasis> presenta sempre il suffisso
						<emphasis>https://httpstatuses.com/</emphasis> seguito poi dal codice http
					ritornato al client, riportato anche nell'elemento <emphasis>status</emphasis>.
					L'elemento <emphasis>title</emphasis> contiene invece la descrizione http del
					codice ritornato al client. </para>
				<para> Nell'elemento <emphasis>detail</emphasis> sono presenti informazioni di
					dettaglio sull'errore avvenuto, errore codificato dal codice presente
					nell'elemento <emphasis>govway_status</emphasis>. (Per ulteriori dettagli sul
					codice consultare la sezione <xref linkend="gateway-problem-code"/>). </para>
				<para> La casistica dei possibili errori generati dal gateway viene riportata nella
					tabella <xref linkend="gateway-problem-rest-code"/>. <table
						id="gateway-problem-rest-code">
						<title>Casistica Problem Details per API REST</title>
						<tgroup align="left" cols="2" colsep="1" rowsep="1">
							<colspec colname="HTTPStatus"/>
							<colspec colname="Descrizione"/>
							<thead>
								<row>
									<entry>HTTP Status</entry>
									<entry>Descrizione</entry>
								</row>
							</thead>
							<tbody>
								<row>
									<entry>401</entry>
									<entry>Rientrano in questa casistica gli errori avenuti durante
										le fasi di autenticazione degli applicativi (<xref
											linkend="autenticazione"/>) e di verifica del token
										OAuth (<xref linkend="gestione-token"/>)</entry>
								</row>
								<row>
									<entry>403</entry>
									<entry>In questa categoria rientrano errori avvenuti durante la
										fase di autorizzazione descritta nella sezione <xref
											linkend="Autorizzazione"/></entry>
								</row>
								<row>
									<entry>404</entry>
									<entry>Identifica la richiesta di una erogazione o fruizione
										inesistente</entry>
								</row>
								<row>
									<entry>400</entry>
									<entry>L'errore occorso è imputabile ai dati forniti dal client
										(es. messaggio non valido in caso di validazione
										attiva)</entry>
								</row>
								<row>
									<entry>429</entry>
									<entry>Identifica una violazione della politica di Rate Limiting
											(<xref linkend="gw-erogazione-ratelimiting"/>)</entry>
								</row>
								<row>
									<entry>503</entry>
									<entry>Rientrano in questa casistica gli errori causati da una
										irraggiungibilità dell'applicativo indirizzato dal Gateway o
										una temporanea sospensione della erogazione/fruzione</entry>
								</row>
								<row>
									<entry>500</entry>
									<entry>Qualsiasi altro errore</entry>
								</row>
							</tbody>

						</tgroup>
					</table>
				</para>
				<note>
					<title>HTTP Content Negotiation</title>
					<para> L'oggetto <emphasis>Problem Details</emphasis> generato dal Gateway
						possiede per default il formato <emphasis>json</emphasis>. </para>
					<para> Viene utilizzato il formato <emphasis>xml</emphasis> (Appendice 'A' del
						RFC 7807) solamente se la richiesta presenta anch'essa tale formato. </para>
					<para> Un applicativo client può indicare al Gateway quale formato desidera
						attraverso l'header http <emphasis>Accept</emphasis>. </para>
				</note>
			</sect3>

			<sect3 id="gateway-problem-soap">
				<title>SOAP Fault</title>
				<para>Per le API di tipologia SOAP, sia in erogazione che in fruizione, quando il
					Gateway non può completare con successo la gestione della transazione in corso
					genera un SOAPFault contenente un actor (o role in SOAP 1.2) valorizzato con
						<emphasis>http://govway.org/integration</emphasis>. </para>
				<para>Di seguito viene riportato un esempio di tale oggetto:
					<screen>&lt;?xml version="1.0" encoding="UTF-8"?>
&lt;SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/">
    &lt;SOAP-ENV:Body>
        &lt;SOAP-ENV:Fault>
            &lt;faultcode xmlns:integration="http://govway.org/integration/fault">integration:GOVWAY-403&lt;/faultcode>
            &lt;faultstring>Identificazione dinamica dell'azione associata alla porta delegata fallita&lt;/faultstring>
            &lt;faultactor>http://govway.org/integration&lt;/faultactor>
            &lt;detail>
                &lt;problem xmlns="urn:ietf:rfc:7807">
                    &lt;type>https://httpstatuses.com/500&lt;/type>
                    &lt;title>Internal Server Error&lt;/title>
                    &lt;status>500&lt;/status>
                    &lt;detail>Identificazione dinamica dell'azione associata alla porta delegata fallita&lt;/detail>
                    &lt;govway_status>integration:GOVWAY-403&lt;/govway_status>
                &lt;/problem>
            &lt;/detail>
        &lt;/SOAP-ENV:Fault>
    &lt;/SOAP-ENV:Body>
&lt;/SOAP-ENV:Envelope></screen>
				</para>
				<para> L'elemento <emphasis>fault string</emphasis> contiene informazioni di
					dettaglio sull'errore avvenuto, errore codificato dal codice presente
					nell'elemento <emphasis>fault code</emphasis>. (Per ulteriori dettagli sul
					codice consultare la sezione <xref linkend="gateway-problem-code"/>). </para>
				<para> Il SOAP Fault contiene all'interno dell'elemento <emphasis>detail</emphasis>
					un oggetto <emphasis>Problem Details</emphasis> simile a quanto descritto nella
					sezione <xref linkend="gateway-problem-rest"/> utile a comprendere il codice di
					errore ed il dettaglio attraverso una modalità alternativa alla lettura degli
					elementi <emphasis>fault string</emphasis> e <emphasis>fault code</emphasis>
					(che varia a seconda della versione SOAP utilizzata). </para>
			</sect3>

			<sect3 id="gateway-problem-code">
				<title>Codici di Errore</title>
				<para>Di seguito vengono riportate le casistiche di errore che possono avvenire sul
					Gateway, con i relativi codici utilizzati all'interno dei formati di errore come
					descritto nelle sezioni <xref linkend="gateway-problem-rest"/> e <xref
						linkend="gateway-problem-soap"/>. <note>
						<title>Configurazioni Avanzate</title>
						<para>Alcuni degli errori riportati sono scaturiti da funzionalità
							disponibili nel Gateway attraverso configurazioni avanzate non descritte
							nel presente manuale. </para>
					</note>
					<informaltable id="gateway-problem-code-table" title="Casistiche di Errore">
						<tgroup align="left" cols="2" colsep="1" rowsep="1">
							<colspec colname="CodiceErrore" colwidth="270px"/>
							<colspec colname="Descrizione"/>
							<thead>
								<row>
									<entry>Codice</entry>
									<entry>Descrizione</entry>
								</row>
							</thead>
							<tbody>
								<row>
									<entry>integration:GOVWAY-401</entry>
									<entry>Identifica la richiesta di una erogazione o fruizione
										inesistente</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-402</entry>
									<entry>Rientrano in questa casistica gli errori avenuti durante
										la fase di autenticazione di una fruizione (<xref
											linkend="autenticazione"/>)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-403</entry>
									<entry>Azione non identificabile tramite i meccanismi
										configurati. (<xref linkend="identificazione-azione"
										/>)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-404</entry>
									<entry>Rientrano in questa casistica gli errori avenuti durante
										la fase di autorizzazione di una fruizione (<xref
											linkend="Autorizzazione"/>)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-405</entry>
									<entry>Servizio richiesto non esistente (richiede una
										configurazione non documentata)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-406</entry>
									<entry>Indica che non sono disponibili messaggi (richiede
										accesso alla MessageBox via Integration Manager,
										configurazione non documentata)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-407</entry>
									<entry>Il messaggio richiesto non esiste (richiede accesso alla
										MessageBox via Integration Manager, configurazione non
										documentata)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-408</entry>
									<entry>Indica che non esiste una API utilizzabile per correlare
										la richiesta con una precedente transazione (es. utilizzato
										con i profili asincroni descritti nella sezione <xref
											linkend="spcoopAsincroni"/>)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-409</entry>
									<entry>Indica che non è possibile correlare la richiesta con una
										precedente transazione (es. utilizzato con i profili
										asincroni descritti nella sezione <xref
											linkend="spcoopAsincroni"/>)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-410</entry>
									<entry>L'API invocata possiede il profilo <emphasis>asincrono
											simmetrico</emphasis> e la configurazione della
										fruizione non presenta meccanismi di autenticazione
										dell'applicativo client. L'identificazione di un applicativo
										fruitore &egrave; fondamentale nel profilo asincrono
										simmetrico per consegnare la risposta (<xref
											linkend="spcoopAsincroni"/>)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-411</entry>
									<entry>Indica una configurazione errata dove l'applicativo
										mittente non possiede una configurazione per la spedizione
										della risposta asincrona e l'API possiede il profilo
											<emphasis>asincrono simmetrico</emphasis> (<xref
											linkend="spcoopAsincroni"/>)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-412</entry>
									<entry>L'API è stata invocata senza fornire il riferimento ad un
										messaggio attualmente in carico sul Gateway, mentre la
										configurazione lo richiede. richiede una configurazione non
										documentata)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-413</entry>
									<entry>L'API è stata invocata fornendo il riferimento ad un
										messaggio attualmente in carico sul Gateway, mentre la
										configurazione non lo richiede. richiede una configurazione
										non documentata)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-414</entry>
									<entry>L'API invocata è stata configurata con un profilo
										differente da <emphasis>oneway</emphasis> e richiede la
										funzionalità di <emphasis>consegna in ordine</emphasis>
											(<xref linkend="profiliEgov"/>)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-415</entry>
									<entry>L'API invocata è stata configurata per utilizzare la
										funzionalità di <emphasis>consegna in ordine</emphasis> ma
										non presenta altre caratteristiche obbligatorie con questa
										funzionalit&agrave; (es.
										confermaRicezione,filtroDuplicati,collaborazione) (<xref
											linkend="profiliEgov"/>)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-416</entry>
									<entry>Rientrano in questa casistica gli errori avenuti durante
										la fase di correlazione applicativa della richiesta (<xref
											linkend="gw-erogazione-tracciamento-correlazione"
										/>)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-417</entry>
									<entry>Tale errore viene sollevato se l'interfaccia API e/o gli
										schemi associati (xsd,json,yaml) contengono errori che non
										ne consentono l'utilizzo durante la validazione dei
										contenuti (<xref linkend="gw-erogazione-validazione"
										/>)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-418</entry>
									<entry>La validazione dei contenuti ha rilevato una richiesta
										non conforme all'interfaccia API (<xref
											linkend="gw-erogazione-validazione"/>)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-419</entry>
									<entry>La validazione dei contenuti ha rilevato una risposta non
										conforme all'interfaccia API (<xref
											linkend="gw-erogazione-validazione"/>)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-420</entry>
									<entry>Viene sollevato questo errore se un applicativo invoca
										una fruizione di una API fornendo un messaggio contenente
										già un header di protocollo. (es. se viene inviato un
										messaggio contenente un'header eGov (<xref linkend="spcoop"
										/>)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-421</entry>
									<entry>Indica che il messaggio di richiesta fornito via
										Integration Manager non &egrave; un messaggio SOAP Valido
										(configurazione non documentata)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-422</entry>
									<entry>Il messaggio di richiesta presente nell'http body
										(Accesso al servizio out/xml2soap) o il messaggio indicato
										nella richiesta via IntegrationManager (Accesso al servizio
										via Integration Manager con imbustamento SOAP) non &egrave;
										utilizzabile, tramite la funzionalit&agrave; di
										Imbustamento, per ottenere un messaggio SOAP valido
										(configurazione non documentata)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-423</entry>
									<entry>L'azione identificata tramite i meccanismi configurati
										non risulta esistere all'interno dell'API invocata. (<xref
											linkend="identificazione-azione"/>)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-424</entry>
									<entry>La funzionalit&agrave; avanzata <emphasis>Allega
											Body</emphasis> ha generato un errore (configurazione
										non documentata)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-425</entry>
									<entry>La funzionalit&agrave; avanzata <emphasis>Scarta
											Body</emphasis> ha generato un errore (configurazione
										non documentata)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-426</entry>
									<entry>Errore generico che pu&ograve; avvenire durante la
										gestione della richiesta, dovuto comunque a dati forniti
										nella richiesta stessa (es. Valore SOAPAction
										scorretto)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-427</entry>
									<entry>Indica che il Gateway ha rilevato la presenza di
										SOAPHeader Element che non è in grado di processare e che
										richiedono obbligatoriamente il processamento
										(mustUnderstand=1 e actor non presente)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-428</entry>
									<entry>Rientrano in questa casistica gli errori avenuti durante
										la fase di autorizzazione del contenuto (configurazione non
										documentata)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-429</entry>
									<entry>Errore che viene ritornato dal Gateway se la richiesta
										presenta un header http <emphasis>Content-Type</emphasis>
										non supportato (per API SOAP)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-430</entry>
									<entry>Errore che viene ritornato dal Gateway se rileva una
										busta soap che possiede un namespace differente da quello
										atteso per la versione SOAP corrispondente al
											<emphasis>Content-Type</emphasis> (per API SOAP)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-431</entry>
									<entry>Rientrano in questa casistica gli errori avvenuti durante
										il recupero delle credenziali fornite tramite un Proxy
										(configurazione non documentata)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-432</entry>
									<entry>Errore che viene ritornato dal Gateway se la richiesta
										presenta un contenuto malformato (es. xml malformato in una
										API SOAP)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-433</entry>
									<entry>Indica che la richiesta non presenta un header http
											<emphasis>Content-Type</emphasis> (obbligatorio in API
										SOAP)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-434</entry>
									<entry>Rientrano in questa casistica gli errori avenuti durante
										la fase di correlazione applicativa della risposta (<xref
											linkend="gw-erogazione-tracciamento-correlazione"
										/>)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-435</entry>
									<entry>L'errore viene sollevato se viene rilevata una
										configurazione <emphasis>Local Forward</emphasis> non
										corretta (configurazione non documentata)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-436</entry>
									<entry>L'errore viene sollevato se viene rilevato un tipo di
										fruitore non supportato dalla modalità di utilizzo del
										Gateway fruita (configurazione non documentata)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-437</entry>
									<entry>L'errore viene sollevato se viene rilevato un tipo di
										erogatore non supportato dalla modalità di utilizzo del
										Gateway fruita (configurazione non documentata)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-438</entry>
									<entry>L'errore viene sollevato se viene rilevato un tipo di
										servizio non supportato dalla modalità di utilizzo del
										Gateway fruita (configurazione non documentata)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-439</entry>
									<entry>L'errore viene sollevato se viene rilevata una
										configurazione che richiede una funzionalit&agrave; non
										supportata nella modalità di utilizzo del Gateway
										(configurazione non documentata)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-440</entry>
									<entry>Errore che viene ritornato dal Gateway se la risposta
										presenta un contenuto malformato (es. xml malformato in una
										API SOAP)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-441</entry>
									<entry>La richiesta indirizza una configurazione non invocabile
										direttamente, configurazione creata tramite le indicazioni
										descritte nella sezione <xref linkend="gw-erogazione-config"
										/></entry>
								</row>
								<row>
									<entry>integration:GOVWAY-442</entry>
									<entry>La richiesta pervenuta sul Gateway non presenta un
										riferimento ad una precedente transazione, mentre la
										configurazione lo richiede (<xref
											linkend="correlazioneTraMessaggi"/>). Nell'installazione
										di default del Gateway, l'errore indicato non viene mai
										sollevato poichè non è obbligatorio fornire il riferimento
										ad una precedente transazione. </entry>
								</row>
								<row>
									<entry>integration:GOVWAY-443</entry>
									<entry>L'errore viene ritornato dal Gateway se non viene
										rilevato un token durante l'invocazione di una fruizione
											(<xref linkend="gestione-token"/>)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-444</entry>
									<entry>L'errore viene ritornato dal Gateway se viene rilevato un
										token non valido durante l'invocazione di una fruizione
											(<xref linkend="gestione-token"/>)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-445</entry>
									<entry>Rientrano in questa casistica gli errori avenuti durante
										la fase di autorizzazione di una fruizione, riguardanti la
										gestione di un token (<xref linkend="Autorizzazione"
										/>)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-446</entry>
									<entry>Il Gateway ritorna tale codice se la fruizione o
										l'erogazione invocata risulta sospesa</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-450</entry>
									<entry>La richiesta pervenuta sul Gateway non indirizza una
										erogazione specifica e non è utilizzabile per identificarne
										alcuna (configurazione non documentata)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-451</entry>
									<entry>Il soggetto invocato non esiste (configurazione non
										documentata)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-452</entry>
									<entry>Indica che il messaggio ricevuto è già stato gestito in
										precedenza (es. filtro duplicati attivo descritto nella
										sezione <xref linkend="spcoop"/>)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-453</entry>
									<entry>L'applicativo erogatore associato all'erogazione non
										esiste (configurazione non documentata)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-454</entry>
									<entry>Viene sollevato questo errore se il messaggio ritornato
										come risposta dall'applicativo erogatore, in una erogazione,
										contiene già un header di protocollo. (es. se viene
										ritornato un messaggio contenente un'header eGov (<xref
											linkend="spcoop"/>)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-455</entry>
									<entry>L'errore indica che la richiesta presenta al suo interno
										degli identificativi di API differenti da quelli
										dell'erogazione invocata (es. busta eGov contiene dei dati
										di servizio non allineati all'erogazione invocata)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-500</entry>
									<entry>Errore generico</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-516</entry>
									<entry>Errore ritornato dal gateway se non riesce ad inoltrare
										il messaggio all'endpoint configurato</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-517</entry>
									<entry>Errore ritornato dal gateway se non viene ritornata una
										risposta dall'endpoint contattato e il profilo ne prevede
										una (es. profilo sincrono nelle API SOAP)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-518</entry>
									<entry>Indica che l'applicativo erogatore ha ritornato un
										SOAPFault (API SOAP)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-537</entry>
									<entry>La richiesta pervenuta &egrave; gi&agrave; presente in
										carico sul Gateway ed è attualmente in fase di processamento
										(configurazione non documentata)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-538</entry>
									<entry>La richiesta asincrona pervenuta &egrave; gi&agrave;
										presente in carico sul Gateway ed è attualmente in fase di
										processamento (configurazione non documentata)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-539</entry>
									<entry>La ricevuta della richiesta asincrona pervenuta &egrave;
										gi&agrave; presente in carico sul Gateway ed è attualmente
										in fase di processamento (configurazione non
										documentata)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-CC00</entry>
									<entry>Errore generico avvenuto durante la gestione del
										Controllo del Traffico (<xref
											linkend="config-controllotraffico"/>)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-CC01</entry>
									<entry>Il Gateway ha rilevato il superamento del massimo numero
										di richieste simultanee configurato (<xref
											linkend="config-controllotraffico-maxlimit"/>)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-CP00</entry>
									<entry>Indica che la funzionalità di Rate-Limiting ha rilevato
										una policy sconosciuta (<xref
											linkend="config-controllotraffico-ratelimiting"
										/>)</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-CP01</entry>
									<entry>Indica che la funzionalità di Rate-Limiting ha rilevato
										una violazione di una policy di tipo
										'NumeroRichieste-RichiesteSimultanee' (<xref
											linkend="config-controllotraffico-ratelimiting"/>). Il
										codice di errore può presentare il suffisso
											<emphasis>-CC</emphasis> se la policy è configurata
										insieme a controlli di congestione e/o il suffisso
											<emphasis>-DP</emphasis> se configurata con meccanismi
										di degrado.</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-ERR-CP01</entry>
									<entry>Errore emerso durante la gestione da parte del Gateway
										della policy di Rate-Limiting di tipo
										'NumeroRichieste-RichiesteSimultanee' (<xref
											linkend="config-controllotraffico-ratelimiting"
										/>).</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-CP02</entry>
									<entry>Indica che la funzionalità di Rate-Limiting ha rilevato
										una violazione di una policy di tipo
										'NumeroRichieste-ControlloRealtime*' (<xref
											linkend="gw-erogazione-ratelimiting"/>). Il codice di
										errore può presentare il suffisso <emphasis>-CC</emphasis>
										se la policy è configurata insieme a controlli di
										congestione e/o il suffisso <emphasis>-DP</emphasis> se
										configurata con meccanismi di degrado (<xref
											linkend="config-controllotraffico-ratelimiting"
										/>).</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-ERR-CP02</entry>
									<entry>Errore emerso durante la gestione da parte del Gateway
										della policy di Rate-Limiting di tipo
										'NumeroRichieste-ControlloRealtime*' (<xref
											linkend="gw-erogazione-ratelimiting"/>).</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-CP03</entry>
									<entry>Indica che la funzionalità di Rate-Limiting ha rilevato
										una violazione di una policy di tipo 'OccupazioneBanda-*'
											(<xref linkend="gw-erogazione-ratelimiting"/>). Il
										codice di errore può presentare il suffisso
											<emphasis>-CC</emphasis> se la policy è configurata
										insieme a controlli di congestione e/o il suffisso
											<emphasis>-DP</emphasis> se configurata con meccanismi
										di degrado (<xref
											linkend="config-controllotraffico-ratelimiting"
										/>).</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-ERR-CP03</entry>
									<entry>Errore emerso durante la gestione da parte del Gateway
										della policy di Rate-Limiting di tipo 'OccupazioneBanda-*'
											(<xref linkend="gw-erogazione-ratelimiting"/>).</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-CP04</entry>
									<entry>Indica che la funzionalità di Rate-Limiting ha rilevato
										una violazione di una policy di tipo
										'TempoComplessivioRisposta' (<xref
											linkend="config-controllotraffico-ratelimiting"/>). Il
										codice di errore può presentare il suffisso
											<emphasis>-CC</emphasis> se la policy è configurata
										insieme a controlli di congestione e/o il suffisso
											<emphasis>-DP</emphasis> se configurata con meccanismi
										di degrado.</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-ERR-CP04</entry>
									<entry>Errore emerso durante la gestione da parte del Gateway
										della policy di Rate-Limiting di tipo
										'TempoComplessivioRisposta' (<xref
											linkend="config-controllotraffico-ratelimiting"
										/>).</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-CP05</entry>
									<entry>Indica che la funzionalità di Rate-Limiting ha rilevato
										una violazione di una policy di tipo 'TempoMedioRisposta-*'
											(<xref linkend="gw-erogazione-ratelimiting"/>). Il
										codice di errore può presentare il suffisso
											<emphasis>-CC</emphasis> se la policy è configurata
										insieme a controlli di congestione e/o il suffisso
											<emphasis>-DP</emphasis> se configurata con meccanismi
										di degrado.</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-ERR-CP05</entry>
									<entry>Errore emerso durante la gestione da parte del Gateway
										della policy di Rate-Limiting di tipo 'TempoMedioRisposta-*'
											(<xref linkend="gw-erogazione-ratelimiting"/>).</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-CP06</entry>
									<entry>Indica che la funzionalità di Rate-Limiting ha rilevato
										una violazione di una policy di tipo
										'NumeroRichiesteCompletateConSuccesso' (<xref
											linkend="config-controllotraffico-ratelimiting"/>). Il
										codice di errore può presentare il suffisso
											<emphasis>-CC</emphasis> se la policy è configurata
										insieme a controlli di congestione e/o il suffisso
											<emphasis>-DP</emphasis> se configurata con meccanismi
										di degrado.</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-ERR-CP06</entry>
									<entry>Errore emerso durante la gestione da parte del Gateway
										della policy di Rate-Limiting di tipo
										'NumeroRichiesteCompletateConSuccesso' (<xref
											linkend="config-controllotraffico-ratelimiting"
										/>).</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-CP07</entry>
									<entry>Indica che la funzionalità di Rate-Limiting ha rilevato
										una violazione di una policy di tipo
										'NumeroRichiesteFallite' (<xref
											linkend="config-controllotraffico-ratelimiting"/>). Il
										codice di errore può presentare il suffisso
											<emphasis>-CC</emphasis> se la policy è configurata
										insieme a controlli di congestione e/o il suffisso
											<emphasis>-DP</emphasis> se configurata con meccanismi
										di degrado.</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-ERR-CP07</entry>
									<entry>Errore emerso durante la gestione da parte del Gateway
										della policy di Rate-Limiting di tipo
										'NumeroRichiesteFallite' (<xref
											linkend="config-controllotraffico-ratelimiting"
										/>).</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-CP08</entry>
									<entry>Indica che la funzionalità di Rate-Limiting ha rilevato
										una violazione di una policy di tipo
										'NumeroFaultApplicativi' (<xref
											linkend="config-controllotraffico-ratelimiting"/>). Il
										codice di errore può presentare il suffisso
											<emphasis>-CC</emphasis> se la policy è configurata
										insieme a controlli di congestione e/o il suffisso
											<emphasis>-DP</emphasis> se configurata con meccanismi
										di degrado.</entry>
								</row>
								<row>
									<entry>integration:GOVWAY-ERR-CP08</entry>
									<entry>Errore emerso durante la gestione da parte del Gateway
										della policy di Rate-Limiting di tipo
										'NumeroFaultApplicativi' (<xref
											linkend="config-controllotraffico-ratelimiting"
										/>).</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-109</entry>
									<entry>Rientrano in questa casistica gli errori avenuti durante
										la fase di autenticazione di una erogazione, se non vengono
										rilevate credenziali (<xref linkend="autenticazione"
										/>)</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-117</entry>
									<entry>Rientrano in questa casistica gli errori avenuti durante
										la fase di autenticazione di una erogazione, se vengono
										rilevate credenziali non corrette (<xref
											linkend="autenticazione"/>)</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-1350</entry>
									<entry>Rientrano in questa casistica eventuali errori generici
										avenuti durante la fase di autorizzazione di una erogazione
											(<xref linkend="Autorizzazione"/>) o sicurezza del
										messaggio (<xref linkend="gw-erogazione-security"/>)</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-1351</entry>
									<entry>L'errore viene ritornato dal Gateway se viene rilevato
										che il messaggio presenta al suo interno un mittente
										differente da quello identificato dalle credenziali
										(configurazione non documentata)</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-1352</entry>
									<entry>Rientrano in questa casistica gli errori avenuti durante
										la fase di autorizzazione di una erogazione, quando la
										richieste non viene autorizzata (<xref
											linkend="Autorizzazione"/>)</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-[1353-1354]</entry>
									<entry>L'errore viene ritornato dal Gateway se viene rilevato
										che la firma della busta, prevista dalla modalità
										utilizzata, non è rispettivamente valida o presente
										(configurazione non documentata)</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-1355</entry>
									<entry>L'errore viene ritornato dal Gateway se viene rilevato
										che la firma del messaggio non è valida (<xref
											linkend="gw-erogazione-security"/>)</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-1356</entry>
									<entry>L'errore viene ritornato dal Gateway se viene rilevato
										che il messaggio non è firmato (<xref
											linkend="gw-erogazione-security"/>)</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-[1357-1360]</entry>
									<entry>L'errore viene ritornato dal Gateway se viene rilevato
										che la firma degli allegati non sono valide o presenti
										(configurazione non documentata)</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-1361</entry>
									<entry>L'errore viene ritornato dal Gateway se viene rilevato
										che la cifratura del messaggio non è valida (<xref
											linkend="gw-erogazione-security"/>)</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-1362</entry>
									<entry>L'errore viene ritornato dal Gateway se viene rilevato
										che il messaggio non è cifrato (<xref
											linkend="gw-erogazione-security"/>)</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-[1363-1364]</entry>
									<entry>L'errore viene ritornato dal Gateway se viene rilevato
										che le cifrature degli allegati non sono valide o presenti
										(configurazione non documentata)</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-1365</entry>
									<entry>L'errore viene ritornato dal Gateway se viene rilevato
										che il messaggio non contiene l'attesa configurazione di
										sicurezza (<xref linkend="gw-erogazione-security"/>)</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-1366</entry>
									<entry>L'errore viene ritornato dal Gateway se non viene
										rilevato un token durante l'invocazione di una erogazione
											(<xref linkend="gestione-token"/>)</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-1367</entry>
									<entry>L'errore viene ritornato dal Gateway se viene rilevato un
										token non valido durante l'invocazione di una erogazione
											(<xref linkend="gestione-token"/>)</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-1368</entry>
									<entry>Rientrano in questa casistica gli errori avenuti durante
										la fase di autorizzazione di una erogazione, riguardanti la
										gestione di un token (<xref linkend="Autorizzazione"
										/>)</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-[1-6]</entry>
									<entry>Rientrano in questa casistica gli errori generici
										avvenuti durante il processamento e la validazione di una
										richiesta di erogazione</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-[51-60]</entry>
									<entry>Gli errori che rientrano in questa casistica vengono
										generati durante la validazione della richiesta se sono
										presenti informazioni non valide per quanto concerne gli
										attributi <emphasis>mustUnderstand</emphasis> e
											<emphasis>actor</emphasis> di un header SOAP (es. busta
										egov nella modalità descritta in <xref linkend="spcoop"
										/>)</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-[100-120]</entry>
									<entry>Errore rilevato durante la validazione della richiesta
										che riguarda informazioni sul mittente (es. busta egov in
											<xref linkend="spcoop"/>)</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-[150-170]</entry>
									<entry>Errore rilevato durante la validazione della richiesta
										che riguarda informazioni sul destinatario (es. busta egov
										in <xref linkend="spcoop"/>)</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-[200-205]</entry>
									<entry>Errore rilevato durante la validazione della richiesta
										che riguarda informazioni sul profilo di collaborazione (es.
										busta egov in <xref linkend="spcoop"/>)</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-[250-265]</entry>
									<entry>Errore rilevato durante la validazione della richiesta
										che riguarda informazioni sul servizio (es. busta egov in
											<xref linkend="spcoop"/>)</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-[300-315]</entry>
									<entry>Errore rilevato durante la validazione della richiesta
										che riguarda informazioni sulla correlazione asincrona (es.
										busta egov in <xref linkend="spcoop"/>)</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-[350-355]</entry>
									<entry>Errore rilevato durante la validazione della richiesta
										che riguarda informazioni sulla collaborazione (es. busta
										egov in <xref linkend="spcoop"/>)</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-[400-406]</entry>
									<entry>Errore rilevato durante la validazione della richiesta
										che riguarda informazioni sull'azione (es. busta egov in
											<xref linkend="spcoop"/>)</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-[450-455]</entry>
									<entry>Errore rilevato durante la validazione della richiesta
										che riguarda informazioni sulla correlazione asincrona per
										quanto riguarda l'azione (es. busta egov in <xref
											linkend="spcoop"/>)</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-[500-506]</entry>
									<entry>Errore rilevato durante la validazione della richiesta
										che riguarda informazioni sull'identificativo messaggio (es.
										busta egov in <xref linkend="spcoop"/>)</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-[550-556]</entry>
									<entry>Errore rilevato durante la validazione della richiesta
										che riguarda informazioni sul riferimento messaggio (es.
										busta egov in <xref linkend="spcoop"/>)</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-[600-610]</entry>
									<entry>Errore rilevato durante la validazione della richiesta
										che riguarda informazioni sull'ora registrazione (es. busta
										egov in <xref linkend="spcoop"/>)</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-[650-661]</entry>
									<entry>Errore rilevato durante la validazione della richiesta
										che riguarda informazioni sulla scandenza (es. busta egov in
											<xref linkend="spcoop"/>)</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-[700-717]</entry>
									<entry>Errore rilevato durante la validazione della richiesta
										che riguarda informazioni sul filtro duplicati e sulla
										conferma della ricezione (es. busta egov in <xref
											linkend="spcoop"/>)</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-[750-766]</entry>
									<entry>Errore rilevato durante la validazione della richiesta
										che riguarda informazioni sulla consegna in ordine (es.
										busta egov in <xref linkend="spcoop"/>)</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-[800-817]</entry>
									<entry>Errore rilevato durante la validazione della richiesta
										che riguarda informazioni sul servizio applicativo</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-[850-879]</entry>
									<entry>Errore rilevato durante la validazione della richiesta
										che riguarda informazioni sui riscontri (es. busta egov in
											<xref linkend="spcoop"/>)</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-[900-971]</entry>
									<entry>Errore rilevato durante la validazione della richiesta
										che riguarda informazioni sulla lista trasmissioni (es.
										busta egov in <xref linkend="spcoop"/>)</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-[1000-1035]</entry>
									<entry>Errore rilevato durante la validazione della richiesta
										che riguarda informazioni sulla lista eccezioni (es. busta
										egov in <xref linkend="spcoop"/>)</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-[1300-1329]</entry>
									<entry>Errore rilevato durante la validazione del messaggio per
										quanto concerne la parte di SOAPFault previsto dal
										protocollo (es. busta egov errore in <xref linkend="spcoop"
										/>)</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-[1400-1404]</entry>
									<entry>Errore rilevato durante la validazione del messaggio per
										quanto concerne la parte di attachments previsto dal
										protocollo (es. busta egov con attachments, <xref
											linkend="spcoop"/>)</entry>
								</row>
								<row>
									<entry>protocol:GOVWAY-2000</entry>
									<entry>Errore generico rilevato durante la validazione del
										messaggio</entry>
								</row>
							</tbody>

						</tgroup>
					</informaltable>
				</para>
			</sect3>

		</sect2>

		<sect2 id="connettori">
			<title>Connettori</title>
			<para> I connettori rappresentano le entità di configurazione che consentono a GovWay di
				indirizzare le comunicazioni verso gli attori dei flussi di erogazione/fruizione
				gestiti. Nel nostro contesto possiamo distinguere due tipologie di comunicazioni: <itemizedlist>
					<listitem>
						<para><emphasis>GovWay ---&gt; Applicativo Esterno</emphasis>, nel caso di
							fruizioni </para>
					</listitem>
					<listitem>
						<para><emphasis>GovWay ---&gt; Applicativo Interno</emphasis>, nel caso di
							erogazioni </para>
					</listitem>
				</itemizedlist>
			</para>
			<para> I connettori di GovWay permettono di configurare differenti aspetti della
				comunicazione http: <itemizedlist>
					<listitem>
						<para>
							<emphasis>Autenticazione http</emphasis>: tale funzionalità permette di
							impostare delle credenziali http basic (username e password).</para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Autenticazione https</emphasis>: se l'utente lo desidera può
							personalizzare tutti gli aspetti che riguardano una comunicazione sicura
							su https.</para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Proxy</emphasis>: è possibile configurare un proxy http che
							media la comunicazione.</para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Ridefinisci Tempi Risposta</emphasis>: permette di ridefinire
							i tempi di risposta che sono stati configurati a livello generale,
							nell'ambito del controllo del traffico (vedi <xref
								linkend="config-controllotraffico-tempirisposta"/>).</para>
					</listitem>
				</itemizedlist>
			</para>
			<para> Attivando la <emphasis>modalità avanzata</emphasis> dell'interfaccia saranno
				inoltre disponibili le seguenti opzioni: </para>
			<para>
				<itemizedlist>
					<listitem>
						<para>
							<emphasis>Data Transfer Mode</emphasis>: tramite questa configurazione è
							possibile indicare se la comunicazione deve avvenire in modalità
							transfer-encoding-chunked (streaming) o content length fisso. </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Redirect</emphasis>: tramite questa configurazione è possibile
							indicare se un eventuale redirect ritornato dal server contattato deve
							essere seguito o meno. </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Debug</emphasis>: è possibile abiltare un log verboso di tutta
							la comunicazione. </para>
					</listitem>
				</itemizedlist>
			</para>
			<para> La govwayConsole, tramite l'interfaccia in modalità
				<emphasis>avanzata</emphasis>, consente anche di configurare le comunicazioni
				attraverso connettori non basati sul protocollo HTTP (o HTTPS). GovWay offre
				built-in i seguenti ulteriori connettori: <itemizedlist>
					<listitem>
						<para>
							<emphasis>JMS</emphasis>: connettore basato sul protocollo JMS </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>File</emphasis>: connettore che permette di serializzare il
							messaggio di richiesta su FileSystem ed opzionalmente generare una
							risposta.</para>
					</listitem>
					<listitem>
						<para>
							<emphasis>Null</emphasis>: connettore per test. Si comporta come un
							servizio Oneway ricevendo richieste senza rispondere </para>
					</listitem>
					<listitem>
						<para>
							<emphasis>NullEcho</emphasis>: connettore per test. Si comporta come un
							servizio Sincrono rispondendo con un messaggio identico alla richiesta
						</para>
					</listitem>
				</itemizedlist> Nel seguito vengono descritte alcune funzionalità specifiche dei
				connettori HTTP e HTTPS. Inoltre viene fornita una descrizione del connettore
				built-in JMS. </para>
			<sect3 id="connettoreHTTP">
				<title>Connettore Http</title>
				<para>Quando si configura l'autenticazione per un connettore è possibile scegliere
					la modalità di autenticazione HTTP-BASIC. Tale funzionalità permette di
					impostare delle credenziali (username e password) che verranno iniettate nella
					comunicazione http tramite header 'Authorization'. </para>
				<para>
					<figure id="AutenticazioneHttp_fig">
						<title>Dati di configurazione di un'autenticazione Http</title>
						<mediaobject>
							<imageobject>
								<imagedata width="60%" fileref="FIGURE_OUT/AutenticazioneHTTP.pdf"/>
							</imageobject>
							<imageobject>
								<imagedata width="60%" fileref="FIGURE_OUT/AutenticazioneHTTP.jpg"/>
							</imageobject>
						</mediaobject>
					</figure>
				</para>
			</sect3>
			<sect3 id="connettoreHTTPS">
				<title>Autenticazione Https</title>
				<para> Il connettore HTTPS permette di personalizzare i parametri SSL per ogni
					connessione che utilizza questo protocollo. </para>
				<para> Il connettore HTTPS supporta: <itemizedlist>
						<listitem>
							<para>
								<emphasis role="bold">Autenticazione Server</emphasis>, è possibile
								definire le trusted keys e indicare se si desidera verificare
								l'hostname rispetto al certificato server contenuto nella sessione
								SSL. </para>
						</listitem>
						<listitem>
							<para>
								<emphasis role="bold">Autenticazione Client</emphasis>, è opzionale;
								se abilitata permette di definire il keystore contenente la chiave
								privata che si deve utilizzare durante la sessione SSL. </para>
						</listitem>
					</itemizedlist>
				</para>
				<para>
					<figure id="CreateConnettoreHTTPS_fig">
						<title>Dati di configurazione di un'autenticazione Https</title>
						<mediaobject>
							<imageobject>
								<imagedata width="60%" fileref="FIGURE_OUT/ConnettoreHTTPS.pdf"/>
							</imageobject>
							<imageobject>
								<imagedata width="60%" fileref="FIGURE_OUT/ConnettoreHTTPS.jpg"/>
							</imageobject>
						</mediaobject>
					</figure> Facendo riferimento alla maschera raffigurata in <xref
						linkend="CreateConnettoreHTTPS_fig"/> andiamo a descrivere il significato
					dei parametri: <itemizedlist>
						<listitem>
							<para>
								<emphasis>Connettore</emphasis>
								<itemizedlist>
									<listitem>
										<para>
											<emphasis role="bold">Url</emphasis>: indirizzo endpoint
											del connettore </para>
									</listitem>
									<listitem>
										<para>
											<emphasis role="bold">Tipologia</emphasis> (SSL, SSLv3,
											TLS e TLSv1): Tipo e versione del protocollo di
											trasporto (default: SSLv3) </para>
									</listitem>
									<listitem>
										<para>
											<emphasis role="bold">Hostname Verifier</emphasis>
											(true/false): Attiva la verifica in fase di
											autenticazione server della corrispondenza tra
											l'hostname indicato nella url e quello presente nel
											certificato server ritornato dal server (nel subject
											CN=hostname) </para>
									</listitem>
								</itemizedlist>
							</para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Autenticazione Server</emphasis>
								<itemizedlist>
									<listitem>
										<para>
											<emphasis role="bold">Path</emphasis>: Path dove è
											localizzato il truststore contenente i certificati
											server trusted. </para>
									</listitem>
									<listitem>
										<para>
											<emphasis role="bold">Tipo</emphasis> (jks, pkcs12,
											jceks, bks, uber e gkr): Tipologia del TrustStore
											(default: jks) </para>
									</listitem>
									<listitem>
										<para>
											<emphasis role="bold">Password</emphasis>: Password per
											l'accesso al TrustStore </para>
									</listitem>
									<listitem>
										<para>
											<emphasis role="bold">Algoritmo</emphasis>: Algoritmo di
											firma utilizzato (default: PKIX) </para>
									</listitem>
								</itemizedlist>
							</para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Autenticazione Client (opzionale)</emphasis>
								<itemizedlist>
									<listitem>
										<para>
											<emphasis role="bold">Dati di Accesso al
												KeyStore</emphasis> (usa valori del TrustStore,
											Ridefinisci): Consente di riutilizzare i medesimi
											riferimenti del TrustStore anche per il KeyStore o in
											alternativa ridefinirli. </para>
									</listitem>
									<listitem>
										<para>
											<emphasis role="bold">Tipo (solo se Dati di Accesso
												ridefiniti)</emphasis> (jks, pkcs12, jceks, bks,
											uber e gkr): Tipologia del Keystore (default: jks)
										</para>
									</listitem>
									<listitem>
										<para>
											<emphasis role="bold">Password (solo se Dati di Accesso
												ridefiniti)</emphasis>: Password per l'accesso al
											Keystore </para>
									</listitem>
									<listitem>
										<para>
											<emphasis role="bold">Password Chiave
											Privata</emphasis>: Password per accedere alla chiave
											privata presente nel keystore. </para>
									</listitem>
									<listitem>
										<para>
											<emphasis role="bold">Algoritmo</emphasis>: Algoritmo di
											firma utilizzato (default: SunX509) </para>
									</listitem>
								</itemizedlist>
							</para>
						</listitem>
					</itemizedlist>
				</para>
			</sect3>
			<sect3 id="proxyHTTP">
				<title>Proxy</title>
				<para>Funzionalità che consente di configurare un proxy http che media la
					comunicazione. Oltre ai classici parametri hostname e porta, è possibile anche
					indicare delle credenziali http basic (username e password) che verranno
					iniettate nella comunicazione http tramite header 'Proxy-Authorization'. </para>
				<para>
					<figure id="ProxyHttp_fig">
						<title>Dati di configurazione di un Proxy Http</title>
						<mediaobject>
							<imageobject>
								<imagedata width="60%" fileref="FIGURE_OUT/ProxyHTTP.pdf"/>
							</imageobject>
							<imageobject>
								<imagedata width="60%" fileref="FIGURE_OUT/ProxyHTTP.jpg"/>
							</imageobject>
						</mediaobject>
					</figure>
				</para>
			</sect3>
			<sect3 id="opzioniAvantateHttp">
				<title>Configurazione Http Avanzata</title>
				<para> Richiede accesso alla govwayConsole in modalità <emphasis>avanzata</emphasis>
				</para>
				<para> Tramite questa sezione è possibile indicare sia quale modalità di
					comunicazione (streaming o meno) deve essere utilizzata, sia se deve avvenire
					una eventuale gestione dei redirect http.</para>
				<para>
					<figure id="OpzioniAvanzateHttp_fig">
						<title>Configurazione http avanzata</title>
						<mediaobject>
							<imageobject>
								<imagedata width="60%" fileref="FIGURE_OUT/OpzioniAvanzateHttp.pdf"
								/>
							</imageobject>
							<imageobject>
								<imagedata width="60%" fileref="FIGURE_OUT/OpzioniAvanzateHttp.jpg"
								/>
							</imageobject>
						</mediaobject>
					</figure> Facendo riferimento alla maschera raffigurata in <xref
						linkend="OpzioniAvanzateHttp_fig"/> andiamo a descrivere il significato dei
					parametri: <itemizedlist>
						<listitem>
							<para>
								<emphasis>Data Transfer Mode</emphasis> tramite questa
								configurazione è possibile indicare se la comunicazione deve
								avvenire in modalità transfer-encoding-chunked (streaming) o con
								content length fisso. <itemizedlist>
									<listitem>
										<para>
											<emphasis role="bold">Modalità Data Transfer</emphasis>
											(default, content-length, transfer-encoding-chunked):
											indica il tipo di trasferimento dati; scegliendo la voce
											default verrà utilizzato il comportamento configurato a
											livello globale nel file govway.properties tramite le
											opzioni: <itemizedlist>
												<listitem>
												<para>org.openspcoop2.pdd.connettori.inoltroBuste.httpTransferLength</para>
												</listitem>
												<listitem>
												<para>org.openspcoop2.pdd.connettori.consegnaContenutiApplicativi.httpTransferLength</para>
												</listitem>
											</itemizedlist>
										</para>
									</listitem>
									<listitem>
										<para>
											<emphasis role="bold">Chunk Length (Bytes)</emphasis>
											(presente solamente se la modalità è
											transfer-encoding-chunked): indica la dimensione in
											bytes di ogni singolo http chunk.</para>
									</listitem>
								</itemizedlist>
							</para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Redirect</emphasis> tramite questa configurazione è
								possibile indicare se un eventuale redirect ritornato dal server
								contattato deve essere seguito o meno. <itemizedlist>
									<listitem>
										<para>
											<emphasis role="bold">Gestione Redirect</emphasis>
											(default, abilitato, disabilitato): consente di
											personalizzare il comportamento sul singolo connettore;
											scegliendo la voce default verrà utilizzato il
											comportamento configurato a livello globale nel file
											govway.properties tramite le opzioni: <itemizedlist>
												<listitem>
												<para>org.openspcoop2.pdd.connettori.inoltroBuste.followRedirects</para>
												</listitem>
												<listitem>
												<para>org.openspcoop2.pdd.connettori.consegnaContenutiApplicativi.followRedirects</para>
												</listitem>
											</itemizedlist>
										</para>
									</listitem>
									<listitem>
										<para>
											<emphasis role="bold">Massimo Numero di
												Redirect</emphasis> (presente solamente se la
											gestione redirect è abilitata): indica il massimo numero
											di redirect seguiti.</para>
									</listitem>
								</itemizedlist>
							</para>
						</listitem>
					</itemizedlist>
				</para>
			</sect3>
			<sect3 id="debugConnettore">
				<title>Debug</title>
				<para>Richiede accesso alla govwayConsole in modalità <emphasis>avanzata</emphasis>
						(<xref linkend="interfaccia-avanzata"/>). </para>
				<para>Se viene abilitato il debug, GovWay produce un log verboso di tutta la
					comunicazione nel file <itemizedlist>
						<listitem>
							<para>
								<emphasis>/var/log/govway/govway_connettori.log</emphasis></para>
						</listitem>
					</itemizedlist> (assumendo che <emphasis>/var/log/govway</emphasis> sia la
					directory di logging configurata)</para>
				<para>
					<figure id="DebugConnettore_fig">
						<title>Debug</title>
						<mediaobject>
							<imageobject>
								<imagedata width="60%" fileref="FIGURE_OUT/DebugConnettore.pdf"/>
							</imageobject>
							<imageobject>
								<imagedata width="60%" fileref="FIGURE_OUT/DebugConnettore.jpg"/>
							</imageobject>
						</mediaobject>
					</figure>
				</para>
			</sect3>
			<sect3 id="connettoreJMS">
				<title>Connettore JMS</title>
				<para>Il connettore JMS consente di configurare i parametri per abilitare la
					comunicazione tra GovWay e gli applicativi attraverso il protocollo JMS. </para>
				<para> In <xref linkend="CreateConnettoreJMS"/> è mostrata la maschera di
					configurazione del connettore JMS. </para>
				<figure id="CreateConnettoreJMS">
					<title>Dati di configurazione di un connettore JMS</title>

					<mediaobject>
						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/ConnettoreJMS.pdf"/>
						</imageobject>

						<imageobject>
							<imagedata width="60%" fileref="FIGURE_OUT/ConnettoreJMS.jpg"/>
						</imageobject>
					</mediaobject>
				</figure>
				<para> In riferimento alla <xref linkend="CreateConnettoreJMS"/> descriviamo in
					dettaglio il significato dei campi per la configurazione: <itemizedlist>
						<listitem>
							<para>
								<emphasis role="bold">Nome</emphasis>: identificatore JNDI della
								risorsa queue/topic JMS </para>
						</listitem>
						<listitem>
							<para>
								<emphasis role="bold">Tipo</emphasis> (Queue/Topic): Si specifica se
								la risorsa JMS è di tipo queue o topic </para>
						</listitem>
						<listitem>
							<para>
								<emphasis role="bold">Send As</emphasis> (TextMessage/BytesMessage):
								Si sceglie la codifica del messaggio da inviare tramite broker JMS,
								tra TextMessage e BytesMessage. </para>
						</listitem>
						<listitem>
							<para>
								<emphasis role="bold">Utente</emphasis>: Username relativo alle
								credenziali per l'autenticazione e la negoziazione di una
								connessione sul Broker JMS </para>
						</listitem>
						<listitem>
							<para>
								<emphasis role="bold">Password</emphasis>: Password relativa alle
								credenziali per l'autenticazione e la negoziazione di una
								connessione sul Broker JMS </para>
						</listitem>
						<listitem>
							<para>
								<emphasis role="bold">Connection Factory</emphasis>: Identificatore
								della risorsa JNDI per la creazione di una connessione verso il
								broker JMS </para>
						</listitem>
						<listitem>
							<para>
								<emphasis role="bold">Initial Context Factory</emphasis>: Class Name
								per l'inizializzazione del server JNDI per la lookup della
								Connection Factory e della Coda </para>
						</listitem>
						<listitem>
							<para>
								<emphasis role="bold">Url Pkg Prefixes</emphasis>: Lista sperata da
								':' per specificare i prefissi dei package da utilizzare per
								l'inizializzazione del Context JNDI </para>
						</listitem>
						<listitem>
							<para>
								<emphasis role="bold">Provider Url</emphasis>: Indirizzo che
								localizza il server JNDI </para>
						</listitem>
					</itemizedlist>
				</para>
			</sect3>

			<sect3 id="connettoreFILE">
				<title>Connettore File</title>
				<para> Il connettore permette di serializzare la richiesta su FileSystem ed
					opzionalmente di generare una risposta. </para>
				<para> Il connettore File supporta: <itemizedlist>
						<listitem>
							<para>
								<emphasis role="bold">Richiesta</emphasis>, è possibile serializzare
								il messaggio di richiesta su file-system fornendo un path che può
								contenere anche parti dinamiche risolte a runtime da GovWay. È
								permesso anche abilitare l'eventuale sovrascrittura del file, se
								risulta già esistente, e la creazione automatica delle directory
								padre, se non esistono.</para>
						</listitem>
						<listitem>
							<para>
								<emphasis role="bold">Risposta</emphasis>, è opzionale; se abilitata
								permette di generare una risposta costruita utilizzando il contenuto
								di un file indirizzabile a sua volta tramite gli stessi meccanismi
								dinamici della richiesta. Il file contenente la risposta può essere
								eliminato una volta consumato (opzione configurabile). L'utente può
								inoltre indicare un tempo di attesa (ms) qualora il file non sia
								immediatamente disponibile.</para>
						</listitem>
					</itemizedlist>
				</para>
				<para>
					<figure id="CreateConnettoreFILE_fig">
						<title>Dati di configurazione di un connettore File</title>
						<mediaobject>
							<imageobject>
								<imagedata width="60%" fileref="FIGURE_OUT/ConnettoreFILE.pdf"/>
							</imageobject>
							<imageobject>
								<imagedata width="60%" fileref="FIGURE_OUT/ConnettoreFILE.jpg"/>
							</imageobject>
						</mediaobject>
					</figure> Facendo riferimento alla maschera raffigurata in <xref
						linkend="CreateConnettoreFILE_fig"/> andiamo a descrivere il significato dei
					parametri: <itemizedlist>
						<listitem>
							<para>
								<emphasis>Richiesta</emphasis>
								<itemizedlist>
									<listitem>
										<para>
											<emphasis role="bold">File</emphasis>: indirizzo su
											file-system (path) dove verrà serializzato il messaggio
											di richiesta. È possibile fornire delle macro per creare
											dei path dinamici (per ulteriori dettagli vedi sezione
											'Informazioni Dinamiche'). </para>
									</listitem>
									<listitem>
										<para>
											<emphasis role="bold">File Headers</emphasis>
											(opzionale): indirizzo su file-system (path) dove
											verranno serializzati gli header di trasporto associati
											alla richiesta. È possibile fornire delle macro per
											creare dei path dinamici (per ulteriori dettagli vedi
											sezione 'Informazioni Dinamiche'). </para>
									</listitem>
									<listitem>
										<para>
											<emphasis role="bold">Overwrite If Exists</emphasis>
											(true/false): abilita l'eventuale sovrascrittura del
											file, se risulta già esistere. </para>
									</listitem>
									<listitem>
										<para>
											<emphasis role="bold">AutoCreate Parent
												Directory</emphasis> (true/false): abilita la
											creazione automatica delle directory padre, se non
											esistono.</para>
									</listitem>
								</itemizedlist>
							</para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Risposta (Opzionale)</emphasis>
								<itemizedlist>
									<listitem>
										<para>
											<emphasis role="bold">Generazione</emphasis>
											(true/false): abilita la generazione di una risposta.
											Tutte le successive opzioni della sezione 'Risposta'
											sono configurabili solamente se la generazione è
											abilitata.</para>
									</listitem>
									<listitem>
										<para>
											<emphasis role="bold">File</emphasis>: indirizzo su
											file-system (path) dove verrà letto il messaggio di
											risposta. È possibile fornire delle macro per creare dei
											path dinamici, come descritto più avanti al punto
											"Informazioni Dinamiche". </para>
									</listitem>
									<listitem>
										<para>
											<emphasis role="bold">File Headers</emphasis>
											(opzionale): indirizzo su file system (path) dove
											verranno letti gli header di trasporto da associare alla
											risposta. E' possibile fornire delle macro per creare
											dei path dinamici, come descritto più avanti al punto
											"Informazioni Dinamiche". </para>
									</listitem>
									<listitem>
										<para>
											<emphasis role="bold">Delete After Read</emphasis>
											(true/false): abilita l'eventuale eliminazione del file
											una volta utilizzato per la generazione della risposta.
										</para>
									</listitem>
									<listitem>
										<para>
											<emphasis role="bold">Wait Time If Not Exists
												(ms)</emphasis> (opzionale): indica un tempo di
											attesa (ms) qualora il file per la generazione della
											risposta non sia immediatamente disponibile.</para>
									</listitem>
								</itemizedlist>
							</para>
						</listitem>
						<listitem>
							<para>
								<emphasis>Informazioni Dinamiche</emphasis>. Per creare dei path
								dinamici rispetto alla transazione in corso di elaborazione, possono
								essere utilizzate le seguenti macro: <itemizedlist>
									<listitem>
										<para>
											<emphasis role="bold">{date:FORMAT}</emphasis> indica la
											data di elaborazione del messaggio. Il formato fornito
											deve essere conforme a quanto richiesto dalla classe
											java 'java.text.SimpleDateFormat'. Ad esempio:
											{date:yyyyMMdd_HHmmssSSS}.</para>
									</listitem>
									<listitem>
										<para>
											<emphasis role="bold">{transaction:id}</emphasis> indica
											l'identificativo della transazione (UUID).</para>
									</listitem>
									<listitem>
										<para>
											<emphasis role="bold">{busta:FIELD}</emphasis> permette
											di utilizzare informazioni di protocollo riguardanti la
											transazione in corso. Il valore 'FIELD' fornito deve
											rappresentare un field valido all'interno della classe
											di openspcoop 'org.openspcoop2.protocol.sdk.Busta'. Ad
											esempio per ottenere il mittente della busta usare
											{busta:mittente}.</para>
									</listitem>
									<!-- <listitem>
                    <para>
                      <emphasis role="bold">{context:KEY[.FIELD]}</emphasis> permette di utilizzare
                      informazioni presenti nel contesto della richiesta. Ad esempio per ottenere il
                      protocollo di gestione {context:PROTOCOLLO}.</para>
                  </listitem> -->
									<listitem>
										<para>
											<emphasis role="bold">{header:NAME}</emphasis> permette
											di utilizzare informazioni, relative alla transazione in
											corso, inserite negli header http generati da GovWay
											(maggiori dettagli in <xref
												linkend="header-integrazione"/>). Il valore 'NAME'
											indica il nome dell'header da utilizzare. Ad esempio per
											utilizzare il nome del mittente è possibile usare
											{header:GovWay-Sender}. Un altro esempio valido nello
											scenario della fatturazione elettronica (<xref
												linkend="sdi"/>) potrebbe essere quello di
											utilizzare il nome originale del file fattura
											utilizzando la sintassi
											{header:GovWay-SDI-NomeFile}</para>
									</listitem>
									<listitem>
										<para>
											<emphasis role="bold">{query:NAME}</emphasis> permette
											di utilizzare informazioni, relative alla transazione in
											corso, inserite nei query parameter aggiunti
											all'endpoint da GovWay (maggiori dettagli in <xref
												linkend="header-integrazione"/>). Il valore 'NAME'
											indica il nome della proprietà da utilizzare. Ad esempio
											per utilizzare il nome del mittente è possibile usare
											{query:govway_sender}.</para>
									</listitem>
									<listitem>
										<para>
											<emphasis role="bold">{property:NAME}</emphasis>
											permette di utilizzare informazioni, relative alla
											transazione in corso, specifiche della sezione relativa
											al profilo utilizzato all'interno della traccia (es.
											sezione 'Informazioni Fatturazione Elettronica'). Il
											valore 'NAME' indica il nome della proprietà da
											utilizzare. Un esempio valido nello scenario della
											fatturazione elettronica (<xref linkend="sdi"/>)
											potrebbe essere quello di utilizzare l'identificativo
											sdi utilizzando la sintassi
											{property:IdentificativoSdI}</para>
									</listitem>
								</itemizedlist>
							</para>
						</listitem>
					</itemizedlist>
				</para>
			</sect3>

		</sect2>

		<sect2 id="correlazioneTraMessaggi">
			<title>Correlazione tra transazioni differenti</title>

			<para>Richiede accesso alla govwayConsole in modalità <emphasis>avanzata</emphasis>
					(<xref linkend="interfaccia-avanzata"/>). </para>

			<para> Come descritto anche nella sezione <xref linkend="api-interfacce"/>, durante la
				configurazione di un API di tipo SOAP o REST è possibile specificare i parametri
				descritti di seguito rispettivamente in un servizio/azione o in una risorsa. <itemizedlist>
					<listitem>
						<para><emphasis>ID Collaborazione</emphasis>. Flag per consentire di
							specificare nelle richieste un valore che identifica una
							conversazione.</para>
					</listitem>
					<listitem>
						<para><emphasis>Riferimento ID Richiesta</emphasis>. Flag per consentire di
							specificare nelle richieste un identificativo relativo ad un messaggio
							precedente.</para>
					</listitem>
				</itemizedlist>
			</para>

			<para>Tali parametri consentono agli applicativi client di fornire tali informazioni
				tramite gli header di integrazione descritti nella sezione <xref
					linkend="header-integrazione-client"/></para>

			<para>Le informazioni fornite saranno associate alla traccia della transazione gestita,
				e quindi utilizzabili in fase di monitoraggio tramite le modalità di ricerca basate
				su identificativi descritte nella Guida alla Console di Monitoraggio.</para>

		</sect2>

		<sect2 id="autenticazionePrincipal">
			<title>Autenticazione e Autorizzazione Principal (Security Constraint)</title>

			<para>In precedenza, relativamente alla configurazione del controllo degli accessi, ed
				in particolare del meccanismo di autenticazione, si è indicata anche la possibilità
				di utilizzare il tipo <emphasis>principal</emphasis>. Questa configurazione richiede
				che l'autenticazione sia delegata all'application server o qualunque altra modalità
				che permetta a GovWay di accedere al principal tramite la api
					<emphasis>HttpServletRequest.getUserPrincipal()</emphasis>. </para>

			<para>In precedenza, relativamente all'autorizzazione, si è descritta la possibilità di
				utilizzare ruoli con fonte <emphasis>esterna</emphasis>. Questa fonte richiede che
				la gestione dei ruoli sia delegata all'Application Server o a qualunque altra
				modalità che permetta a GovWay di accedere ai ruoli tramite la api
					<emphasis>HttpServletRequest.isUserInRole()</emphasis>. </para>

			<para>Le modalità di configurazione di utenti e ruoli sull'application server variano in
				funzione della versione utilizzata e pertanto si rimanda alla documentazione del
				prodotto.</para>
			<para>È inoltre richiesto che l'applicazione utente sia protetta tramite un
					<emphasis>security-constraint</emphasis>. A tale scopo l'installazione di GovWay
				dispone di un contesto built-in <emphasis>govwaySec</emphasis> (definito nel war
				govwaySec.war/WEB-INF/web.xml) protetto tramite security constraint con metodo di
				autenticazione <emphasis>HTTP-BASIC</emphasis>:
				<screen>
    &lt;security-constraint>
            &lt;web-resource-collection>
                    &lt;web-resource-name>AuthenticationContainer&lt;/web-resource-name>
                    &lt;url-pattern>/*&lt;/url-pattern>
            &lt;/web-resource-collection>
            &lt;auth-constraint>
                    &lt;role-name>*&lt;/role-name>
            &lt;/auth-constraint>
    &lt;/security-constraint>

    ...

    &lt;security-role>
        &lt;role-name>*&lt;/role-name>
    &lt;/security-role>

    &lt;login-config>
        &lt;auth-method>BASIC&lt;/auth-method>
    &lt;/login-config>

</screen>
			</para>
			<para> Se si intende utilizzare una configurazione differente di quella built-in si deve
				procedere con la modifica di tale descrittore web.xml presente all'interno
				dell'archivio. </para>

			<note>
				<para>Con questo tipo di configurazione, le URL che gli applicativi devono invocare
					devono essere adeguate sostituendo il contesto <emphasis>govway</emphasis> con
						<emphasis>govwaySec</emphasis>. </para>
			</note>

		</sect2>

	</sect1>

</article>
