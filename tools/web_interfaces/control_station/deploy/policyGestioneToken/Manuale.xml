<config id="openspcoop" label="Configurazione Manuale" xmlns="http://www.openspcoop2.org/core/mvc/properties" 
	provider="org.openspcoop2.pdd.core.token.TokenProvider">

	<properties>
		<collection name="signaturePropRefId"/>
		<collection name="encryptionPropRefId"/>
		<collection name="signatureVerificationPropRefId"/>
		<collection name="decryptionPropRefId"/>
		<collection name="endpointConfig"/>
		<collection name="sslConfig"/>
	</properties>
	
	<section label="Informazioni Generali">
		
		<!--
		Se non definito viene preso il nome della policy creata  
		<item type="hidden" name="policyRealm" value="ValoreREALM">
			<property name="policy.realm" force="true"/>
		</item>
		-->
		<item type="hidden" name="policyGenericError" value="true">
			<property name="policy.genericError" force="true"/>
		</item>
				
		<subsection label="Token">
		
			<item type="select" name="tokenSource" label="Posizione" default="RFC6750" required="true" reloadOnChange="true">
				<values>
					<value value="RFC6750" label="RFC 6750 - Bearer Token Usage"/>
					<value value="RFC6750_header" label="RFC 6750 - Bearer Token Usage (Authorization Request Header Field)"/>
					<value value="RFC6750_form" label="RFC 6750 - Bearer Token Usage (Form-Encoded Body Parameter)"/>
					<value value="RFC6750_url" label="RFC 6750 - Bearer Token Usage (URI Query Parameter)"/>
					<value value="CUSTOM_header" label="Header HTTP"/>
					<value value="CUSTOM_url" label="Parametro URL"/>
				</values>
				<property name="policy.token.source" />
			</item>
			
			<item type="text" name="tokenSourceHeader" label="Nome Header HTTP" required="true">
				<conditions>
					<condition>
						<equals name="tokenSource" value="CUSTOM_header"/>
					</condition>
				</conditions>
			    <property name="policy.token.source.header" />
			</item>
			
			<item type="text" name="tokenSourceQueryParameter" label="Nome Parametro URL" required="true">
				<conditions>
					<condition>
						<equals name="tokenSource" value="CUSTOM_url"/>
					</condition>
				</conditions>
			    <property name="policy.token.source.queryParameter" />
			</item>
		
			<item type="select" name="tokenType" label="Tipo" default="opaque" required="true" reloadOnChange="true">
				<values>
					<value value="opaque" label="Opaco"/>
					<value value="jws" label="JWS"/>
					<value value="jwe" label="JWE"/>
				</values>
				<property name="policy.token.type" />
			</item>
			
		</subsection>
		
		<subsection label="Elaborazione Token">
		
			<item type="checkbox" name="validazioneJwtStato" label="Validazione JWT" defaultSelected="false" reloadOnChange="true">
				<conditions>
					<condition and="false">
						<equals name="tokenType" value="jws"/>
						<equals name="tokenType" value="jwe"/>
					</condition>
				</conditions>
				<property name="policy.validazioneJWT.stato" />
			</item>
			<item type="hidden" name="validazioneJwtSaveErrorInCache" value="false">
				<conditions>
					<condition and="false">
						<selected name="validazioneJwtStato" />
					</condition>
				</conditions>
				<property name="policy.validazioneJWT.saveErrorInCache"/>
			</item>
			
			<item type="checkbox" name="introspectionStato" label="Token Introspection" defaultSelected="false" reloadOnChange="true">
				<property name="policy.introspection.stato" />
			</item>			
			<item type="hidden" name="introspectionSaveErrorInCache" value="false">
				<conditions>
					<condition and="false">
						<selected name="introspectionStato" />
					</condition>
				</conditions>
				<property name="policy.introspection.saveErrorInCache"/>
			</item>
			
			<item type="checkbox" name="userInfoStato" label="OIDC - UserInfo" defaultSelected="false" reloadOnChange="true">
				<property name="policy.userInfo.stato" />
			</item>
			<item type="hidden" name="userInfoSaveErrorInCache" value="false">
				<conditions>
					<condition and="false">
						<selected name="userInfoStato" />
					</condition>
				</conditions>
				<property name="policy.userInfo.saveErrorInCache"/>
			</item>
			
			<item type="checkbox" name="tokenForwardStato" label="Token Forward" defaultSelected="false" reloadOnChange="true">
				<property name="policy.tokenForward.stato" />
			</item>
			
		</subsection>
		
		<subsection label="Endpoint Token">

			<conditions>
				<condition and="false">
					<selected name="introspectionStato"/>
					<selected name="userInfoStato" />
				</condition>
			</conditions>

			<item type="number" name="endpointConnectionTimeout" label="Connection Timeout" required="true" default="10000" min="1">
				<property name="connectionTimeout" properties="endpointConfig" />
			</item>
			<item type="number" name="endpointReadTimeout" label="Read Timeout" required="true" default="120000" min="1">
				<property name="readConnectionTimeout" properties="endpointConfig" />
			</item>
		
			<item type="checkbox" name="endpointHttps" label="Https" defaultSelected="false" reloadOnChange="true">
				<property name="policy.endpoint.https.stato" />
			</item>	
			
			<item type="checkbox" name="endpointProxy" label="Proxy" defaultSelected="false" reloadOnChange="true">
				<property name="policy.endpoint.proxy.stato" />
			</item>	
			
		</subsection>
				
	</section>

	<section label="Validazione JWT">
		
		<!--  JWS -->
		
		<conditions>
			<condition and="true">
				<selected name="validazioneJwtStato"/>
				<equals name="tokenType" value="jws"/>
			</condition>
		</conditions>
		
		<subsection label="TrustStore">

			<item type="select" name="validazioneJwtTruststoreType" label="Tipo" default="jks" required="true">
				<values>
					<value value="jks" label="JKS"/>
					<value value="pkcs12" label="PKCS12"/>
					<!--  <value value="jceks" label="JCEKS"/> -->
				</values>
				<property name="rs.security.keystore.type" properties="signatureVerificationPropRefId" />
			</item>
			<item type="text" name="validazioneJwtTruststoreFile" label="File" required="true">
			      	<property name="rs.security.keystore.file" properties="signatureVerificationPropRefId" />
			</item>
			<item type="text" name="validazioneJwtTruststorePassword" label="Password" required="true">
			      	<property name="rs.security.keystore.password" properties="signatureVerificationPropRefId" />
			</item>
			<item type="text" name="validazioneJwtTruststoreCertificateAlias" label="Alias Certificato" required="true">
			      	<property name="rs.security.keystore.alias" properties="signatureVerificationPropRefId" />
			</item>

		</subsection>

	</section>
	
	<section label="Validazione JWT">
		
		<!--  JWE -->
		
		<conditions>
			<condition and="true">
				<selected name="validazioneJwtStato"/>
				<equals name="tokenType" value="jwe"/>
			</condition>
		</conditions>
	
		<subsection label="KeyStore">

			<item type="select" name="validazioneJwtKeystoreType" label="Tipo" default="jks" required="true">
				<values>
					<value value="jks" label="JKS"/>
					<value value="pkcs12" label="PKCS12"/>
					<value value="jceks" label="JCEKS"/>
				</values>
				<property name="rs.security.keystore.type" properties="decryptionPropRefId" />
			</item>
			<item type="text" name="validazioneJwtKeystoreFile" label="File" required="true">
			      	<property name="rs.security.keystore.file" properties="decryptionPropRefId" />
			</item>
			<item type="text" name="validazioneJwtKeystorePassword" label="Password" required="true">
			      	<property name="rs.security.keystore.password" properties="decryptionPropRefId" />
			</item>
			<item type="text" name="validazioneJwtKeystorePrivateKeyAlias" label="Alias Chiave Privata" required="true">
			      	<property name="rs.security.keystore.alias" properties="decryptionPropRefId" />
			</item>
			<item type="text" name="validazioneJwtKeystorePrivateKeyPassword" label="Password Chiave Privata" required="true">
			      	<property name="rs.security.key.password" properties="decryptionPropRefId" />
			</item>

		</subsection>

	</section>
		
		
	<section label="Token Introspection">
		
		<conditions>
			<condition and="true">
				<selected name="introspectionStato"/>
			</condition>
		</conditions>

		<item type="select" name="introspectionEndpointType" label="Tipo" default="oauth2" required="true">
			<values>
				<value value="oauth2" label="RFC 7662 - OAuth 2.0"/>
				<value value="google" label="Google"/>
				<value value="custom" label="Personalizzato"/>
			</values>
			<property name="policy.introspection.endpoint.type" />
		</item>
		<item type="text" name="introspectionEndpointURL" label="URL" required="true" default="http://">
		      	<property name="policy.introspection.endpoint.url" />
		</item>
		
		<item type="checkbox" name="introspectionEndpointBasic" label="Autenticazione Http Basic" defaultSelected="false" reloadOnChange="true">
			<!--  non si puo' verificare una condizione successiva. Comunque selezionando basic, sparisce bearer.
			<conditions>
				<condition not="true" and="true">
					<selected name="introspectionEndpointBearer"/>
				</condition>
			</conditions>
			-->
			<property name="policy.introspection.endpoint.basic.stato" />
		</item>
		<item type="checkbox" name="introspectionEndpointBearer" label="Autenticazione Bearer" defaultSelected="false" reloadOnChange="true">
			<conditions>
				<condition not="true" and="true">
					<selected name="introspectionEndpointBasic"/>
				</condition>
			</conditions>
			<property name="policy.introspection.endpoint.bearer.stato" />
		</item>
		<item type="checkbox" name="introspectionEndpointHttps" label="Autenticazione Https" defaultSelected="false" reloadOnChange="true">
			<property name="policy.introspection.endpoint.https.stato" />
		</item>
		
		<subsection label="Autenticazione Http Basic">
			<conditions>
				<condition and="true">
					<selected name="introspectionEndpointBasic"/>
				</condition>
			</conditions>
			<item type="text" name="introspectionEndpointBasicUsername" label="Username" required="true">
			      	<property name="policy.introspection.endpoint.basic.username" />
			</item>
			<item type="text" name="introspectionEndpointPassword" label="Password" required="true">
			      	<property name="policy.introspection.endpoint.basic.password" />
			</item>
		</subsection>
		
		<subsection label="Autenticazione Bearer">
			<conditions>
				<condition and="true">
					<selected name="introspectionEndpointBearer"/>
				</condition>
			</conditions>
			<item type="text" name="introspectionEndpointBearerToken" label="Token" required="true">
			      	<property name="policy.introspection.endpoint.bearer.token" />
			</item>
		</subsection>

	</section>
	
	<section label="OIDC - UserInfo">
				
		<conditions>
			<condition and="true">
				<selected name="userInfoStato"/>
			</condition>
		</conditions>
	
		<item type="text" name="userInfoEndpointURL" label="URL" required="true" default="http://">
		      	<property name="policy.userInfo.endpoint.url" />
		</item>
		<item type="checkbox" name="userInfoEndpointBasic" label="Autenticazione Http" defaultSelected="false" reloadOnChange="true">
			<!--  non si puo' verificare una condizione successiva. Comunque selezionando basic, sparisce bearer.
			<conditions>
				<condition not="true" and="true">
					<selected name="userInfoEndpointBearer"/>
				</condition>
			</conditions>
			-->
			<property name="policy.userInfo.endpoint.basic.stato" />
		</item>
		<item type="checkbox" name="userInfoEndpointBearer" label="Autenticazione Bearer" defaultSelected="false" reloadOnChange="true">
			<conditions>
				<condition not="true" and="true">
					<selected name="userInfoEndpointBasic"/>
				</condition>
			</conditions>
			<property name="policy.userInfo.endpoint.bearer.stato" />
		</item>
		<item type="checkbox" name="userInfoEndpointHttps" label="Autenticazione Https" defaultSelected="false" reloadOnChange="true">
			<property name="policy.userInfo.endpoint.https.stato" />
		</item>
		
		<subsection label="Autenticazione Http">
			<conditions>
				<condition and="true">
					<selected name="userInfoEndpointBasic"/>
				</condition>
			</conditions>
			<item type="text" name="userInfoEndpointBasicUsername" label="Username" required="true">
			      	<property name="policy.userInfo.endpoint.basic.username" />
			</item>
			<item type="text" name="userInfoEndpointPassword" label="Password" required="true">
			      	<property name="policy.userInfo.endpoint.basic.password" />
			</item>
		</subsection>
		
		<subsection label="Autenticazione Bearer">
			<conditions>
				<condition and="true">
					<selected name="userInfoEndpointBearer"/>
				</condition>
			</conditions>
			<item type="text" name="userInfoEndpointBearerToken" label="Token" required="true">
			      	<property name="policy.userInfo.endpoint.bearer.token" />
			</item>
		</subsection>

	</section>
	
	<section label="Https">

		<conditions>
			<condition and="false">
				<selected name="endpointHttps"/>
				<selected name="introspectionEndpointHttps"/>
				<selected name="userInfoEndpointHttps"/>
			</condition>
		</conditions>
	
		<item type="select" name="endpointHttpsTipologia" label="Tipologia" required="true">
			<property name="sslType" properties="sslConfig" />
		</item>
		<item type="checkbox" name="endpointHttpsHostNameVerifier" label="Hostname Verifier" defaultSelected="true" >
			<property name="hostnameVerifier" properties="sslConfig" />
		</item>
	
	
		<subsection label="Autenticazione Server">
	
			<item type="select" name="endpointHttpsTruststoreType" label="Tipo" default="jks" required="true">
				<values>
					<value value="jks" label="JKS"/>
					<value value="pkcs12" label="PKCS12"/>
					<value value="jceks" label="JCEKS"/>
				</values>
				<property name="trustStoreType" properties="sslConfig" />
			</item>
			<item type="text" name="endpointHttpsTruststoreFile" label="File" required="true">
			    <property name="trustStoreLocation" properties="sslConfig" />
			</item>
			<item type="text" name="endpointHttpsTruststorePassword" label="Password" required="true">
			      	<property name="trustStorePassword" properties="sslConfig" />
			</item>
			<item type="text" name="endpointHttpsTruststoreAlgoritmo" label="Algoritmo" default="PKIX" required="true">
			      	<property name="trustManagementAlgorithm" properties="sslConfig" />
			</item>
			
		</subsection>
		
		<subsection label="Autenticazione Client">
		
			<conditions>
				<condition and="false">
					<selected name="introspectionEndpointHttps"/>
					<selected name="userInfoEndpointHttps"/>
				</condition>
			</conditions>
			
			<item type="select" name="endpointHttpsClientMode" label="Dati Accesso al KeyStore" default="default" required="true" reloadOnChange="true">
				<values>
					<value value="default" label="Usa valore del TrustStore"/>
					<value value="ridefinito" label="Ridefinisci"/>
				</values>
				<property name="policy.endpoint.ssl.mode" />
			</item>
			<item type="select" name="endpointHttpsClientKeystoreType" label="Tipo" default="jks" required="true">
				<conditions>
					<condition and="true">
						<equals name="endpointHttpsClientMode" value="ridefinito"/>
					</condition>
				</conditions>
				<values>
					<value value="jks" label="JKS"/>
					<value value="pkcs12" label="PKCS12"/>
					<value value="jceks" label="JCEKS"/>
				</values>
				<property name="keyStoreType" properties="sslConfig" />
			</item>
			<item type="text" name="endpointHttpsClientKeystoreFile" label="File" required="true">
				<conditions>
					<condition and="true">
						<equals name="endpointHttpsClientMode" value="ridefinito"/>
					</condition>
				</conditions>
			    <property name="keyStoreLocation" properties="sslConfig" />
			</item>
			<item type="text" name="endpointHttpsClientKeystorePassword" label="Password" required="true">
				<conditions>
					<condition and="true">
						<equals name="endpointHttpsClientMode" value="ridefinito"/>
					</condition>
				</conditions>
			    <property name="keyStorePassword" properties="sslConfig" />
			</item>
			<item type="text" name="endpointHttpsClientPasswordChiavePrivata" label="Password Chiave Privata" required="true">
				<property name="keyPassword" properties="sslConfig" />
			</item>
			<item type="text" name="endpointHttpsClientAlgoritmo" label="Algoritmo" default="SunX509" required="true">
				<property name="keyManagementAlgorithm" properties="sslConfig" />
			</item>
		
		</subsection>
		
	</section>
			
	<section label="Proxy">
	
		<conditions>
			<condition and="true">
				<selected name="endpointProxy"/>
			</condition>
		</conditions>
	
		<item type="text" name="endpointProxyHostname" label="Hostname" required="true">
			<property name="proxyHostname" properties="endpointConfig" />
		</item>
		<item type="number" name="endpointProxyPort" label="Porta" required="true" min="1" max="65535">
			<property name="proxyPort" properties="endpointConfig" />
		</item>
		<item type="text" name="endpointProxyUsername" label="Username" required="false">
			<property name="proxyUsername" properties="endpointConfig" />
		</item>
		<item type="text" name="endpointProxyPassword" label="Password" required="false">
			<property name="proxyPassword" properties="endpointConfig" />
		</item>
		
	</section>

	
	<section label="Token Forward">
				
		<conditions>
			<condition and="true">
				<selected name="tokenForwardStato"/>
			</condition>
		</conditions>
		
		<item type="checkbox" name="tokenForwardTrasparente" label="Originale" defaultSelected="false" reloadOnChange="true">
			<property name="policy.tokenForward.trasparente.stato" />
		</item>
		<item type="checkbox" name="tokenForwardInfoRaccolte" label="Informazioni Raccolte" defaultSelected="false" reloadOnChange="true">
			<conditions>
				<condition and="false">
					<selected name="introspectionStato"/>
					<selected name="userInfoStato"/>
				</condition>
			</conditions>
			<property name="policy.tokenForward.infoRaccolte.stato" />
		</item>
		
		<subsection label="Originale">

			<conditions>
				<condition and="true">
					<selected name="tokenForwardTrasparente" />
				</condition>
			</conditions>

			<item type="select" name="tokenForwardTrasparenteMode" label="Modalità" default="asReceived" required="true" reloadOnChange="true">
				<values>
					<value value="asReceived" label="Come è stato ricevuto"/>
					<value value="RFC6750_header" label="RFC 6750 - Bearer Token Usage (Authorization Request Header Field)"/>
					<value value="RFC6750_url" label="RFC 6750 - Bearer Token Usage (URI Query Parameter)"/>
					<value value="CUSTOM_header" label="Header HTTP"/>
					<value value="CUSTOM_url" label="Parametro URL"/>
				</values>
				<property name="policy.tokenForward.trasparente.mode" />
			</item>
			
			<item type="text" name="tokenForwardTrasparenteModeSourceHeader" label="Nome Header HTTP" required="true">
				<conditions>
					<condition>
						<equals name="tokenForwardTrasparenteMode" value="CUSTOM_header"/>
					</condition>
				</conditions>
			    <property name="policy.tokenForward.trasparente.mode.header" />
			</item>
			
			<item type="text" name="tokenForwardTrasparenteModeSourceQueryParameter" label="Nome Parametro URL" required="true">
				<conditions>
					<condition>
						<equals name="tokenForwardTrasparenteMode" value="CUSTOM_url"/>
					</condition>
				</conditions>
			    <property name="policy.tokenForward.trasparente.mode.queryParameter" />
			</item>
			
		</subsection>
		
		<subsection label="Informazioni Raccolte">
		
			<conditions>
				<condition and="true">
					<selected name="tokenForwardInfoRaccolte" />
				</condition>
			</conditions>
	
			<item type="select" name="tokenForwardInfoRaccolteMode" label="Modalità" default="op2header" required="true" reloadOnChange="true">
				<values>
					<value value="op2header" label="OpenSPCoop Headers"/>
					<value value="jws" label="JWS"/>
					<value value="jwe" label="JWE"/>
					<value value="raw" label="JSON"/>
				</values>
				<property name="policy.tokenForward.infoRaccolte.mode" />
			</item>
			
			<item type="checkbox" name="tokenForwardInfoRaccolteModeBase64" label="Base64 Encoded" defaultSelected="true">
				<conditions and="true">
					<condition and="true">
						<equals name="tokenForwardInfoRaccolteMode" value="raw"/>
					</condition>
				</conditions>
				<property name="policy.tokenForward.infoRaccolte.base64" />
			</item>

			<item type="select" name="tokenForwardInfoRaccolteModeJWSSignature" label="Signature Algorithm" required="true">
				<conditions and="true">
					<condition and="true">
						<equals name="tokenForwardInfoRaccolteMode" value="jws"/>
					</condition>
				</conditions>
				<property name="rs.security.signature.algorithm" properties="signaturePropRefId" />
			</item>
			
			<item type="select" name="tokenForwardInfoRaccolteModeJWEKeyAlgorithm" label="Key Algorithm" required="true">
				<conditions and="true">
					<condition and="true">
						<equals name="tokenForwardInfoRaccolteMode" value="jwe"/>
					</condition>
				</conditions>
				<property name="rs.security.encryption.key.algorithm" properties="encryptionPropRefId" />
			</item>
			<item type="select" name="tokenForwardInfoRaccolteModeJWEContentAlgorithm" label="Content Algorithm" required="true">
				<conditions and="true">
					<condition and="true">
						<equals name="tokenForwardInfoRaccolteMode" value="jwe"/>
					</condition>
				</conditions>
				<property name="rs.security.encryption.content.algorithm" properties="encryptionPropRefId" />
			</item>
			
			<item type="checkbox" name="tokenForwardInfoRaccolteModeIntrospection" label="Introspection" defaultSelected="true">
				<conditions and="true">
					<condition and="true">
						<selected name="introspectionStato"/>
						<selected name="userInfoStato"/>
					</condition>
					<condition and="false">
						<equals name="tokenForwardInfoRaccolteMode" value="jws"/>
						<equals name="tokenForwardInfoRaccolteMode" value="jwe"/>
						<equals name="tokenForwardInfoRaccolteMode" value="raw"/>
					</condition>
				</conditions>
				<property name="policy.tokenForward.infoRaccolte.introspection" />
			</item>
			<item type="hidden" name="tokenForwardInfoRaccolteModeIntrospectionForce" value="true">
				<conditions not="true" and="true">
					<condition and="true">
						<selected name="introspectionStato"/>
						<selected name="userInfoStato"/>
					</condition>
					<condition and="false">
						<equals name="tokenForwardInfoRaccolteMode" value="jws"/>
						<equals name="tokenForwardInfoRaccolteMode" value="jwe"/>
						<equals name="tokenForwardInfoRaccolteMode" value="raw"/>
					</condition>
				</conditions>
				<property name="policy.tokenForward.infoRaccolte.introspection" />
			</item>
			
			<item type="checkbox" name="tokenForwardInfoRaccolteModeUserInfo" label="UserInfo" defaultSelected="true">
				<conditions and="true">
					<condition and="true">
						<selected name="introspectionStato"/>
						<selected name="userInfoStato"/>
					</condition>
					<condition and="false">
						<equals name="tokenForwardInfoRaccolteMode" value="jws"/>
						<equals name="tokenForwardInfoRaccolteMode" value="jwe"/>
						<equals name="tokenForwardInfoRaccolteMode" value="raw"/>
					</condition>
				</conditions>
				<property name="policy.tokenForward.infoRaccolte.userInfo" />
			</item>
			<item type="hidden" name="tokenForwardInfoRaccolteModeUserInfoForce" value="true">
				<conditions not="true" and="true">
					<condition and="true">
						<selected name="introspectionStato"/>
						<selected name="userInfoStato"/>
					</condition>
					<condition and="false">
						<equals name="tokenForwardInfoRaccolteMode" value="jws"/>
						<equals name="tokenForwardInfoRaccolteMode" value="jwe"/>
						<equals name="tokenForwardInfoRaccolteMode" value="raw"/>
					</condition>
				</conditions>
				<property name="policy.tokenForward.infoRaccolte.userInfo" />
			</item>

		</subsection>
		
		<subsection label="JWS KeyStore">

			<conditions and="true">
				<condition and="true">
					<equals name="tokenForwardInfoRaccolteMode" value="jws"/>
				</condition>
			</conditions>

			<item type="select" name="tokenForwardInfoRaccolteModeJWSKeystoreType" label="Tipo" default="jks" required="true">
				<values>
					<value value="jks" label="JKS"/>
					<value value="pkcs12" label="PKCS12"/>
					<!--  <value value="jceks" label="JCEKS"/> -->
				</values>
				<property name="rs.security.keystore.type" properties="signaturePropRefId" />
			</item>
			<item type="text" name="tokenForwardInfoRaccolteModeJWSKeystoreFile" label="File" required="true">
			      	<property name="rs.security.keystore.file" properties="signaturePropRefId" />
			</item>
			<item type="text" name="tokenForwardInfoRaccolteModeJWSKeystorePassword" label="Password" required="true">
			      	<property name="rs.security.keystore.password" properties="signaturePropRefId" />
			</item>
			<item type="text" name="tokenForwardInfoRaccolteModeJWSKeystorePrivateKeyAlias" label="Alias Chiave Privata" required="true">
			      	<property name="rs.security.keystore.alias" properties="signaturePropRefId" />
			</item>
			<item type="text" name="tokenForwardInfoRaccolteModeJWSKeystorePrivateKeyPassword" label="Password Chiave Privata" required="true">
			      	<property name="rs.security.key.password" properties="signaturePropRefId" />
			</item>

		</subsection>
		
		<subsection label="JWE KeyStore">

			<conditions and="true">
				<condition and="true">
					<equals name="tokenForwardInfoRaccolteMode" value="jwe"/>
				</condition>
			</conditions>

			<item type="select" name="tokenForwardInfoRaccolteModeJWEContentKeystoreType" label="Tipo" default="jks" required="true">
				<values>
					<value value="jks" label="JKS"/>
					<value value="pkcs12" label="PKCS12"/>
					<value value="jceks" label="JCEKS"/>
				</values>
				<property name="rs.security.keystore.type" properties="encryptionPropRefId" />
			</item>
			<item type="text" name="tokenForwardInfoRaccolteModeJWEContentKeystoreFile" label="File" required="true">
			      	<property name="rs.security.keystore.file" properties="encryptionPropRefId" />
			</item>
			<item type="text" name="tokenForwardInfoRaccolteModeJWEContentKeystorePassword" label="Password" required="true">
			      	<property name="rs.security.keystore.password" properties="encryptionPropRefId" />
			</item>
			<item type="text" name="tokenForwardInfoRaccolteModeJWEContentKeystoreCertificateAlias" label="Alias Certificato" required="true">
				<conditions>
					<condition not="true">
						<equals name="tokenForwardInfoRaccolteModeJWEContentKeystoreType" value="jceks"/>
					</condition>
				</conditions>
			    <property name="rs.security.keystore.alias" properties="encryptionPropRefId" />
			</item>
			<item type="text" name="tokenForwardInfoRaccolteModeJWEContentKeystorePrivateKeyAlias" label="Alias Chiave Privata" required="true">
				<conditions>
					<condition not="false">
						<equals name="tokenForwardInfoRaccolteModeJWEContentKeystoreType" value="jceks"/>
					</condition>
				</conditions>
			    <property name="rs.security.keystore.alias" properties="encryptionPropRefId" />
			</item>
			<item type="text" name="tokenForwardInfoRaccolteModeJWEContentKeystorePrivateKeyPassword" label="Password Chiave Privata" required="true">
				<conditions>
					<condition not="false">
						<equals name="tokenForwardInfoRaccolteModeJWEContentKeystoreType" value="jceks"/>
					</condition>
				</conditions>
			    <property name="rs.security.key.password" properties="encryptionPropRefId" />
			</item>

		</subsection>
		
	</section>

</config>



